"use strict";!function(t){function n(t,e){var r=this;if(t instanceof n)return t;if(!(r instanceof n))return new n(t,e);if(!t)return r;if(a(t)){if(e=e?n(e):J,!G.test(t))return t=t.trim(),e.find(t);b(r,_(t,e))}else b(r,t)}function e(){}function r(t){return"undefined"==typeof t}function i(t){return!r(t)}function a(t){return"string"==typeof t}function o(t){return rn(t)||!!t&&"object"===en(t)&&s(t.length)&&!l(t)&&!d(t)}function u(t){return!(!t||"object"!==en(t)||t.constructor!==Object)}function c(t){for(var n in t)return!1;return!0}function s(t){return"number"==typeof t&&!isNaN(t)}function f(t){return"function"===en(t)}function l(t){return null!=t&&t.window===t}function d(t){return!!t.nodeType}function h(t){return!t||!t.parentNode||t.parentNode.nodeType===Z}function p(t){return t.trim().replace(/^-+/,"").replace(/-([a-z])/g,function(t,n){return n.toUpperCase()})}function v(t){var n=Array.prototype.slice;return n.apply(t,n.call(arguments,1))}function m(t,n){for(var e=0,r=t.length;r>e&&!1!==n(e,t[e]);++e);}function g(t,n){for(var e in t)if(t.hasOwnProperty(e)&&!1===n(e,t[e]))break}function y(t,n){(o(t)?m:g)(t,n)}function w(t,n){null!=n&&(t[t.length++]=n)}function b(t,n){return n=v(arguments,1),y(n,function(n,e){o(e)?m(e,function(n,e){w(t,e)}):w(t,e)}),t}function T(t,n,e){var r=e||[];return y(t,function(t,e){b(r,n(e,t))}),r}function x(t,n){return t||(t={}),n=v(arguments,1),y(n,function(n,e){g(e,function(n,e){t[n]=e})}),t}function A(t,n){if(!t.getAttribute)return!1;var e=(t.getAttribute("class")||"").match(R)||[];return e.indexOf(n)>=0}function N(t,n){D(t,n,function(t,n){-1===t.indexOf(n)&&t.push(n)})}function C(t,n){D(t,n,function(t,n){var e=t.indexOf(n);-1!==e&&t.splice(e,1)})}function D(t,n,e){if(n&&t.setAttribute){var r=(t.getAttribute("class")||"").match(R)||[];y(n.match(R)||[],function(t,n){var i;do i=r.length,e(r,n);while(r.length!==i)}),r.length?t.setAttribute("class",r.join(" ")):t.removeAttribute("class")}}function O(t,n){var e,r;return n=n||document,n=d(n)?n:n[0],n=n.ownerDocument||n,G.test(t)?(t=t.replace(K,"<$1></$2>"),cn.innerHTML=t,e=v(cn.childNodes)):e=t?[n.createTextNode(t)]:[],r=n.createDocumentFragment(),y(e,function(t,n){r.appendChild(n)}),cn.innerHTML="",r}function _(t,n){return v(O(t,n).childNodes)}function L(t){return t.getElementsByTagName?t.getElementsByTagName("*"):t.querySelectorAll?t.querySelectorAll("*"):[]}function E(t,e){if(n.hasData(t)&&n.acceptData(e)){var r=n._data(t),i=n._data(e,r);delete i[tn],delete i[nn],i.data&&(i.data=x({},i.data))}}function I(t,n){function e(t){return 1-n(1-t)}sn.easing["easeIn"+t]=n,sn.easing["easeOut"+t]=e,sn.easing["easeInOut"+t]=function(t){return.5>t?.5*n(2*t):.5*e(2*(t-.5))+.5}}function M(t){var n=0,e="";if(s(t))n=t,e="px";else if(a(t)){var r=t.match(z);r&&(n=Number(r[1]),e=r[2])}return{val:n,unit:e}}function S(r,i,a){var o=n._data(r,tn),u=n._data(r,nn);o?o++:o=1,u||(u={}),a=x({complete:e,duration:400,easing:"swing"},a);var c=T(i,function(t,e){return n.tween(r,e,t,sn.easing[a.easing])}),s=x({},a,{start:n.now(),tweens:c,go:function(t){y(s.tweens,function(n,e){e(t)}),1===t&&s.complete()},stop:function(t){t&&s.go(1),s._finally()},_finally:function(){var e=n._data(r,nn);e&&(e[o]=t,n._data(r,nn,e))}}),f=function(){var t=Math.min(1,(n.now()-s.start)/s.duration);return s.go(t),1>t};f.anim=s,u[o]=f,n._data(r,tn,o),n._data(r,nn,u),sn.addTimer(f)}function F(n,e,r,a){var o=!0;return i(a)?y(n,function(t,n){e(n,r,a)}):u(r)?g(r,function(t,r){F(n,e,t,r)}):o=!1,o?n:n.length?e(n[0],r):t}function j(t,n,e){return t.each(function(){n(this,e)})}function k(t,n){return function(e,r){return t(this,n,e,r)}}function B(t,n,e,r){var i=r||[];return e=!!e,y(t,function(t,r){e===!n(t,r)&&w(i,r)}),i}function P(t,n){if(t.nodeType!==V)return!1;var e=n.match(U);e||$.raise('Only element and class selectors are supported by tfcJQuery. "'+n+'"');var r=e[2],i=e[1];return"."===i?A(t,r):":"===i?(fn[r]||$.raise("tfcJQuery does not support the :"+r+" selector"),fn[r](t)):t.tagName.toLowerCase()===r.toLowerCase()}function H(t,e,r){var i;return i=f(e)?function(t,n){return e.call(n,t,n)}:d(e)?function(t,n){return n===e}:a(e)?function(t,n){return P(n,e)}:function(t,r){return-1!==n.inArray(r,e)},B(t,i,r,n())}function Q(t,n,e){!a(n)&&t.length>1&&$.raise(e+" does not behave the same way as jQuery with multiple elements")}function q(t,n){var e;if(l(t))return t.document.documentElement["client"+n];if(t.nodeType===Y)return e=t.documentElement,Math.max(e["scroll"+n],t.body["scroll"+n],e["offset"+n],t.body["offset"+n],e["client"+n]);var r=t["offset"+n],i=getComputedStyle(t);return y(ln[n],function(t,n){r-=M(i["padding"+n]).val,r-=M(i["border"+n+"Width"]).val}),r}/*!
   * This library is heavily derived from:
   *
   * jQuery JavaScript Library v1.8.3
   * http://jquery.com/
   *
   * Includes Sizzle.js
   * http://sizzlejs.com/
   *
   * Copyright 2012 jQuery Foundation and other contributors
   * Released under the MIT license
   * http://jquery.org/license
   *
   * Date: Tue Nov 13 2012 08:20:33 GMT-0500 (Eastern Standard Time)
   */
var J,W=window.console,$={},R=/\S+/g,z=/^(\-?\d+(?:\.\d+)?)(px|%|)$/i,U=/^(\.|:)?([-a-z]+)$/i,G=/<|&#?\w+;/,K=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,V=1,X=3,Y=9,Z=11,tn="animIndex",nn="animTicks";n.fn=n.prototype,n.extend=n.fn.extend=function(t){return 1===arguments.length?x(this,t):x.apply(null,arguments)};var en=function(){var t,n,e={},r="Boolean Number String Function Array Date RegExp Object".split(" ");for(t=0;t<r.length;++t)n=r[t],e["[object "+n+"]"]=n.toLowerCase();return function(t){return null==t?String(t):e[Object.prototype.toString.call(t)]||"object"}}(),rn=Array.isArray||function(t){return"array"===en(t)},an=function(){/*!
     * Copyright 2012 jQuery Foundation and other contributors
     * Released under the MIT license
     * http://jquery.org/license
     */
var t=String.prototype.trim,n=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;return t&&!t.call("﻿ ")?function(n){return null==n?"":t.call(n)}:function(t){return null==t?"":(t+"").replace(n,"")}}(),on={},un="__tfc__"+Math.random();n.extend({cache:on,expando:un,guid:1,_data:function(t,e,r){return n.data(t,e,r,!0)},data:function(t,e,r,a){var o;if(n.acceptData(t)){if(o=on[t[un]]||{},null==e)return(a?o:o.data)||{};if(u(e))a?x(o,e):o.data=x(o.data,e);else{if(!i(r))return a?o[e]:o.data&&o.data[e];(a?o:o.data=o.data||{})[e]=r}return on[t[un]=t[un]||n.guid++]=o,a?o:o.data}},removeData:function(t,e,r){var i,a;n.acceptData(t)&&(i=on[t[un]])&&(!e||(a=r?i:i.data,a&&delete a[e],a&&c(a)))&&(r||(delete i.data,c(i)))&&n.cleanData([t])},cleanData:function(e){m(e,function(e,r){var i;if(n.acceptData(r)&&(i=on[r[un]])){if(i.events){if(!i.handle)throw new Error("No store.handle while calling cleanData with remaining events");y(i.events,function(t){r.removeEventListener(t,i.handle,!1)})}var a=n._data(r,nn);for(var o in a)if(a.hasOwnProperty(o)){var u=a[o];if(u){var c=sn.timers.indexOf(u);-1!==c&&sn.timers.splice(c,1)}}delete on[r[un]],r[un]=t}})},acceptData:function(t){return t&&(t.nodeType===V||t.nodeType===Y)},hasData:function(t){return!!on[t[un]]}});var cn=document.createElement("div");n.extend({logging:!0,access:F,each:y,map:T,isArray:rn,isFunction:f,isPlainObject:u,trim:an,type:en,parseHTML:_,inArray:function(t,n,e){if(o(n)){var i=Array.prototype.indexOf;if(i)return i.call(n,t,e);var a=n.length;for(r(e)?e=0:0>e&&(e=Math.max(0,a+e));a>e;++e)if(n[e]===t)return e}return-1},css:function(t,e,r){e=p(e);var i=n.style(t,e,r);return""===i&&(i=getComputedStyle(t)[e]),i},style:function(t,n,e){return n=p(n),i(e)?(s(e)&&(e+=sn.numberOnly[n]?"":"px"),void(t.style[n]=e)):t.style[n]},attr:function pn(n,e,i){var a=n.nodeType;if(e&&a===V)if(e=e.toLowerCase(),hn[e]){var o=hn[e];if(r(i)){var u;return n[o]||(u=n.attributes.getNamedItem(e))&&u.specified?e:t}n[o]=!!i,i?n.setAttribute(e,e):n.removeAttribute(e)}else{if(r(i)){var c=-1!=="href,src,width,height".split(",").indexOf(e),pn=c?n.getAttribute(e,2):n.getAttribute(e);return null===pn?t:pn}n.setAttribute(e,i)}},prop:function(t,n,e){return i(e)?void(t[n]=e):t[n]},now:function(){return(new Date).getTime()},clone:function vn(t,n){var e,r,vn=t.cloneNode(!0);return n&&(E(t,vn),e=L(t),r=L(vn),y(e,function(t,n){E(n,r[t])})),vn},contains:function(t,n){do{if(t===n)return!0;n=n.parentNode}while(n);return!1}});var sn=n.fx={timers:[],interval:13,timeoutId:null,addTimer:function(t){sn.timers.push(t),sn.timeoutId||sn.start()},start:function(){sn.timeoutId=setInterval(sn.tick,sn.interval)},tick:function(){for(var t,n=sn.timers,e=0;e<n.length;++e)t=n[e],t()||(t.anim.stop(),n.splice(e--,1));n.length||sn.stop()},stop:function(){clearInterval(sn.timeoutId),sn.timeoutId=null},numberOnly:{opacity:!0}};sn.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},I("Quad",function(t){return t*t}),I("Cubic",function(t){return t*t*t}),I("Sine",function(t){return 1-Math.cos(t*Math.PI/2)}),n.extend({Animation:S,tweenFn:function(t,n,e,r){return function(i){r(t+(n-t)*e(i))}},tweenCss:function(t,e,r,i,a,o){return n.tweenFn(r,i,o,function(r){n.css(t,e,r+a)})},tweenProp:function(t,e,r,i,a){return n.tweenFn(r,i,a,function(r){n.prop(t,e,r)})},tween:function(t,e,r,i){var a,o;return n.propTweens[e]?(a=+n.prop(t,e),o=+r,n.tweenProp(t,e,a,o,i)):(e=p(e),a=M(n.css(t,e)),o=M(r),sn.numberOnly[e]&&(a.unit=o.unit=""),a.unit===o.unit?n.tweenCss(t,e,a.val,o.val,o.unit,i):void $.raise("different start/end units for",e,a,o))},propTweens:{scrollTop:!0}});var fn={visible:function(t){return t.offsetWidth>0||t.offsetHeight>0},focus:function(t){return document.activeElement===t}};n.fn.extend({length:0,css:k(F,n.css),style:k(F,n.style),attr:k(F,n.attr),prop:k(F,n.prop),data:k(F,n.data),removeData:k(j,n.removeData),addClass:k(j,N),removeClass:k(j,C),get:function(t){return r(t)?this.toArray():this[(0>t?this.length:0)+t]},eq:function(t){return n(this.get(t||0))},each:function(t){return y(this,function(n,e){return t.call(e,n,e)}),this},map:function(t){return T(this,function(n,e){return t.call(n,e,n)},n())},filter:function(t){return H(this,t,!1)},not:function(t){return H(this,t,!0)},is:function(t){return this.filter(t).length>0},toArray:function(){var t=[];return y(this,function(n,e){t.push(e)}),t},hasClass:function(t){return this.length?A(this[0],t):!1},removeAttr:function(t){return t&&y(this,function(n,e){e.removeAttribute(t)}),this},toggleClass:function(t,n){return t&&y(this,function(e,i){y(t.match(R)||[],function(t,e){var a=n;r(a)&&(a=!A(i,e)),(a?N:C)(i,e)})}),this},children:function(){return this.map(function(t,n){return T(n.childNodes,function(t){return t.nodeType===V?t:void 0})})},contents:function(){return this.map(function(){return this.childNodes})},add:function(t){return b(n(),this,n(t))},find:function(t){return this.map(function(){return this.querySelectorAll?this.querySelectorAll(t):void 0})},animate:function(t,n,e){var r={};return u(n)?x(r,n):s(n)?r.duration=n:f(n)&&(e=n),f(e)&&(r.complete=e),this.each(function(){S(this,t,r)})},fadeIn:function(t,n){return this.css({opacity:0}).show().animate({opacity:1},t,n)},fadeOut:function(t){if(i(t)&&!f(t))throw new Error("tfcJQuery#fadeOut currently only supports an optional callback argument");var n=this;return this.animate({opacity:0},function(){n.hide(),t&&t()})},stop:function(t){return this.each(function(){var e=n._data(this,nn);for(var r in e)if(e.hasOwnProperty(r)){var i,a=e[r];a&&(i=sn.timers.indexOf(a),-1!==i&&sn.timers.splice(i,1),a.anim.stop(t))}n.removeData(this,tn,!0),n.removeData(this,nn,!0)})},remove:function(t){return y(this,function(e,r){t||r.nodeType!==V||(n.cleanData(r.getElementsByTagName("*")),n.cleanData([r])),r.parentNode&&r.parentNode.removeChild(r)}),this},detach:function(){return this.remove(!0)},empty:function(){return this.contents().remove(),this},html:function(t){return r(t)?this.length?this[0].innerHTML:"":(a(t)?(this.empty(),this.each(function(){this.innerHTML=t})):t instanceof n&&(this.empty(),this.append(t)),this)},text:function(t){var e=!1;return r(t)&&(e=!0,t=""),this.each(function(){var r=this,i=r.nodeType;(i===X||i===V)&&(e?t+=this.textContent:(n(r).empty(),this.textContent=t))}),e?t:this},parents:function(t){var n=this.map(function(){for(var t=[],n=this.parentNode;n;)t.push(n),n=n.parentNode;return t});return t&&(n=n.filter(t)),n},parent:function(t){var n=this.map(function(){return this.parentNode});return t&&(n=n.filter(t)),n},visible:function(){return this.style("visibility","visible")},invisible:function(){return this.style("visibility","hidden")},hide:function(){return this.style("display","none")},show:function(){return this.each(function(){var t=this;if(t.nodeType===V){var n,e=t.nodeName.toLowerCase();switch(e){case"div":case"iframe":n="block";break;case"span":n="inline";break;default:$.raise("Calling show on unsupported element ["+e+"]")}t.style.display=n}})},append:function(t){return Q(this,t,"append"),this.each(function(){var e=this,r=e.nodeType;(r===Z||r===V)&&n(t).each(function(){e.appendChild(this)})})},prepend:function(t){return Q(this,t,"prepend"),this.each(function(){var e=this,r=e.nodeType;if(r===Z||r===V){var i=e.firstChild;n(t).each(function(){e.insertBefore(this,i)})}})},before:function(t){return h(this[0])?b(n(),n(t),this):(Q(this,t,"before"),this.each(function(){var e=this;n(t).each(function(){e.parentNode.insertBefore(this,e)})}))},replaceWith:function(t){return h(this[0])?this.length?b(n(),n(t)):this:(Q(this,t,"replaceWith"),a(t)||(t=n(t).detach()),this.each(function(){var e=this.parentNode,r=this.nextSibling;n(this).remove(),r?n(r).before(t):n(e).append(t)}))},clone:function(t){return this.map(function(){return n.clone(this,t)})},offset:function(){var t,n=this[0];return n&&n.getBoundingClientRect?(t=n.getBoundingClientRect(),{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}):void 0},bind:function(t,e){return this.each(function(){n.event.add(this,t,e)})},unbind:function(t,e){return this.each(function(){n.event.remove(this,t,e)})}});var ln={Width:["Left","Right"],Height:["Top","Bottom"]};y(ln,function(t){var e=t.toLowerCase();n.fn[e]=function(){return arguments.length&&$.raise("tfcJQuery#"+e+" is only a getter"),this.length?q(this[0],t):null}});var dn={};n.event={special:dn,add:function(t,e,r){if(n.acceptData(t)){r.guid||(r.guid=n.guid++);var i=n._data(t,{}),a=i.handle;a||(a=i.handle=function(t){return n.event.dispatch.call(a.elem,t)},a.elem=t);var o=e;e=(dn[e]||{}).fixType||e;var u={type:e,origType:o,handler:r,guid:r.guid},c=i.events=i.events||{},s=c[e];s||(s=c[e]=[],t.addEventListener(e,a,!1)),s.push(u),t=null}},dispatch:function(t){var e,r=t.type,i=this,a=n._data(i,"events");if(a&&a[r])for(var o=a[r],u=0,c=o.length;c>u;++u){var s=o[u],f=(dn[s.origType]||{}).handle;e=f?f.call(i,t,s):s.handler.call(i,t),e===!1&&(t.preventDefault(),t.stopPropagation())}},remove:function(t,e,r){if(n.acceptData(t)&&n.hasData(t)){var i=n._data(t),a=i.events;e=(dn[e]||{}).fixType||e,a&&a[e]&&(a[e]=B(a[e],function(t,n){return!r||n.guid===r.guid},!0),0===a[e].length&&(delete a[e],t.removeEventListener(e,i.handle,!1)),c(a)&&(delete i.handle,n.removeData(t,"events",!0)))}}},y({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){dn[t]={fixType:e,handle:function(t,e){var r,i=this,a=t.relatedTarget;return(!a||a!==i&&!n.contains(i,a))&&(r=e.handler.call(i,t)),r}}});var hn={};y("selected,checked,disabled,multiple,readOnly,required,open".split(","),function(t,n){hn[n.toLowerCase()]=n}),y(["log","debug","warn","error"],function(t,e){$[e]=function(){n.logging&&W&&W[e].apply(W,arguments)}}),$.raise=function(){throw new Error(v(arguments).join(" "))},J=n(document),window.tfcJQuery=n}();
"use strict";var TFCApp;!function(){var e;TFCApp||(TFCApp={getRunMode:function(){return e},isProdMode:function(){return e===TFCApp.RunModes.staging||e===TFCApp.RunModes.prod},isDevMode:function(){return e===TFCApp.RunModes.dev},RunModes:{dev:1,test:2,staging:3,prod:4},Constants:{RequestParameter:{UserSession:"userCookie",Gender:"gender",Department:"department",AgeGroup:"ageGroup",Category:"category",ProductType:"productType",IPS:"ips",FirstName:"firstName",OrderId:"orderid",StyleColorId:"colorId",AvailableSizes:"availableSizes",Style:"style",CurrentStyle:"crStyle",ExcludedStyle:"exStyle",StoreEmbedded:"storeEmbedded",Placement:"placement",UserId:"userid",StoreRegistered:"storeRegistered",OriginWidget:"originWidget",Container:"container",ScreenSize:"screenSize",SessionParams:"sessionParams",SessionParamOverrides:"sessionParamOverrides",AnalyticsSession:"analyticsSession",AnalyticsScreenSize:"analyticsScreenSize",AnalyticsArgs:"analyticsArgs",UniversalAnalyticsArgs:"universalAnalyticsArgs",PageName:"pageName",Funnels:"funnels",CookiesEnabled:"cookiesEnabled",SourceTrigger:"sourceTrigger",AlternateUserId:"alternateUserId",StoreTla:"storeId",WindowParams:"windowParams",ServiceSecureURI:"serviceSecureURI",StoreVersionPath:"storeVersionPath",ProfileComplete:"profileComplete",FitRecResult:"fitrecResult",CustomProfileJs:"customjs",IsEnteringData:"isEnteringData",WidgetContext:"widgetContext",Widget:"widget",AutoCalculate:"autoCalculate",ClientToServerLogging:"clientToServerLogging",Token:"token",UserHasLegacyCookie:"userHasLegacyCookie",IntegrationPlatform:"platform",ThirdPartyAuth:"thirdPartyAuth",ThirdPartyCredEmailCollectionEnabled:"thirdPartyCredEmailCollectionEnabled",RecipientLinkId:"recipientLinkId",RecipientAlias:"recipientAlias",IsSettingUpNewRecipient:"isSettingUpNewRecipient",EditRecipientLinkId:"editRecipientLinkId",IsShoppingForOther:"isShoppingForOther",OriginUrl:"originUrl",UserSettings:"userSettings",ApplicationName:"applicationName",SessionContext:"sessCtx",WidgetHidden:"widgetHidden",StoreExperimentKey:"storeExperimentKey",StoreCategory:"storeCategory",IncludeDislikes:"includeDislikes",RecipientProfileId:"recipientProfileId",ClientSupportsDiscovery:"csDiscovery",ClientSupportsSfo:"csSfo",AllowTokenCycling:"allowTokenCycling",DeviceType:"deviceType",ServiceMode:"serviceMode",Locale:"locale",IframeIntegration:"iframeIntegration",QMEnabled:"qmEnabled"},Header:{UserToken:"x-tf-usertoken",UserTokenMaxAge:"x-tf-usertokenmaxage",UserTokenDomain:"x-tf-usertokendomain",UserTokenSecure:"x-tf-usertokensecure",UserSession:"x-tf-usersession",SessionParams:"x-tf-sessionparams",SessionParamMaxAge:"x-tf-sessionparammaxage",IsUserRecognized:"x-tf-isuserrecognized",StoreUserId:"x-tf-storeuserid"},Attributes:{FIRST_NAME:"data-x-firstname",ALT_USER_ID:"data-x-altuserid",ORDER_ID:"data-orderid",GENDER:"data-gender",IPS:"data-ips",LOCALE:"data-locale",STYLE_ID:"data-styleid-private",STYLE_ID_NEW:"data-styleid",STYLE_ID_LEGACY:"id",USERID:"data-userid",USER_ID:"data-user-id",STORE_REGISTERED:"data-registered",STYLE_COLOR_ID:"data-colorid",AVAILABLE_SIZES:"data-availablesizes",CONTEXT:"data-context",RECIPIENT_ID:"data-recipient-id",STORE_CATEGORY:"data-store-category",CATEGORY:"data-category",AGE_GROUP:"data-age-group",WIDGET_HIDDEN:"data-widget-hidden",STORE_EXPERIMENT_KEY:"data-store-experiment-key"},DeviceType:{Mobile:"mobile",Desktop:"desktop",Responsive:"responsive"},AgeGroup:{Adult:"Adult",Child:"Child"},Category:{Bottoms:"Bottoms",Dresses:"Dresses",Shoes:"Shoes",Tops:"Tops",Bras:"Bras"},Department:{Boy:"Boys",Girl:"Girls",Men:"Mens",Unisex:"Unisex",UnisexKids:"UnisexKids",Women:"Womens"},Gender:{Male:"Male",Female:"Female",Unisex:"Unisex"},ProductType:{Tops:"Tops",Bottoms:"Bottoms",Shoes:"Shoes",DressShirts:"DressShirts",Dresses:"Dresses",Suits:"Suits",Bras:"Bras"},Classification:{DressShirts:"DressShirts"},IPS:{Discovery:"discovery",FitDetails:"fitdetails",Login:"login",NewProfile:"newprofile",UpdateProfile:"profile",Unknown:"unknown",Welcome:"welcome",GeneralSizeAdvice:"generalsizeadvice",Manage:"manage",Save:"save",SfoNew:"sfonew",SfoEdit:"sfoedit",SfoNewChild:"sfonewchild",InstantProfile:"instantprofile",ProfileSwitcher:"profileswitcher",InvalidGender:"invalidgender",IncompleteGarment:"incompletegarment",SizeNotAvailable:"sizenotavailable",ShopForOthers:"shopforothers"},Context:{QuickView:"quickview"},SourceTrigger:{Banner:"Banner",Widget:"Widget",Popup:"Popup",Tab:"Tab"},Container:{Modal:"modal",Tip:"tip",Fixed:"fixed"},IntegrationPlatform:{Web:"web",App:"app"},Message:{Open:"open",Close:"close",Update:"update",Complete:"complete",PageLoad:"pageload",SessionParams:"sessionparams",SessionParamsMaxAge:"sessionparamsmaxage",LogOut:"logout",Resize:"resize",ResizeModalWidth:"resizemodalwidth",Refresh:"refresh",UserSession:"usersession",UserSetting:"usersetting",UserSettings:"usersettings",UserToken:"usertoken",AddToBag:"addtobag",ScreenSizeChange:"screensizechange",FitRecResults:"fitrecresults",Chat:"chat",AppRevealed:"appRevealed",SizeChart:"sizechart",DiscoveryProductsViewed:"discoveryproductsviewed",DiscoveryRecommendationClicked:"discoveryrecommendationclicked",UserClick:"userclick"},NGEvents:{UpdateProfileStrength:"UpdateProfileStrength"},ScreenSize:{Small:"small",Large:"large"},LayoutPosition:{Right:"right",Left:"left"},UserSettings:{DiscoveryIntroMessageViewed:"dimv",DiscoveryExitSuppressed:"des",SessionParams:"session.params"},ModalWidth:{Wide:"wide",Narrow:"narrow"},LayoutType:{Inline:"inline",Modal:"modal"},FitRec:{Event:{LogOut:"logout",OpenDialog:"opendialog",MoreInfo:"moreinfo",OpenRegistration:"openreg",Render:"render"},Status:{EstimationInProgress:"estimationinprogress",Error:"error",IncompleteGarment:"incompletegarment",IncompleteProfile:"incompleteprofile",InvalidGender:"invalidgender",NoUser:"nouser",NoStyle:"nostyle",NoStyleNoUser:"nostylenouser",SizeNotAvailable:"sizenotavailable",Success:"success",UserDisabled:"userdisabled"},TemplateName:{AnonymousNotRecommended:"anonymousnotrecommended",AnonymousRecommended:"anonymousrecommended",EstimationInProgress:"estimationinprogress",Error:"error",IncompleteGarment:"incompletegarment",IncompleteProfile:"incompleteprofile",InvalidGender:"invalidgender",UnrecommendableDepartment:"unrecommendabledepartment",NoUser:"nouser",NoStyle:"nostyle",NoStyleNoUser:"nostylenouser",NotRecommended:"notrecommended",Recommended:"recommended",RecommendedGarmentUserSizeOnly:"garmentusersizeonly",RecommendedGarmentSizeOnly:"garmentsizeonly",RecommendedUserSizeOnly:"usersizeonly",RecommendedDepartmentSizeOnly:"departmentsizeonly",BrandAdvice:"brandadvice"}}},analytics:{},component:{},manager:{},tips:{},utility:{},add:function(e,i,s){s&&!TFCApp[e][s]?TFCApp[e][s]=i:TFCApp[e]||(TFCApp[e]=i)}}),e=TFCApp.RunModes.prod||TFCApp.RunModes.dev}();
"use strict";!function(){TFCApp.add("bind",function(n,t){if("function"!=typeof n)throw"Cannot bind to non-function";var r=Array.prototype.slice.call(arguments,2);return function(){var o=Array.prototype.slice.call(arguments);return n.apply(t,r.concat(o))}})}();
"use strict";/*!
 * jQuery JavaScript Library v1.8.3
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: Tue Nov 13 2012 08:20:33 GMT-0500 (Eastern Standard Time)
 */
!function(t,n){var r,o,e,i,s;r=function(){var t=/^(?:body|html)$/i;return{_getWindow:function(t){return this.isWindow(t)?t:9===t.nodeType?t.defaultView||t.parentWindow:!1},_scroll:function(t,n,r,o,e){var i=this._getWindow(t);return void 0===n?i?r in i?i[r]:i.document.documentElement[o]:t[o]:void(i?i.scrollTo(e?this.scrollLeft(t):n,e?n:this.scrollTop(t)):t[o]=n)},isWindow:function(t){return null!=t&&t==t.window},position:function(r){var o=r[0],e=this.offsetParent(r),i=r.offset(),s=t.test(e[0].nodeName)?{top:0,left:0}:e.offset();return i.top-=parseFloat(n.css(o,"marginTop"))||0,i.left-=parseFloat(n.css(o,"marginLeft"))||0,s.top+=parseFloat(n.css(e[0],"borderTopWidth"))||0,s.left+=parseFloat(n.css(e[0],"borderLeftWidth"))||0,{top:i.top-s.top,left:i.left-s.left}},offsetParent:function(r){return r.map(function(){for(var r=this.offsetParent||document.body;r&&!t.test(r.nodeName)&&"static"===n.css(r,"position");)r=r.offsetParent;return r||document.body})},scrollLeft:function(t,n){return this._scroll(t,n,"pageXOffset","scrollLeft")},scrollTop:function(t,n){return this._scroll(t,n,"pageYOffset","scrollTop",!0)}}}(),e=function(t,n){var r=t.css(n),o=r?parseInt(r.replace("px","")):0/0;return isNaN(o)?0:o},i=function(t){var n=e(t,"paddingLeft"),r=t.width(),o=e(t,"paddingRight");return n+r+o},s=function(t,n){var r=n?e(t,"marginLeft"):0,o=e(t,"borderLeftWidth"),i=e(t,"paddingLeft"),s=t.width(),f=e(t,"paddingRight"),l=e(t,"borderRightWidth"),c=n?e(t,"marginRight"):0;return r+o+i+s+f+l+c},o=function(){return n.apply(n,arguments)},o.innerWidth=function(t){return n.fn.innerWidth?t.innerWidth():i(t)},o.outerWidth=function(t,r){var o=r?r:!1;return n.fn.outerWidth?t.outerWidth(o):s(t,o)},o.position=function(t){return n.fn.position?t.position():r.position(t)},o.scrollTop=function(t,o){return n.fn.scrollTop?function(t,n){return t.scrollTop.apply(t,n)}(n(t),Array.prototype.slice.call(arguments,1)):r.scrollTop(t,o)},o.scrollLeft=function(t,o){return n.fn.scrollLeft?function(t,n){return t.scrollLeft.apply(t,n)}(n(t),Array.prototype.slice.call(arguments,1)):r.scrollLeft(t,o)},o.parseHtml=function(t){return o(n.parseHTML(n.trim(t)))},t.extLibs=o}(TFCApp,tfcJQuery);
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t=e.extLibs=e.extLibs||{};t.contains=function(e,t){do{if(t===e)return!0;t=t.parentNode}while(t);return!1};var n={canBubble:!0,cancelable:!0,view:window,detail:null,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null};t.mouseEvent=function(e,t,o){var c,r=document.createEvent("MouseEvent");"object"===("undefined"==typeof t?"undefined":_typeof(t))?o=t:(o=o||{},o.type=t);for(c in n)n.hasOwnProperty(c)&&!o.hasOwnProperty(c)&&(o[c]=n[c]);o.button=0,r.initMouseEvent(o.type,o.canBubble,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget),e.dispatchEvent(r)},t.click=function(e,n){t.mouseEvent(e,"click",n)}}(TFCApp);
"use strict";/*!
 * Simple JavaScript Inheritance
 * By John Resig http://ejohn.org/
 * MIT Licensed.
 *
 * Extended to included support for private methods and variables
 * through the use of a proxy object on instantiation.
 */
!function(t){function n(){function t(){var t=this;f||t._constructor&&t._constructor.apply(t,arguments)}return t}function r(t,n){var r;return f=!0,r=new n,f=!1,s(t,r,n),r}function o(){throw new Error("Unimplemented abstract function")}function e(t,n){return function(){var r,o=this._super;return this._super=n,r=t.apply(this,arguments),this._super=o,r}}function s(t,n,r){var o;for(o in t)t.hasOwnProperty(o)&&(n[o]=r&&"function"==typeof t[o]&&"function"==typeof r.prototype[o]&&a.test(t[o])?e(t[o],r.prototype[o]):t[o])}function u(o){var e,s;return s=this,e=n(),e.prototype=r(o,s),e.prototype.constructor=e,e.extend=t.bind(u,e),e.isSubClassOf=i,e}function i(t){return this.prototype instanceof t}function p(){var t,n=this;for(t in n)n.hasOwnProperty(t)&&delete n[t]}var c,f=!1,a=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;c=n(),c.prototype.destroy=p,c.extend=t.bind(u,c),c.isSubClassOf=i,c.unimplemented=o,t.add("Class",c)}(TFCApp);
"use strict";!function(e){var n,i=e.Class,t={TRACE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,OFF:6};n=i.extend({log:i.unimplemented,raise:i.unimplemented}),n.LevelMap=t,e.add("utility",n,"LoggerEngine")}(TFCApp);
"use strict";!function(n){var e=n.utility,o=e.LoggerEngine,i=(o.LevelMap,window.console),t=!!i,r={TRACE:"trace",DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"};n.add("utility",o.extend({_constructor:function(n){this.level=n},log:function(n,e){var o=r[n];t&&i[o]&&(i[o].apply?i[o].apply(i,e):i[o](e))},raise:function(){}}),"ConsoleLoggerEngine")}(TFCApp);
"use strict";!function(n){function r(n){var r=(new Error).stack;this.name="RaiseError",this.message=n,r&&(this.stack=r)}function e(r,e,t){return[[n.util.isoDateString(),r,"["+e+"]"].join(" ")].concat(t)}function t(n){for(var r=[],e=0,t=n.length;t>e;e++){var i=n[e];r.push(i&&"string"==typeof i?i.replace(/\n|\r/g,"☐"):i)}return r}function i(r,i){for(var o=l[r],g=r.replace(/\n|\r/g,"☐"),a=e(r,i,n.util.slice(arguments,2)),s=t(a),c=0,p=u.length;p>c;++c){var E=u[c];E.level<=o&&E.log(g,s)}}function o(t){for(var i=e("EXCEPTION",t,n.util.slice(arguments,1)),o=new r(i.join(" ")),g=0,a=u.length;a>g;++g){var s=u[g];s.level!==l.OFF&&s.raise(o)}throw o}var g=n.utility,l=g.LoggerEngine.LevelMap,u=[];r.prototype=Object.create(Error.prototype),r.prototype.constructor=r;var a={RaiseError:r,getLogger:function(r){return{trace:n.bind(i,null,"TRACE",r),debug:n.bind(i,null,"DEBUG",r),info:n.bind(i,null,"INFO",r),warn:n.bind(i,null,"WARN",r),error:n.bind(i,null,"ERROR",r),raise:n.bind(o,null,r)}},registerLoggingEngine:function(n){u.push(n)}};a.registerLoggingEngine(a.console=new g.ConsoleLoggerEngine(n.isDevMode()?l.DEBUG:l.WARN)),n.add("utility",a,"Logger")}(TFCApp);
"use strict";/*!
 * domready (c) Dustin Diaz 2012 - License MIT
 */
!function(t){function e(t){for(g=1;t=d.shift();)n(t)}function n(t){try{t()}catch(e){r.error(e)}}var o,c,r=t.utility.Logger.getLogger("TFCdomready"),d=[],a=!1,i=document,u=i.documentElement,f=u.doScroll,s="DOMContentLoaded",l="addEventListener",h="onreadystatechange",m="readyState",y=f?/^loaded|^c/:/^loaded|c/,g=y.test(i[m]);i[l]&&i[l](s,o=function(){i.removeEventListener(s,o,a),e()},a),f&&i.attachEvent(h,o=function(){/^c/.test(i[m])&&(i.detachEvent(h,o),e())}),t.extLibs.domready=c=f?function(t){self!=top?g?n(t):d.push(t):function(){try{u.doScroll("left")}catch(e){return setTimeout(function(){c(t)},50)}n(t)}()}:function(t){g?n(t):d.push(t)}}(TFCApp);
"use strict";!function(){window.TFPApp={analytics:{},component:{},utility:{},manager:{},view:{},nav:{}}}();
"use strict";!function(t){var e=t.Class,n=e.unimplemented,i=e.extend({getElem:n,setElem:n,removeElem:n,_each:n,_eachReverse:n,_size:function(){var e=0;return t.util.each(this,function(){++e}),e},_containsKey:function(e){var n=this;return!!t.util.find(n,function(i){return t.util.objEquals(i,e,n._strictKeys)})},_containsVal:function(e,n){return!!t.util.find(this,function(i,u){return t.util.objEquals(u,e,n)})},_isSorted:!1,_strictKeys:!0});t.add("Collection",i)}(TFCApp);
"use strict";!function(t){var e=t.Collection.extend({_constructor:function(e,i){var n=this;void 0!==e&&(n._strictKeys=e),i?t.util.usesStrictKeys(i)&&!n._strictKeys?(n._map=[],t.util.each(i,t.bind(n.setElem,n))):n._map=t.util.keyValPairs(i):n._map=[]},getElem:function(t){var e=this._findEntry(t);return e&&e.val.val},setElem:function(t,e){var i=this._map,n=this._findEntry(t);n?n.val.val=e:i.push({key:t,val:e})},removeElem:function(t){var e=this._findEntry(t);return e&&this._map.splice(e.key,1),e&&e.val.val},_each:function(t){var e,i,n=this._map;for(e=0;e<n.length&&(i=n[e],t(i.key,i.val)!==!1);++e);},_eachReverse:function(t){var e,i,n=this._map;for(e=n.length-1;e>=0&&(i=n[e],t(i.key,i.val)!==!1);--e);},_findEntry:function(e){var i=this;return t.util.find(i._map,function(n,r){return t.util.objEquals(r.key,e,i._strictKeys)})},_size:function(){return this._map.length},_map:null,_isSorted:!0});t.SortedMap=e}(TFCApp);
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(n,t,e){function r(){return d.getLogger("TFCUtil")}function o(n,t){return t}function i(n){return n===e?!0:n}function u(n){var t;return n instanceof y?n:(t=h.type(n),"array"===t?new f(e,n):"object"===t||"function"===t?new p(e,n):void m.raise("Object is not a collection-like type",n))}function a(n){return n instanceof l?n.obj():n}function c(n,t){h[n+h.capitalize(t)]=function(){var e=h[n].apply(h,arguments);return e&&e[t]}}function s(n){return!(!n||"function"!==h.type(n.then))}var l,f,p,h={},d=n.utility.Logger,m=r(),y=n.Collection,g=Array.prototype,v=g.slice,b=navigator.userAgent;l=y.extend({getElem:function(n){return this._obj[n]},setElem:function(n,t){this._obj[n]=t},obj:function(){return this._obj},_containsKey:function(n){return n in this._obj},_obj:null,_strictKeys:!0}),f=l.extend({_constructor:function(n,t){this._obj=t||[]},pushElem:function(n){this._obj.push(n)},removeElem:function(n){var t=this.getElem(n);return this._obj.splice(n,1),t},_each:function(n){var t,e=this._obj;for(t=0;t<e.length&&n(t,e[t])!==!1;++t);},_eachReverse:function(n){var t,e=this._obj;for(t=e.length-1;t>=0&&n(t,e[t])!==!1;--t);},_size:function(){return this._obj.length},_containsVal:function(n,t){var e=g.indexOf;return t&&e?e.call(this._obj,n)>=0:this._super(n,t)},_isSorted:!0}),p=l.extend({_constructor:function(n,t){this._obj=t||{}},removeElem:function(n){var t=this.getElem(n);return delete this._obj[n],t},_each:function(n){var t,e=this._obj;for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&n(t,e[t])===!1)break}}),h.stringToBool=function(n){return"true"===n},h.stringStartsWith=function(n,t){return 0===n.lastIndexOf(t,0)},h.stringEndsWith=function(n,t){return n.indexOf(t,n.length-t.length)>=0},h.filter=function(n,t){return h.partition(n,t)["true"]},h.partition=function(n,t){var e=u(n),r=new e.constructor(e._strictKeys),o=new e.constructor(e._strictKeys);return h.each(e,function(n,e){var i=t(n,e)?r:o;i instanceof f?i.pushElem(e):i.setElem(n,e)}),{"true":a(r),"false":a(o)}},h.map=function(n,t){var e=u(n),r=new e.constructor(e._strictKeys);return h.each(e,function(n,e){r instanceof f?r.pushElem(t(n,e)):r.setElem(n,t(n,e))}),a(r)},h.flatMap=function(n,t){return h.filter(h.map(n,t),function(n,t){return null!==t&&t!==e})},h.reverse=function(n){var t,e=u(n);return t=new e.constructor(e._strictKeys),h.eachReverse(e,function(n,e){t instanceof f?t.pushElem(e):t.setElem(n,e)}),a(t)},h.count=function(n,t){return h.size(h.filter(n,t))},h.sum=function(n){var t=0;return h.each(n,function(n,e){t+=e}),t},h.noop=function(){},h.reduce=function(n,t,r){var o,i=!1;if(r!==e)o=r;else{if(!h.isArray(n))throw new Error("you must provide an initial value when reducing an object");if(0===n.length)throw new TypeError("Reduce of empty array with no initial value");o=n[0],n=n.slice(1),i=!0}return h.each(n,function(e,r){e=i?e+1:e,o=t(o,e,r,n)}),o},h.groupByPreservingOrder=function(t,e,r){var o,c=u(t);if(r=i(r),o=new n.SortedMap(r),!c._isSorted)throw"TFCApp.util.groupByPreservingOrder cannot preserve order on unordered inputs";return h.each(c,function(n,t){var r,i=e(n,t);h.containsKey(o,i)?r=o.getElem(i):(r=new c.constructor(c._strictKeys),o.setElem(i,r)),c instanceof f?r.pushElem(t):r.setElem(n,t)}),h.map(o,function(n,t){return a(t)})},h.objKeys=function(n){var t=[];return h.each(n,function(n){t.push(n)}),t},h.objVals=function(n){var t=[];return h.each(n,function(n,e){t.push(e)}),t},h.keyValPairs=function(n){var t=[];return h.each(n,function(n,e){t.push({key:n,val:e})}),t},h.forAll=function(n,t){var e=!0;return h.each(n,function(n,r){return e=t(n,r)}),e},h.exists=function(n,t){return!!h.find(n,t)},h.objEquals=function(n,t,e){var r,o;return n===t?!0:(e=i(e))?n===t:(r=h.type(n),o=h.type(t),"object"===r||"array"===r?r===o&&h.size(n)===h.size(t)&&h.forAll(n,function(n,r){return h.objEquals(r,t[n],e)}):n===t)},h.size=function(n){return u(n)._size()},h.isEmpty=function(n){return 0===h.size(n)},h.nonEmpty=function(n){return h.size(n)>0},h.containsKey=function(n,t){return u(n)._containsKey(t)},h.containsVal=function(n,t,e){return e=i(e),u(n)._containsVal(t,e)},h.distinctVals=function(n,t){var e=[];return t=i(t),h.each(n,function(n,r){h.containsVal(e,r,t)||e.push(r)}),e},h.loadScript=function(n){function t(n){return function(){o.removeChild(e),n&&n()}}var e,r,o=document.body;return h.isNonZeroLengthString(n.url)||m.raise("loadScript options must have a non-empty url",n),n.cache=!1!==n.cache,n.cache||(n.data&&n.data.hasOwnProperty("_")&&m.error("do not use _ as a parameter name! loadScript will overwrite data._"),n.data=h.extend(n.data,{_:h.now()})),"object"===h.type(n.data)&&(r=n.url.indexOf("?")>-1?"&":"?",n.url+=r+h.param(n.data)),e=document.createElement("script"),e.type="text/javascript",e.async=!0,e.src=n.url,e.onload=t(n.success),e.onerror=t(n.error),void o.appendChild(e)},h.getCookie=function(n){var t=null;return h.each(document.cookie.split("; "),function(e,r){var o=r.indexOf("="),i=r.substr(0,o);return i===n?(t=r.substr(o+1),!1):void 0}),t},h.setCookie=function(n){var t,e,r,o,i;"object"===h.type(n)&&"string"===h.type(n.name)&&"string"===h.type(n.value)?(t=n.name+"="+n.value,e=n.domain,h.isNonZeroLengthString(e)&&(t+=";domain="+e),r=h.isNonZeroLengthString(n.path)?n.path:"/",t+=";path="+r,o=parseInt(n.maxAge),isNaN(o)||(0>=o?o=i=0:i=(new Date).getTime()+1e3*o,t+=";max-age="+o,t+=";expires="+new Date(i).toUTCString()),n.secure&&(t+=";secure"),document.cookie=t):m.warn("Invalid arguments, not setting the cookie. [data: "+JSON.stringify(n)+"]")},h.deleteCookie=function(n){"object"===h.type(n)&&h.setCookie({name:n.name,value:"",domain:n.domain,secure:n.secure,path:n.path,maxAge:0})},function(){var n,t,e;n="\\[]{}()+*?!=^$,.-|:",t="\\"+n.split("").join("\\"),e=new RegExp("(["+t+"])","g"),h.regexSafe=function(n){return n.replace(e,"\\$1")},n=t=null}(),h.parseOrigin=function(n){return n.replace(/^\s*([^:]+:[\/\\]{2}[^\/\?\#\\]*).*$/,"$1")},h.parseParentDomain=function(n){var t,e,o=r();return n=n||document.location.href,t=h.parseOrigin(n).replace(/^[^:]+:[\/\\]{2}([^:]*)(:[0-9]+)?$/,"$1"),""===t||"localhost"===t||"about:blank"===t?null:t===n?(o.error("Could not parse domain from URL "+n),null):(e=/(^[^\.]+$)|([^\.]+\.((?:com|[^\.]{2})\.)?[^\.]+\.?$)/.exec(t),e?e[0]:(o.error("Could not parse parent domain from domain "+t),null))},h.parseAllSubDomains=function(n){n=n||document.location.href;var t=h.parseParentDomain(n);if(null===t)return[];var e=h.parseOrigin(n),r=e.split("//")[1].split(":")[0],o=[];r!==t&&(o=r.substring(0,r.lastIndexOf(t)-1).split("."));var i=t,u=[i];return h.eachReverse(o,function(n,t){u.push(i=t+"."+i)}),u},h.isNonZeroLengthString=function(n){return"string"===h.type(n)&&n.length>0},h.addParamIfNonZeroLengthString=function(n,t,e){h.isNonZeroLengthString(e)&&(n[t]=e)},h.addParamIfDefined=function(n,t,r){r!==e&&(n[t]=r)},h.chooseUri=function(n,t){return"https:"===document.location.protocol?n:t},h.arrayToPairs=function(n){var t={};return h.each(n,function(n,e){t[e]=e}),t},h.param=function(n,t){if("object"!==h.type(n))throw"Invalid argument passed to util.param ["+h.type(n)+"]";var e=[];return h.each(n,function(n,r){var o=h.type(r);h.isPrimitive(r)?e.push(encodeURIComponent(n)+"="+encodeURIComponent(r)):"array"===o&&t?h.each(r,function(t,r){e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):"array"===o||"object"===o?e.push(encodeURIComponent(n)+"="+encodeURIComponent(JSON.stringify(r))):m.raise("Invalid type passed to util.param",n,r)}),e.join("&")},h.deparam=function(n){var t,e,r,o,i,u={},a=n.split("&");for(t=0,e=a.length;e>t;++t)if(r=a[t].split("=",2),2===r.length)try{o=decodeURIComponent(r[0]),i=decodeURIComponent(r[1]),u[o]=i}catch(c){m.warn("Failed to decode query parameters[key="+r[0]+",value="+r[1]+"]")}return u},h.getAttributes=function(n){var t={};return h.each(n.get(0).attributes,function(n,e){t[e.nodeName]=e.nodeValue}),t},h.keyToPrintableCharacter=function(n){var t=String.fromCharCode(n),e=t.charCodeAt(0);return e>=32&&126>=e?t:""},h.arrayIndexOf=function(n,t){var e=-1;return h.each(n,function(n,r){return r===t?(e=n,!1):void 0}),e},h.getQueryParams=function(n){return h.deparam((n||h.getLocationWithoutHash()).split("?",2)[1]||"")},h.getLocationWithoutHash=function(){return document.location.href.split("#",2)[0]},h.getLocationHash=function(){return/^[^#]+#?(.*)$/.exec(document.location.href)[1]},h.isTouchSupported="object"==_typeof(t.Touch),h.supportsTransitions=function(){var n=document.documentElement.style;return n.webkitTransition!==e||n.MozTransition!==e||n.OTransition!==e||n.transition!==e},h.syncTiming=function(n){return h.asyncTiming(function(t){var e=n();return{elapsed:t(),result:e}})},h.asyncTiming=function(n){var t=(new Date).getTime();return n(function(){return(new Date).getTime()-t})},h.defaultValue=function(n,t){return n!==e?n:t},h.addIfDefined=function(n,t,r){var o=t[n];o!==e&&(r[n]=o)},h.randomInt=function(n,t){return n+Math.floor((t-n+1)*Math.random())},h.uuid=function(){function n(n){for(var t="",e=0;e<n.length;++e)t+=n[e].toString(16);return t}var e=t.crypto||t.msCrypto;return e&&t.Uint8Array?function(){for(var t=new Uint8Array(16),r=e.getRandomValues(t),o=[],i=0;i<r.length;++i)o.push(12===o.length?4:16===o.length?3&r[0]|8:r[i]>>4),o.push(15&r[i]);return n(o.splice(0,8))+"-"+n(o.splice(0,4))+"-"+n(o.splice(0,4))+"-"+n(o.splice(0,4))+"-"+n(o)}:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){return("x"===n?h.randomInt(0,15):8|h.randomInt(0,3)).toString(16)})}}(),h.each=function(n,t){n&&u(n)._each(t)},h.eachReverse=function(n,t){n&&u(n)._eachReverse(t)},h.usesStrictKeys=function(n){return u(n)._strictKeys},h.extend=function(n){var t=h.slice(arguments,1);return n=n||{},h.each(t,function(t,e){e&&h.each(e,function(t,e){n[t]=e})}),n},h.slice=function(n){return h.isArrayLike(n)||m.raise("You must provide an array-like object to util#slice"),v.apply(n,v.call(arguments,1))},h.last=function(n){return h.isArrayLike(n)||m.raise("You must provide an array-like object to util#last"),n[n.length-1]},h.drop=function(n,t){return h.isArrayLike(n)||m.raise("You must provide an array-like object to util#drop"),t===e&&(t=1),v.call(n,Math.max(0,t))},h.dropRight=function(n,t){return h.isArrayLike(n)||m.raise("You must provide an array-like object to util#dropRight"),t===e&&(t=1),t=n.length-t,v.call(n,0,Math.max(0,t))},h.pad=function(n){return("number"!==h.type(n)||0>n||n%1!==0)&&m.raise("util.pad called with non-natural number:",n),10>n&&"0"+n||n.toString()},/*! Adapted from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString
   *  Any copyright is dedicated to the Public Domain. http://creativecommons.org/publicdomain/zero/1.0/ */
h.isoDateString=function(){var n=h.pad,t=new Date;return t.getFullYear()+"-"+n(t.getMonth()+1)+"-"+n(t.getDate())+" "+n(t.getHours())+":"+n(t.getMinutes())+":"+n(t.getSeconds())+"."+(t.getMilliseconds()/1e3).toFixed(3).slice(2)},h.now=function(){return(new Date).getTime()},h.isNaN=function(n){return"number"===h.type(n)&&isNaN(n)},h.isPrimitive=function(n){var t=h.type(n);return"boolean"===t||"number"===t||"string"===t},/*!
   * Start of code derived from jQuery
   */
/*!
   * jQuery JavaScript Library v1.8.3
   * http://jquery.com/
   *
   * Includes Sizzle.js
   * http://sizzlejs.com/
   *
   * Copyright 2012 jQuery Foundation and other contributors
   * Released under the MIT license
   * http://jquery.org/license
   *
   * Date: Tue Nov 13 2012 08:20:33 GMT-0500 (Eastern Standard Time)
   */
function(){var n,t,e=Object.prototype.toString,r={},o="Boolean Number String Function Array Date RegExp Object".split(" ");for(n=0;n<o.length;++n)t=o[n],r["[object "+t+"]"]=t.toLowerCase();h.type=function(n){return null==n?String(n):r[e.call(n)]||"object"}}(),h.isPlainObject=function(n,t){return t=t===e?!0:t,!(!n||"object"!==h.type(n)||t&&n.constructor!==Object)},h.isArray=function(n){return"array"===h.type(n)},h.isFunction=function(n){return"function"===h.type(n)},h.isVisible=function(n){return n.offsetWidth>0||n.offsetHeight>0},/*!
   * End of code derived from jQuery
   */
h.isConstructor=function(n){try{return!0}catch(t){return!1}},h.capitalize=function(n){return n.charAt(0).toUpperCase()+n.substr(1)},h.camelCase=function(){var n=/-(\w)/g;return function(t){return t.toLowerCase().replace(n,function(n,t){return t.toUpperCase()})}}(),h.find=function(n,t){var r=e;return h.each(n,function(n,e){return t(n,e)?(r={key:n,val:e},!1):void 0}),r},h.head=function(n){var t;if(n!==e){if(t=u(n),!t._isSorted)throw new Error("TFCApp.util.head is not intended for unordered inputs");return h.find(t,function(){return!0})}return e},h.each(["find","head"],function(n,t){c(t,"key"),c(t,"val")}),h.readOnly=function(n,t){return t===e&&(t=!0),"object"!==h.type(n)||s(n)||h.each(n,function(e,r){var o=!!(r&&"object"===h.type(r)&&n.hasOwnProperty(e)&&Object.getOwnPropertyDescriptor(n,e).writable);Object.defineProperty(n,e,{writable:!1}),t&&o&&h.readOnly(r,t)}),n},h.hashKey=function(n){var t,e,r,o=h.type(n);switch(o){case"array":return t=h.map(n,function(n,t){return h.hashKey(t)}),"["+t.join(",")+"]";case"object":return e=h.objKeys(n).sort(),r=h.map(e,function(t,e){return JSON.stringify(e)+":"+h.hashKey(n[e])}),"{"+r.join(",")+"}";case"date":return n.toUTCString();case"string":return JSON.stringify(n);case"null":case"undefined":return o;case"boolean":case"number":case"regexp":case"function":return n.toString()}},h.isArrayLike=function(n){return!(!n||"number"!==h.type(n.length))},/*!
   * Code in this section is derived from underscore.js
   *
   *     Underscore.js 1.8.3
   *     http://underscorejs.org
   *     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *     Underscore may be freely distributed under the MIT license.
   */
h.throttle=function(n,t,e){var r,o,i,u,a=0;e||(e={});var c=function(){a=e.leading===!1?0:h.now(),r=null,u=n.apply(o,i),r||(o=i=null)},s=function(){var s=h.now();a||e.leading!==!1||(a=s);var l=t-(s-a);return o=this,i=arguments,0>=l||l>t?(r&&(clearTimeout(r),r=null),a=s,u=n.apply(o,i),r||(o=i=null)):r||e.trailing===!1||(r=setTimeout(c,l)),u};return s.cancel=function(){clearTimeout(r),a=0,r=o=i=null},s},h.debounce=function(n,t,e){var r,o,i,u,a,c=function s(){var c=h.now()-u;t>c&&c>=0?r=setTimeout(s,t-c):(r=null,e||(a=n.apply(i,o),r||(i=o=null)))};return function(){i=this,o=arguments,u=h.now();var s=e&&!r;return r||(r=setTimeout(c,t)),s&&(a=n.apply(i,o),i=o=null),a}},/*!
   End underscore.js code
   */
h.each({max:-1/0,min:1/0},function(n,t){h[n]=function(e,r){var i=t,u=null;return r=r||o,h.each(e,function(e,o){var a=r(e,o);(a!==i&&Math[n](i,a)===a||a===t&&null===u)&&(i=a,u={key:e,val:o},u[n]=a)}),u},h[n+"Val"]=function(t,e){var r=h[n](t,e);return r&&r[n]}}),h.round=function(n,t){t=t||0;var e=Math.pow(10,t);return Math.round(n*e)/e},h.retry=function(n,t,e,r,o){function i(c){u=(new Date).getTime(),n(t,function(){var n;n="consistentInterval"===r?o:o*(1<<c-1);var t=(new Date).getTime()-u,s=n-t;c===a?e():setTimeout(function(){i(++c)},Math.max(0,s))})}var u,a=10;o="undefined"!=typeof o?o:100,i(1)},h.isHttpSuccess=function(n){return n>=200&&300>n},h.isRealMouseEvent=function(n){return n.isTrusted===!1?!1:!(0===n.screenX&&0===n.screenY&&0===n.clientX&&0===n.clientY)},h.browser=h.readOnly({isEdge:/Edge/.test(b),isIE:/MSIE/.test(b)},!0),h.prependToStyleTag=function(n,t){return n.styleSheet?n.styleSheet.cssText=t+n.styleSheet.cssText:n.textContent=t+n.textContent,n},h.placeOnPage=function(n,t){return t=t||document.getElementsByTagName("script")[0],t.parentNode.insertBefore(n,t),n},h.sameOrigin=function(n,t){return t===n||t+":80"===n||n+":80"===t},h.range=function(n,t){for(var e=[],r=n;t>=r;r++)e.push(r);return e},h.isSingular=function(n){return 1===n},h.arrayToObject=function(n,t,e){var r={};return h.each(n,function(n,o){r[t(o)]=e(o)}),r},h.invert=function(n){var t={};return h.each(n,function(n,e){t[e]=n}),t},n.add("util",h)}(TFCApp,window,void 0);
"use strict";!function(e){e.KeyCodes={Enter:13,Escape:27,Up:38,Down:40,Tab:9}}(TFCApp);
"use strict";!function(t){function n(){for(var t="",n=0;I>n;n++)t+="  ";return t}function e(t,e,r){var i=!0,u=O.slice(arguments,3),s=u.length>1;return O.each(u,function(r,c){var o,p=t[r];if(c instanceof a){if(!c.test(p))return o=["Invalid argument(s) passed to "+(e||"function")+". \nExpected type"+(s?"s":"")+":(",O.map(u,function(t,e){return"\n"+n()+e.expected()}),"\n)\nbut got:\n"],i=[o.join(""),t,". Additionally, Function.prototype.bind=",Function.prototype.bind.toString()],!1}else S.raise("Invalid argument passed to TFCApp.checkArgs (curry 2)")}),r(i)}function r(n,r,i){return O.isArrayLike(n)&&(void 0===r||O.isNonZeroLengthString(r))?t.bind(e,null,n,r,i):void S.raise("Invalid argument passed to TFCApp.checkArgs (curry 1)")}function i(t,n){return r(t,n,function(t){return t!==!0&&(S.error.apply(S,t),S.raise("Invalid arguments found by checkArgs. See error log.")),t})}function u(t,n){return r(t,n,function(t){return t!==!0&&S.error.apply(S,t),t})}function s(t,n){(!O.isArray(t)||t.length<2||!c(t))&&S.raise(n+" requires an array of at least two types as its type")}function c(t){var n=O.isPlainObject(t)||O.isArray(t);return n&&O.each(t,function(t,e){return e instanceof a?void 0:(n=!1,!1)}),n}var o,a,p,f,_,l,d,h,y,g,v,x,m,w,b,T,A=t.Class,j=A.unimplemented,O=t.util,S=t.utility.Logger.getLogger("TypeHelper"),I=1;a=A.extend({_constructor:function(t,n,e){this._type=t,this.__not=!!n,this.__optional=!!e},not:function(){return new(this._class())(this._type,!this.__not,this.__optional)},optional:function(){return new(this._class())(this._type,this.__not,!0)},test:function(t){return this.__optional&&void 0===t||this.__not&&!this._test(t)||!this.__not&&this._test(t)},_test:j,expected:function(){var t=(this.__not?"not ":"")+this._expected();return this.__optional?"optional("+t+")":t},_expected:j,_class:j,_type:null,__not:null,__optional:null}),p=a.extend({_test:function(t){return O.type(t)===this._type},_expected:function(){return this._type},_class:function(){return p}}),l=p.extend({_constructor:function(t,n,e){this._super("number",n,e)},_class:function(){return l},fromString:function(t){i(arguments)(o.String);var n=parseFloat(t);return isFinite(n)?n:void 0}}),d=l.extend({_test:function(t){return this._super(t)&&t%1===0},_expected:function(){return"integer"},_class:function(){return d},fromString:function(t){i(arguments)(o.String);var n=this._super(t);return this._test(n)?n:void 0}}),h=p.extend({_constructor:function(t,n,e){this._super("boolean",n,e)},_class:function(){return h},fromString:function(t){switch(i(arguments)(o.String),t){case"true":return!0;case"false":return!1}return void 0}}),y=p.extend({_constructor:function(t,n,e){this._super("string",n,e)},_class:function(){return y},fromString:function(t){return i(arguments)(o.String),t}}),g=p.extend({_constructor:function(t,n,e){this._super("array",n,e)},_class:function(){return g}}),w=a.extend({_constructor:function(t,n,e){s(t,"TupleType"),this._super(t,n,e)},_test:function(t){var n=O.isArray(t)&&t.length===this._type.length;return n&&O.each(this._type,function(e,r){return r.test(t[e])?void 0:(n=!1,!1)}),n},_expected:function(){var t=O.map(this._type,function(t,n){return n.expected()});return"Tuple"+t.length+"["+t.join(", ")+"]"},_class:function(){return w}}),b=a.extend({_constructor:function(t,n,e){s(t,"OrType"),this._super(t,n,e)},_test:function(t){var n=!1;return O.each(this._type,function(e,r){return r.test(t)?(n=!0,!1):void 0}),n},_expected:function(){var t=O.map(this._type,function(t,n){return n.expected()});return"one of ("+t.join(", or ")+")"},_class:function(){return b}}),T=a.extend({_constructor:function(n,e,r){var i=t.type.Tuple(t.type.Or(t.type.Instance(g),t.type.Instance(v)),t.type.Instance(a));i.test(n)||S.raise("OfType requires "+i.expected()+" as its type"),this._super(n,e,r)},_test:function(t){var n=this._type,e=n[0].test(t);return e&&O.each(t,function(t,r){return n[1].test(r)?void 0:(e=!1,!1)}),e},_expected:function(){var t=this._type;return t[0].expected()+" of "+t[1].expected()},_class:function(){return T}}),f=p.extend({_constructor:function(t,n,e){var r=t.fieldTypes,i=O.isPlainObject(r);i&&O.each(r,function(t,n){return n instanceof a?void 0:(i=!1,!1)}),i||S.raise("ObjectType type argument must be a plain object with Type values"),this._super(t,n,e)},_test:function(t){var n=this._type,e=O.isPlainObject(t,n.strict);return e&&O.each(n.fieldTypes,function(n,r){return r.test(t[n])?void 0:(e=!1,!1)}),e},_expected:function(){var t=[];return I++,O.each(this._type.fieldTypes,function(e,r){t.push(n()+e+":"+r.expected())}),I--,"{\n"+t.join(", \n")+"\n"+n()+"}"},_class:function(){return f}}),v=f.extend({_constructor:function(t,n,e){this._super({fieldTypes:{}},n,e)},_expected:function(){return"object"},_class:function(){return v}}),_=a.extend({_constructor:function(t,n,e){O.isConstructor(t)||S.raise("InstanceType type argument must be a function/constructor"),this._super(t,n,e)},_test:function(t){return t instanceof this._type},_expected:function(){return"instance of "+(this._type.name||"anonymous")},_class:function(){return _}}),m=a.extend({_test:function(){return!0},_expected:function(){return"any"},_class:function(){return m}}),x=new p("function"),o={Any:new m,Null:new p("null"),Boolean:new h,Number:new l,Integer:new d,String:new y,Function:x,Array:new g,PlainObject:new v,Promise:new f({fieldTypes:{then:x},strict:!1}),Object:function(t,n){return new f({fieldTypes:t,strict:n})},Instance:function(t){return new _(t)},Tuple:function(t){return t=O.slice(arguments),new w(t)},Or:function(t){return t=O.slice(arguments),new b(t)},ArrayOf:function(t){return new T([o.Array,t])},ObjectOf:function(t){return new T([o.PlainObject,t])}},t.add("type",o),t.add("checkArgs",i),t.add("checkArgsSoft",u)}(TFCApp);
"use strict";!function(e){var t=e.util,n=e.type,r=e.checkArgs,s=e.utility.Logger.getLogger("Http"),a=e.Constants.Header,o=function(e,n){var r={};return n&&t.each(n,function(e,n){t.addParamIfNonZeroLengthString(r,e,n)}),e+"?"+t.param(r,!1)},i=/^\)]\}',?\n/,c=4,u={post:function(e){r(arguments)(n.Object({serviceSecureUrl:n.String,data:n.Or(n.String,n.PlainObject,n.Array),userToken:n.String.optional(),queryParameters:n.PlainObject.optional(),headers:n.PlainObject.optional(),success:n.Function.optional(),failure:n.Function.optional()}));var s=e.data;e.payload=t.isPlainObject(s)||t.isArray(s)?JSON.stringify(s):s,e.method="POST",this._sendRequest(e)},get:function(e){r(arguments)(n.Object({serviceSecureUrl:n.String,responseType:n.String.optional(),userToken:n.String.optional(),queryParameters:n.PlainObject.optional(),success:n.Function.optional(),failure:n.Function.optional(),withCredentials:n.Boolean.optional()})),e.method="GET",this._sendRequest(e)},_addHeaders:function(e,n){n&&t.each(n,function(t,n){e.setRequestHeader(t,n)})},_sendRequest:function(n){var r,u,p=n.method,l=n.serviceSecureUrl,d=n.payload,g=n.queryParameters,f=n.responseType,T=n.success,h=n.failure,S=!!n.withCredentials,y=n.headers?n.headers:{},m=n.userToken;m&&(y[a.UserToken]=m),t.isNonZeroLengthString(l)&&(r=new XMLHttpRequest,u=o(l,g),"withCredentials"in r?(r.withCredentials=S,r.open(p,u,!0),this._addHeaders(r,y),"POST"===p&&r.setRequestHeader("Content-Type","application/json; charset=UTF-8")):"undefined"!=typeof XDomainRequest&&(r=new XDomainRequest,r.open(p,u))),r&&(r.send(d),r.onreadystatechange=function(){if(r.readyState===c)if(t.isHttpSuccess(r.status)){if(e.cookieHelper){var n=r.getAllResponseHeaders().split("\r\n"),o=function(e){return e.split(": ")[0].toLowerCase()},u=function(e){return e.split(": ")[1]},p=t.arrayToObject(n,o,u),l=p[a.UserToken],d=parseInt(p[a.UserTokenMaxAge]),g=p[a.UserTokenDomain],S=!!p[a.UserTokenSecure];l&&e.cookieHelper.userToken(l,t.isNaN(d)?void 0:d,g,S)}if("json"===f&&r.responseText.trim().length>0)try{r.data=JSON.parse(r.responseText.replace(i,"").trim()),T&&T(r)}catch(y){s.error("Unable to parse JSON from HTTP response expecting JSON [response text: "+r.responseText+"]"),h&&h(r)}else T&&T(r)}else h&&h(r)})}};e.add("utility",u,"Http")}(TFCApp);
"use strict";!function(e){e.FitRecUtil={animateFitScore:function(t,c,i,s,n){function r(){setTimeout(function(){d.text(s[a]),u.text(n[a]),f.hide().show(0)},1),m.animate({opacity:1},o/2)}var o=i||500,a=this.fitDescriptionKey(c),f=e.extLibs(".tfc-fitrec-result",t),d=e.extLibs(".tfc-fit-score-description",f),u=e.extLibs(".tfc-fit-score-description-legacy",f),m=e.extLibs(".tfc-fit-score",f),l=e.extLibs(".tfc-fit-score-background",f),p=e.extLibs(".tfc-fit-score-foreground",l),x=c/5*100+"%";d.text(""),m.text(""),p.css("width",""),this.recommended(c)?f.removeClass("tfc-not-recommended"):f.addClass("tfc-not-recommended"),p.length?p.css("width","0%").animate({width:x},o,r):r()},fitDescriptionKey:function(e){switch(parseFloat(e)){case 5:case 4.5:case 4:return"excellentFit";case 3.5:case 3:return"goodFit";case 2.5:case 2:case 1.5:case 1:case.5:case 0:return"notRecommended";default:return""}},recommended:function(e){return"undefined"!=typeof e&&parseFloat(e)>=3},evalTemplate:function(t,c){var i,s,n="img[src]";if("boolean"!=typeof c&&(c=!1),"string"==typeof t)try{i=e.extLibs.parseHtml(t)}catch(r){}return void 0===i&&(i=e.extLibs()),c&&(s=i.filter(n),i.each(function(e,t){s=s.add(n,t)}),s.each(function(t,c){var i=new Image;i.src=e.extLibs(c).attr("src")})),i}}}(TFCApp);
"use strict";!function(){TFCApp.Signal=TFCApp.Class.extend({_constructor:function(){this._slots=[]},listen:function(t){if("function"!=typeof t)throw"Slot passed into Signal.listen must be a function";this._slots.push(t)},unlisten:function(t){var n,s,i=null,l=this._slots;if("function"!=typeof t)throw"Slot passed into Signal.unlisten must be a function";for(n=0,s=l.length;s>n;++n)if(l[n]===t){i=n;break}null!==i&&l.splice(i,1)},unlistenAll:function(){this._slots.splice(0)},trigger:function(){var t=arguments;this._slots.slice().forEach(function(n){n.apply(null,t)})},_slots:null})}();
"use strict";!function(t){function e(t){return r.exists([s.Boolean,s.Integer,s.Number,s.String],function(e,n){return n.test(t)})}function n(t){if(e(t))return t;if(s.Array.test(t))return r.flatMap(t,function(t,e){return n(e)});if(s.PlainObject.test(t)){var i={};return r.each(t,function(t,e){var r=n(e);void 0!==r&&null!==r&&(i[t]=r)}),i}return void 0}var r=t.util,s=t.type,i=t.utility.Logger.getLogger("PostMessage");t.utility.PostMessage={hasPostMessage:function(t){return!!t.postMessage},post:function(e,r,o){t.checkArgs(arguments)(s.Any,s.String,s.Or(s.PlainObject,s.String)),e||i.raise("Trying to post a message without a target window."),r||i.error("Trying to post a message without a target origin. Using wild card origin."),this.hasPostMessage(e)&&e.postMessage(n(o),r||"*")},receive:function(e,n,i){t.checkArgs(arguments)(s.Object({},!1),s.Function,s.String);var o;return this.hasPostMessage(e)?(o=function(t){return"*"===i||r.sameOrigin(i,t.origin)?void n(t):!1},e.addEventListener("message",o,!1),function(){e.removeEventListener("message",o,!1)}):r.noop}}}(TFCApp);
"use strict";/*!
 * jQuery postMessage - v0.5 - 9/11/2009
 * http://benalman.com/projects/jquery-postmessage-plugin/
 *
 * Copyright (c) 2009 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
!function(e,t,n){var a=1,i=e.util,r=e.type,s=e.utility.PostMessage,o=s.hasPostMessage(t),c=e.Constants.RequestParameter.WindowParams,u={},l=1e4,g="ACKNOWLEDGE",d={_callbackFailureTimeout:l,_nextCallbackId:1,_callbackListenerAction:function(e){if(e.data&&r.String.test(e.data)){var t=e.data;if(t.substring(0,g.length)==g){var n=t.substring(g.length),a=u[n];a&&i.sameOrigin(a.targetOrigin,e.origin)&&(delete u[n],clearTimeout(a.failureTimeout),a.onSuccess&&a.onSuccess())}}},_setFailureTimeout:function(e,t){var n=this;return setTimeout(function(){delete u[e],t&&t()},n._callbackFailureTimeout)},_setupCallback:function(n,a,i,r){var s=this,o=s._setFailureTimeout(n,r),c={targetOrigin:a,onSuccess:i,failureTimeout:o};u[n]=c,t.addEventListener("message",e.bind(s._callbackListenerAction,s),!1)},_sendMessageBack:function(e,t){if(e.source){var n=g+e.data;s.post(e.source,t,n)}},postMessage:function(t,n,a,i,c,u,l){e.checkArgs(arguments)(r.Any,r.String,r.String,r.String,r.Or(r.String,r.PlainObject).optional(),r.Function.optional(),r.Function.optional());var g=this;if(n&&a){var d={sourceWindowId:a,message:i,data:c};if((u||l)&&(d.tfcCallbackId=g._nextCallbackId++),o){var f=JSON.stringify(d);s.post(t,n,f),d.tfcCallbackId&&g._setupCallback(f,n,u,l)}}},receiveMessage:function(n,a,c){e.checkArgs(arguments)(r.Function,r.String,r.String);var u,l=this;return o?(u=function(e){var t,i=e.data;return r.String.test(i)?i.substring(0,g.length)===g?!1:(t=JSON.parse(i),t.sourceWindowId!==c&&d.globalWindowId()!==c?!1:(t.tfcCallbackId&&l._sendMessageBack(e,a),void n(t.message,t.data))):!1},s.receive(t,u,a)):i.noop},generateWindowParams:function(t){return e.checkArgs(arguments)(r.String),c+"="+encodeURIComponent(t+"!"+i.parseOrigin(n.URL))},parseWindowParams:function(){var e=/^([^!]+)!(.*)$/.exec(i.deparam(i.getLocationHash())[c]),t=e&&e[1],n=e&&e[2];return{sourceWindowId:t||"",retailerOrigin:n||""}},globalWindowId:function(){return"*"},retailerWindowId:function(){return"O"},fitProfileWindowId:function(){return"R"},nextWindowId:function(){return(a++).toString()}};e.postMessageManager=d}(TFCApp,window,document);
"use strict";!function(e){var s=e.Class,a=s.unimplemented,n=s.extend({userSession:a,setSessionParams:a,getSessionParams:a,setSessionParamsMaxAge:a,userToken:a});e.add("CookieHelper",n)}(TFCApp);
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){function e(t){function e(t,e){if(e instanceof HTMLElement)return e.outerHTML;if("object"===("undefined"==typeof e?"undefined":_typeof(e))){if(o.indexOf(e)>=0)return"[Circular]";o.push(e)}return e}var o=[];return JSON.stringify(t,e)}var o=t.utility,i=t.type,n=o.LoggerEngine,l=n.LevelMap;t.add("utility",n.extend({_constructor:function(e,o){t.checkArgs(arguments)(i.Object({secureUri:i.String,tla:i.String,level:i.String.optional(),loggingTimeoutDelay:i.Integer.optional(),postRequestLimit:i.Integer.optional(),clientLogLimit:i.Integer.optional(),loggingContextLimit:i.Integer.optional()}),i.Instance(t.CookieHelper));var n=this,g={secureUri:e.secureUri,tla:e.tla,level:e.level||"ERROR",loggingTimeoutDelay:e.loggingTimeoutDelay||1e3,postRequestLimit:e.postRequestLimit||25,clientLogLimit:e.clientLogLimit||20,loggingContextLimit:e.loggingContextLimit||4},r="/consumer/ui/"+g.tla+"/client-log";n.level=l[g.level],n._cfg=g,n._serviceSecureUrl=g.secureUri+r,n._clientLogs=[],n._timeout=null,n._postCount=0,n._loggingContext=[],n._cookieHelper=o},log:function(t,o){var i=l[t],n=this,g=n._cfg,r=n.level;0!==g.loggingContextLimit&&(i===l.INFO||r===l.ERROR&&i===l.WARN)&&(n._loggingContext.length===g.loggingContextLimit&&n._loggingContext.shift(),n._loggingContext.push(e(o))),n._post({level:t,message:e(o)})},raise:function(t){this._post({level:"ERROR",error:t})},_post:function(t){var e,i,n,l=this,g=l._cfg;l._postCount<g.postRequestLimit&&(null===l._timeout&&(l._timeout=setTimeout(function(){e=l._cookieHelper.userSession(),i=l._cookieHelper.userToken(),++l._postCount,o.Http.post({serviceSecureUrl:l._serviceSecureUrl,queryParameters:n,data:{clientLogs:l._clientLogs,postNumber:l._postCount,loggingContext:l._loggingContext},userToken:i}),l._clientLogs=[],l._timeout=null,l._loggingContext=[]},g.loggingTimeoutDelay)),l._clientLogs.length<g.clientLogLimit&&l._clientLogs.push(t))}}),"HttpLoggerEngine")}(TFCApp);
"use strict";!function(t){var n=t.util,r=window.history,a=["pushState","replaceState"],e=r&&n.forAll(a.concat("state"),function(t,n){return n in r});t.history=e?r:n.extend({state:null},n.map(n.arrayToPairs(a),function(){return n.noop}))}(TFCApp);
"use strict";!function(t){var e=t.type,i=t.Class.extend({_constructor:function(i,n){t.checkArgs(arguments)(e.Any,e.Function),this._value=i,this._write=n},read:function(){return this._value},write:function(t){this._write(this._value=t)}});t.utility.TempStorage=i}(TFCApp);
"use strict";!function(t){var e="tfc-ls",r=window.localStorage,a=t.utility.Logger.getLogger("LocalStorage"),n=t.Class.extend({isEnabled:function(){var t=function(){return r&&r.getItem(e)},n=function(){try{r.setItem(e,"{}")}catch(n){a.info("Unable to set value in localStorage",n)}return t()};return!(!t()&&!n())},get:function(t){var e=this._getLocalStorageObject();return e[t]},set:function(t,n){var o=this._getLocalStorageObject();o[t]=n;try{return r.setItem(e,JSON.stringify(o)),!0}catch(c){return a.info("Unable to set value in localStorage",c),!1}},_getLocalStorageObject:function(){var t=r.getItem(e);return t&&JSON.parse(t)||{}}});t.add("utility",n,"LocalStorage")}(TFCApp);
"use strict";!function(e){var t,n=e.utility,r=e.util,i=e.type,o=n.Logger.getLogger("Storage"),a="tfc-l",s="tfc-s",l=31536e4,g={Analytics:"a",UserVisit:"v",UserSettings:"s",User:"u",Test:"t",Token:"k"},c={};c[g.Analytics]="tfcAnalytics",c[g.UserVisit]="tfcUserVisit",c[g.UserSettings]="tfcUserSettings",c[g.User]="_tfcUserCookie",t=e.Class.extend({_constructor:function(t){e.checkArgs(arguments)(i.Object({readImpl:i.Function,writeImpl:i.Function,deleteImpl:i.Function,supportsLegacyCookies:i.Boolean.optional()})),this._readImpl=t.readImpl,this._writeImpl=t.writeImpl,this._deleteImpl=t.deleteImpl,this._supportsLegacyCookies=t.supportsLegacyCookies||!1},_getLegacyCookieName:function(e){return this._supportsLegacyCookies?c[e]:void 0},_writeOne:function(t,n,a,s,l){e.checkArgs(arguments)(i.String,i.PlainObject,i.Integer.optional(),i.String.optional(),i.Boolean.optional());var g,c,u=this;if(r.isEmpty(n))u._deleteImpl(t);else{g=encodeURIComponent(JSON.stringify(n)),c=t.length+g.length,c>4096?o.error("Attempt to save cookie ["+t+"] larger than 4096 bytes ["+c+"]. This is not supported by some browsers."):c>500&&o.warn("Attempt to save cookie ["+t+"] larger than 500 bytes ["+c+"]. Consider reducing the amount of data being stored.");var p={name:t,value:g,maxAge:a};s&&(p.domain=s),l&&(p.secure=l),u._writeImpl(p)}},_writeBoth:function(t,n,r,o){e.checkArgs(arguments)(i.PlainObject,i.PlainObject,i.String.optional(),i.Boolean.optional());var g=this;g._writeOne(a,t,l,r,o),g._writeOne(s,n,void 0,r,o)},_readOne:function(t){e.checkArgs(arguments)(i.String);var n=this._readImpl(t);return n?JSON.parse(decodeURIComponent(n)):{}},getValueWithMaxAge:function(t){e.checkArgs(arguments)(i.String);var n=this,l=n._readOne(a),g=n._readOne(s),c=n._getLegacyCookieName(t),u=c?n._readImpl(c):null;if(t in l){var p=r.now()/1e3;return l[t].e<=p?(n["delete"](t),o.warn("The value stored in the local cookie has expired. [key: "+t+"]"),null):{value:l[t].v,maxAge:parseInt(l[t].e-p)}}return t in g?{value:g[t]}:(o.warn("The value was not found in the local or session cookie. Attempting to use legacy cookie. [key: "+t+"]"),{value:u})},get:function(e){var t=this,n=t.getValueWithMaxAge(e);return n&&n.value},set:function(t,n,l,g,c){e.checkArgs(arguments)(i.String,i.Or(i.String,i.PlainObject),i.Or(i.Null,i.Integer).optional(),i.String.optional(),i.Boolean.optional());var u=this,p=u._readOne(a),d=u._readOne(s),m=u._getLegacyCookieName(t);if(m&&u._deleteImpl(m),i.Integer.test(l)){if(0>=l)return u["delete"](t),void o.warn("Max age is less than zero; deleting the key from the cookie [key:"+t+", maxAge: "+l+"]");delete d[t],p[t]={v:n,e:parseInt(r.now()/1e3+l)}}else delete p[t],d[t]=n;u._writeBoth(p,d,g,c)},"delete":function(t){e.checkArgs(arguments)(i.String);var n=this,r=n._readOne(a),o=n._readOne(s),l=n._getLegacyCookieName(t);l&&n._deleteImpl(l),delete r[t],delete o[t],n._writeBoth(r,o)},enabled:function(){var e,t=g.Test,n=this;return n.set(t,"x"),e="x"===n.get(t),n["delete"](t),e},isLegacy:function(t){e.checkArgs(arguments)(i.String);var n=this,r=n._getLegacyCookieName(t);return r?null!==n._readImpl(r):!1}}),t.keys=g,t.LocalStorageName=a,t.SessionStorageName=s,e.add("utility",t,"Storage")}(TFCApp);
"use strict";!function(e){var n=e.util,a=e.utility,o=a.Storage,r=a.TempStorage,t=a.Logger.getLogger("StorageFactory"),i={cookieBased:function(e){function a(e){n.each(i,function(a,o){n.deleteCookie({name:e,domain:o})})}var r=document.location.href,i=n.parseAllSubDomains();return e.domain&&!n.containsVal(i,e.domain)&&t.error("True Fit was loaded on a domain not matching the retailer's configured cookie domain. True Fit may experience degraded or broken functionality. Configuration value:",e.domain,"Current URL:",r,"Parsed sub-domains:",i),e.secure&&!n.stringStartsWith(r,"https")&&t.error("True Fit was loaded on a non-HTTPS domain, but is configured to use a secure cookie. True Fit may experience degraded or broken functionality. Configuration value:",e.secure,"Current URL:",r),new o({readImpl:function(e){return n.getCookie(e)},writeImpl:function(o){e.readOnly||(a(o.name),n.setCookie(n.extend({domain:n.parseParentDomain()},o,e)))},deleteImpl:function(n){e.readOnly||a(n)},supportsLegacyCookies:!0})},messageBased:function(e,n){function a(e,n){return e===o.LocalStorageName?n(u):e===o.SessionStorageName?n(c):void t.error("Unknown storage key: ",e)}function i(e){a(e.name,function(n){return n.write(e)})}var u=new r({value:n.tfcL},function(n){e.messageManager.sendTfcL(n.value,n.maxAge)}),c=new r({value:n.tfcS},function(n){e.messageManager.sendTfcS(n.value)});return new o({readImpl:function(e){var n=a(e,function(e){return e.read()});return n&&n.value||null},writeImpl:i,deleteImpl:function(e){i({name:e,value:"",maxAge:0})}})}};e.add("utility",i,"StorageFactory")}(TFCApp);
"use strict";!function(n){var r,e=n.util;r=n.Class.extend({_constructor:function(){var n=this;e.each({openPrivacyPolicy:"privacy-policy",openTermsOfUse:"terms"},function(r,e){n[r]=function(r,o){var t=n.getPrivacyOrTermsUrl(r,e,o);n.openPopup(t)}})},getPrivacyOrTermsUrl:function(n,r,e){return n+"/ux/"+r+(e?"_"+e:"")+".html"},openPopup:function(n){window.open(n,"_blank")}}),n.popupManager=new r}(TFCApp);
"use strict";!function(e){var t=e.util,a=e.type,n=e.utility.Logger.getLogger("ReadyStateHelper");e.ReadyStateHelper={addCompleteListener:function(r,d,g){e.checkArgs(arguments)(a.Function,a.Integer,a.Integer);var c,i=0;t.browser.isIE||t.browser.isEdge?(n.debug('Starting IE/Edge "readystatechange" interval.'),c=setInterval(function(){r(),i++,i>=g&&(n.debug('IE/Edge "readystatechange" interval complete.'),clearInterval(c))},d)):document.addEventListener("readystatechange",function(){"complete"===document.readyState&&(n.debug('Document "readystatechange" complete event fired.'),r())})}}}(TFCApp);
"use strict";!function(t,i){var e={isIframeIntegration:i&&i.iframeIntegration===!0||!1,parentOrigin:i&&i.origin,tfcL:i&&i.tfcL,tfcS:i&&i.tfcS,isWidgetHiddenOpt:i&&i.widgetHidden?"true"===i.widgetHidden:void 0,storeExperimentKeyOpt:i&&i.storeExperimentKey};t.utility.FitrecContext=e}(TFCApp,window.tfhash);
"use strict";!function(t){var n=t.utility.FitrecContext;t.chooseIntegration=function(t,i){return n.isIframeIntegration?i:t}}(TFCApp);
"use strict";!function(e){var t=e.utility.Storage.keys.User,s=e.utility.Storage.keys.Token,i=e.utility.Logger.getLogger("FitRecCookieHelper"),r=e.CookieHelper.extend({_constructor:function(e){this._userSettings=e},userSession:function(s,r){i.trace("FitRecCookieHelper.userSession("+s+","+r+")");var o=e.storage;return void 0===s?o.get(t):(o.set(t,s,r),s)},userToken:function(t,r,o,n){i.trace("FitRecCookieHelper.userToken("+t+", "+r+")");var a=e.storage;return void 0===t?a.get(s):(a.set(s,t,r,o,n),t)},setSessionParams:function(t){i.trace("FitRecCookieHelper.setSessionParams("+t+")"),this._userSettings.set(e.UserSettings.keys.SessionParams,t)},getSessionParams:function(){return this._userSettings.get(e.UserSettings.keys.SessionParams)},setSessionParamsMaxAge:function(e){i.trace("FitRecCookieHelper.setSessionParamsMaxAge("+e+")"),this._userSettings.setMaxAge(e)},_userSettings:null});e.add("FitRecCookieHelper",r)}(TFCApp);
"use strict";!function(e){var n,o=e.util,t=e.type,a=e.Constants.Header,r=e.utility.Http,s=e.utility.Logger.getLogger("TokenHelper"),u=new e.FitRecCookieHelper;n=e.Class.extend({_constructor:function(){this.__guardingToken=!1,this.__tokenCallbacks=[]},guardedTokenCall:function(n){e.checkArgs(arguments)(t.Function);var a=this;u.userToken()?n(o.noop,o.noop):a.__guardingToken?a.__tokenCallbacks.push(n):(a._updateTokenGuard(!0),n(e.bind(a._tokenCallSuccess,a),e.bind(a._tokenCallFailure,a)))},_tokenCallSuccess:function(){var e=this,n=e.__tokenCallbacks;e._updateTokenGuard(!1),e.__tokenCallbacks=[],o.each(n,function(e,n){n(o.noop,o.noop)})},_tokenCallFailure:function(){var e=this;e._updateTokenGuard(!1);var n=e.__tokenCallbacks.shift();n&&e.guardedTokenCall(n)},_updateTokenGuard:function(n){e.checkArgs(arguments)(t.Boolean),this.__guardingToken=n},withToken:function(e,n,t,i,l){this.guardedTokenCall(function(k,c){u.userToken()?e():o.retry(function(e,o){r.get({responseType:"json",withCredentials:!0,serviceSecureUrl:n+"/profile/public/v2/"+t+"/token",success:e,failure:o})},function(n){var t=parseInt(n.getResponseHeader(a.UserTokenMaxAge)),r=n.getResponseHeader(a.UserTokenDomain),s=null===r?void 0:r,i=!!n.getResponseHeader(a.UserTokenSecure);o.isNaN(t)?u.userToken(n.data.token,void 0,s,i):u.userToken(n.data.token,t,s,i),e(),k()},function(){c(),l(),s.error("Unable to receive a new token. "+i)})})},__guardingToken:null,__tokenCallbacks:null}),e.add("tokenHelper",new n)}(TFCApp);
"use strict";!function(e){var s=e.util;e.FitRecResponse={save:function(e){this._response=e},getWidgetResults:function(e){var t=this._response,r=t&&t[e];return r&&(r=s.extend({},r,{tfpUser:t.tfpUser,recipientUser:t.recipientUser,extraClasses:t.extraClasses,userFlags:t.userFlags,locale:t.locale,sizeAvailabilityCaptureEnabled:t.sizeAvailabilityCaptureEnabled})),r},getLocale:function(){var e=this._response;return e&&e.locale},getStoreUserId:function(){var e=this._response;return e&&e.storeUserId},getRecipientProfileId:function(){var e=this._response;return e&&e.recipientUser&&e.recipientUser.profileId},getSessionContext:function(){var e=this._response;return e&&e.sessionContext},getResponse:function(){return this._response},_response:null}}(TFCApp);
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){function i(){var e=g.getQueryParams(),t=null;return g.each(e,function(e,i){g.stringStartsWith(e,"tfc-")&&(t=t||{},t[e.substr(4)]=i)}),t}function n(e,t,i){e[i]=function(){if(!t.legacyEventApiEnabled)throw"Legacy True Fit API (tfc."+i+") is not supported for this retailer";return e["__"+i].apply(e,arguments)}}function r(e){var t={};return t[v.Widget]=[],g.reduce(e,function(e,t,i){var n=i.preCall();return i.getNodes().length>0&&(e[v.Widget].push(i.widgetName),g.each(n,function(t,i){e[t]=(e[t]||[]).concat(i)})),e},t)}function a(e,t,i,n,r){var a=g.reduce(e,function(e,t,i){return i.getNodes().length>0&&e.push(i),e},[]);a.length>1?(k.error("Invalid set of widgets found on the page"),r()):0===a.length?r():a.pop().alternativeCalculate(t,i,n,r)}function s(e,t,i,n,r){var a=g.partition(i,function(e){return e===v.Style});g.loadScript({url:e+"/fitrec/"+t+"/fit?"+g.param(a["false"],!0)+"&"+g.param(a["true"],!0),error:n,success:r})}function o(e,t,i,n,r,a,s){g.loadScript({url:e+"/fitresources/"+t+"/"+(""===i?"0.0":i)+"/"+(""===n?"0.0":n)+"/"+a+(f(r)?"/"+r:"")+"/templates.js",data:s,cache:!0})}function c(e){return g.filter(e,function(e,i){return i instanceof t.widget.FitRecs})}function l(e,i,n){return function(r){var a,s=g.findVal(i,function(e,t){return t.widgetName===r});s?(a=d.Function.test(n)?n(s):n,t.checkArgsSoft(arguments,"True Fit "+e+" ("+r+")").apply(null,[d.String].concat(a))&&s[e].apply(s,g.slice(arguments,1))):k.error("Invalid widget name passed to the True Fit "+e+" API ["+r+"]")}}function u(){var t=e("#tfc-fitrec-css").get(0),i=e('<style type="text/css"></style>').get(0);g.placeOnPage(g.prependToStyleTag(i,w),t)}var d=t.type,g=t.util,f=g.isNonZeroLengthString,p=g.addParamIfNonZeroLengthString,h=g.addParamIfDefined,m=t.analytics,S=t.postMessageManager,y=t.Constants,v=y.RequestParameter,P=[v.Widget,v.Style],T=t.utility,k=T.Logger.getLogger("FitRecService"),b=["calculate","event","update","getProfileUrl","setToken","getToken"],A=t.FitRecResponse,I=T.FitrecContext,w=".tfc-cfg-widget,.tfc-cfg-core {display: none}",C=T.Storage.keys.Token;t.FitRecService=function(e,w){function R(){var e=_.shift();W=!1,void 0!==e&&tfc.__calculate.apply(tfc,e)}function U(e){return g.findVal(e,function(e,t){return f(t)})}function x(e){var t,i=c(E);return g.each(i,function(i,n){g.each(n.getCurrentFitResults(),function(i,n){t||null===t?n[e]!==t&&(t=null):t=n[e]})}),t}var E=[],F=[],M=t.cookieHelper,O=new t.UserVisitTracker(e.userVisitCookieEnabled),W=!1,_=[],N=!0,L=!1,V=g.stringToBool(e.shimQueryParams[v.AutoCalculate]||"true"),H=e.storeKey,J=e.widgetDeviceType,z=e.serviceMode,D={},q=this;e.userVisitTracker=O,e.userSettings=w,S.receiveMessage(function(e,t){if(d.PlainObject.test(t))switch(e){case y.Message.UserSession:M.userSession(t.value,t.maxAge);break;case y.Message.SessionParams:M.setSessionParams(t.sessionParams);break;case y.Message.SessionParamsMaxAge:M.setSessionParamsMaxAge(t&&t.maxAge);break;case y.Message.UserToken:M.userToken(t.value,t.maxAge)}},e.cdnProfileURI,S.globalWindowId()),g.each(t.widget,function(i,n){var r;g.isFunction(n)&&n.isSubClassOf&&n.isSubClassOf(t.widget.BaseWidget)&&!n.isAbstract&&(n.usesAlternativeCalculate?F.push(r=new n(e)):E.push(r=new n(e)),D=g.extend(D,r.expectedUpdateTypes()))}),u(),this.__getToken=function(e){t.checkArgs(arguments)(d.Function);var i=t.storage.getValueWithMaxAge(C);e(i.value,i.maxAge)},this.__setToken=function(e,i){t.checkArgs(arguments)(d.String,d.Integer),M.userToken(e,i)},this.__calculate=function(n,l){var u,f,S,y,b,A,C,U=l===!0||l&&l.initialCall,x=l&&l.isEnteringData,O=l&&l.recipientLinkId,N=i();if(!U||!L&&V){if(L=!0,W)return void _.push(arguments);if(V&&void 0!==n&&k.warn("Retailer is using the dynamic calculate API, but autoCalculate is true"),g.each(c(E),function(e,t){t.clearCurrentFitResults()}),t.checkArgsSoft(arguments,"True Fit calculate")(d.Object(D).optional())&&g.each(E,function(e,t){t.update(n)}),S=r(E),g.isEmpty(S[v.Widget]))return W=!0,void a(F,e.serviceSecureURI,H,J,R);u={},g.each(S,function(e,t){var i=g.distinctVals(t);g.containsVal(P,e)?u[e]=i:(u[e]=i[0],i.length>1&&k.error("Expected one distinct value for the ["+e+"] parameter, but got",i))}),y=u[v.Locale]||"",b=e.tfAnalytics,b||(e.tfAnalytics=b=new m.FitRecTrueFitAnalytics(e.analyticsArgs,e.responsiveManager.currentScreenSize()),e.analyticsManager.addEngine(b.getEngine())),p(u,"_",g.now().toString()),p(u,v.DeviceType,J),p(u,v.AnalyticsScreenSize,b.screenSize()),p(u,v.Token,M.userToken()),p(u,v.UserSession,M.userSession()),p(u,v.SessionParams,w.get(t.UserSettings.keys.SessionParams)),p(u,v.SessionParamOverrides,N&&g.param(N)),p(u,v.ServiceMode,z),p(u,v.IsEnteringData,x&&x.toString()),p(u,v.UserHasLegacyCookie,t.storage.isLegacy(T.Storage.keys.User).toString()),p(u,v.CookiesEnabled,t.storage.enabled().toString()),h(u,v.RecipientLinkId,O&&O.toString()),h(u,v.WidgetHidden,I.isWidgetHiddenOpt),h(u,v.StoreExperimentKey,I.storeExperimentKeyOpt),A=!!g.find(E,function(e,t){return t.isVisible&&t.getNodes().length>0}),C=e.serviceSecureURI,this.templatesHelper.update(y,A),this.templatesHelper.hasRequiredTemplates()||(f={},p(f,v.ServiceMode,z),o(C,H,e.uxVersion,e.storeVersion,y,J,f)),W=!0,t.tokenHelper.guardedTokenCall(function(e,t){function i(){t(),a(F,C,H,J,R)}b.getEngine().withTracker(function(t){s(C,H,g.extend(t.touchAndGetParams(),u),i,e)})||s(C,H,u,i,e)})}},this.__update=l("update",E.concat(F),function(e){return[d.Object(e.expectedUpdateTypes())]}),this.__event=l("event",E,[d.String,d.Function]),this.templatesHelper={templates:null,callback:null,locale:null,visibleWidgetsOnPage:!1,update:function(e,t){this.visibleWidgetsOnPage=t,e!==this.locale&&(this.locale=e,this.templates=null)},hasRequiredTemplates:function(){return this.templates||!this.visibleWidgetsOnPage},onRequiredTemplatesReady:function(e){this.callback&&k.error("Attempted to set up templates callback, but it already exists"),this.hasRequiredTemplates()?e():this.callback=e},setTemplates:function(e){this.templates=e,g.each(E,function(t,i){i.setTemplates(e)}),this.callback&&(this.callback(),this.callback=null)}},this.processTemplates=function(e){this.templatesHelper.setTemplates(e.templates)},this.process=function(i){A.save(i);var n=this;n.templatesHelper.onRequiredTemplatesReady(function(){var n=window.performance,r=N&&n&&n.now&&n.now(),s=[];g.each(E,function(t,n){n.onFitCallResponse(i);var r=n.widgetName;if(r in i){var a=A.getWidgetResults(r);n.postCall(a),e.analyticsManager.handlePageLoad({isInitialProfileComplete:i.tfpUser.isInitialProfileComplete,pageName:r,funnels:[]}),s.push(n.widgetName)}});var o=i.token,c=o&&o.id,l=o&&o.maxAge;c&&M.userToken(c,l);var u=M.userToken();if(N){if(r){var d=n.now(),f=u||c;f&&t.performanceTracker.sendWidgetRender(c,s,r,d),u||k.error("Unable to read the user token from the cookie after saving. [userToken: "+u+", responseTokenId: "+c+", responseTokenMaxAge: "+l+"]")}O.trackVisits(s),t.preLoadFitProfile(O,e,s),N=!1}if(a(F,e.serviceSecureURI,H,J,R),g.exists(E,function(e,t){return t.isVisible&&t.widgetName in i}))try{var p=e&&e.pixelDropState,h=i.tfpUser,m=h&&h.profileId,S=h&&h.hasInstantProfile;if("RetailerPageAndIframe"===p&&!S&&m){var y=e&&e.pixelSyncProviders,v=new t.manager.PixelSyncManager;v.dropPixelsUsingLocalStorage(m,y,u,e.serviceSecureURI,e.storeKey)}}catch(P){k.error("Pixel drop failed",P)}})},this.__getProfileUrl=function(i){function n(e,t){return f(t)?(r(e,t),!0):!1}function r(e,t){p+="&"+e+"="+encodeURIComponent(t)}var a,s,o,l,u,d,p=e.cdnProfileURI+e.uxVersionPath+"/resources/fitprofile/index.html#/",h=M.userSession(),m=A.getLocale(),P=A.getStoreUserId(),T=A.getSessionContext(),k=A.getRecipientProfileId();if("object"!==("undefined"==typeof i?"undefined":_typeof(i))&&(i={}),a=U([i.container,y.Container.Modal]),s=U([i.windowId,S.fitProfileWindowId()]),a!==y.Container.Modal&&s===S.fitProfileWindowId())throw"Called getProfileUrl for a window that is not the account window, and the window ID was invalid";return p+=v.StoreTla+"="+H,p+="&"+v.AllowTokenCycling+"="+!0,l=f(i.userId)?i.userId:f(P)?P:null,l&&(p+="&"+v.UserId+"="+l),n(v.Token,M.userToken()),n(v.UserSession,h),n(v.ServiceSecureURI,e.serviceSecureURI),n(v.StoreVersionPath,e.storeVersionPath),n(v.SessionContext,T),n(v.DeviceType,J),n(v.AnalyticsScreenSize,e.tfAnalytics.screenSize()),n(v.Gender,U([i.gender,x("gender")])),n(v.Category,i.category),n(v.IPS,i.ips),n(v.FirstName,i.firstName),n(v.AlternateUserId,i.alternateUserId),n(v.Placement,i.placement),n(v.ServiceMode,z),n(v.Locale,m),n(v.StoreRegistered,i.registered),n(v.OriginWidget,i.originWidget),n(v.SourceTrigger,i.sourceTrigger),n(v.Container,a),n(v.SessionParams,w.get(t.UserSettings.keys.SessionParams)),n(v.StyleColorId,i.styleColorId),n(v.AnalyticsArgs,JSON.stringify(e.analyticsArgs)),n(v.UniversalAnalyticsArgs,JSON.stringify(e.universalAnalyticsArgs)),n(v.ThirdPartyAuth,JSON.stringify(e.thirdPartyAuth)),e.thirdPartyCredEmailCollectionEnabled&&n(v.ThirdPartyCredEmailCollectionEnabled,e.thirdPartyCredEmailCollectionEnabled.toString()),n(v.EditRecipientLinkId,i.editRecipientLinkId),r(v.IsShoppingForOther,!!i.isShoppingForOther),r(v.UserSettings,JSON.stringify(w.getAllExceptSessionParams())),n(v.RecipientAlias,i.recipientAlias),n(v.RecipientProfileId,k),e.responsiveManager&&n(v.ScreenSize,e.responsiveManager.currentScreenSize()),e.customProfileJsEnabled&&n(v.CustomProfileJs,e.customProfileJsEnabled.toString()),n(v.WidgetHidden,i.widgetHidden),n(v.StoreExperimentKey,i.storeExperimentKey),e.qmEnabled&&r(v.QMEnabled,e.qmEnabled),e.tfAnalytics.getEngine().withTracker(function(e){p+="&"+g.param(e.touchAndGetParams())}),"string"==typeof i.availableSizes&&(p+="&"+v.AvailableSizes+"="+encodeURIComponent(i.availableSizes)),o=U([i.department,x("department")]),n(v.Department,o),n(v.ProductType,U([i.productType,x("productType")])),r(v.ClientToServerLogging,JSON.stringify(e.clientToServerLogging)),f(i.styleId)?u=[i.styleId]:(u=[],g.each(c(E),function(e,t){g.each(t.getCurrentFitResults(),function(e,t){u.push(t.id)})}),u=g.distinctVals(u)),u.length&&(n(v.Style,JSON.stringify(u)),1===u.length&&(g.each(c(E),function(e,t){return d?!1:void g.each(t.getCurrentFitResults(),function(e,t){return u[0]===t.id?(d=t,!1):void 0})}),d&&n(v.FitRecResult,JSON.stringify(d)))),p+="&"+S.generateWindowParams(s)},g.each(b,function(t,i){n(q,e,i)}),this._widgets=E,this._altWidgets=F}}(tfcJQuery,TFCApp);
"use strict";!function(t){t.tfcapiSetup=function(e){function i(t,e,i,n){var r=!1,a=!!t,l=function(){return u.forAll(e,function(e,i){return!!t["__"+i]})};return a&&l()&&u.containsVal(e,i)&&(t["__"+i].apply(t,n),r=!0),r}function n(){var e=[],n=s.fitrec.concat(s.tracker);u.each(r.q,function(r,a){var l=a[0],c=u.slice(a,1);u.containsVal(n,l)?i(window.tfc,s.fitrec,l,c)||i(t.trackerService,s.tracker,l,c)||e.push(a):o.error("Retailer attempted to call non-existent True Fit API function: "+l)}),r.q=e,l=null}var r,a=window.tfcapi,l=null,o=t.utility.Logger.getLogger("tfcapi"),c=t.type,u=t.util,s={fitrec:["calculate","event","update","getProfileUrl","getToken","setToken"],tracker:["track"]};e&&"tfcapi"in window&&o.warn("Retailer initialized the tfcapi object, but the legacy integration is still enabled for this retailer. True Fit should disable the legacy integration if the retailer is no longer using it."),c.Function.test(a)&&c.Array.optional().test(a.q)&&a&&!a.loaded?(window.tfcapi=r=function(){arguments&&"internalProcess"===arguments[0]?(null!=l&&(clearTimeout(l),l=null),n()):(tfcapi.q.push(arguments),null===l&&(l=setTimeout(n,1)))},r.loaded=!0,r.q=a.q||[],n()):a&&a.loaded?window.tfcapi("internalProcess"):e||o.error("Retailer loaded True Fit without properly initializing the tfcapi object. This usually means that True Fit disabled the legacy integration for this retailer, but the retailer is still using it.")}}(TFCApp);
"use strict";!function(t,e){var n=e.util,i=e.type,r=e.Constants,a=e.FitRecResponse,s=r.Attributes,o=r.RequestParameter,d=e.utility.Logger.getLogger("True Fit Widget"),l={};l[s.STORE_REGISTERED]=o.StoreRegistered,l[s.USER_ID]=o.UserId,l[s.USERID]=o.UserId,l[s.ALT_USER_ID]=o.AlternateUserId,l[s.LOCALE]=o.Locale,l[s.WIDGET_HIDDEN]=o.WidgetHidden,l[s.STORE_EXPERIMENT_KEY]=o.StoreExperimentKey,l[s.STYLE_ID]=o.Style,l[s.CONTEXT]=o.WidgetContext,l[s.ORDER_ID]=o.OrderId;var c={registered:s.STORE_REGISTERED,userId:s.USERID,locale:s.LOCALE,storeExperimentKey:s.STORE_EXPERIMENT_KEY,widgetHidden:s.WIDGET_HIDDEN,colorId:s.STYLE_COLOR_ID,availableSizes:s.AVAILABLE_SIZES,orderId:s.ORDER_ID},u=e.Class.extend({context:null,eventHash:null,templates:null,widgetName:null,isVisible:!0,event:function(n){var i=this,r=!1;i.getNodes().each(function(){var e=t(this);"true"===e.attr(s.WIDGET_HIDDEN)&&(r=!0)}),"string"!=typeof n||r?r?d.debug("Attempted to use the widget event API when widgetHidden=true["+JSON.stringify(n)+"] for widget["+this.widgetName+"]"):d.error("Attempted to use the widget event API with an invalid event["+JSON.stringify(n)+"] for widget["+this.widgetName+"]"):e.chooseIntegration(this._eventHandler,this._iframeEventHandler).apply(this,arguments)},_eventHandler:function(t,i){var r;if("string"==typeof t)if(n.isFunction(i))t in this.eventHash||(this.eventHash[t]=new e.Signal),this.eventHash[t].listen(i);else if(r=this.eventHash[t]){var a=n.slice(arguments,1);try{r.trigger.apply(r,a)}catch(s){d.error("Exception was thrown by retailer code when processing the ("+this.widgetName+","+t+') event. The underlying exception was: "'+(s&&s.message?s.message:"")+'"\n'+(s&&s.stack?s.stack:""))}}},_iframeEventHandler:function(t,e,i){n.isFunction(e)||this.context.integrationManager.event(this.widgetName,t,e,i)},preCall:function(){var e=this,i={};return e.getNodes().each(function(){var r=t(this);n.each(e._preCallAttrs(),function(t,n){n in l?e._addParam(r,n,l[n],i):d.error("Attempted to add attribute ["+n+"] to the preCall, but failed to look up the corresponding request parameter",l)})}),i},postCall:function(){},onFitCallResponse:function(){},setTemplates:function(t){this.templates=t[this.widgetName]||{}},_constructor:function(t){this.context=t,this.eventHash={}},_supportedAttrs:function(){return[s.STORE_REGISTERED,s.USER_ID,s.USERID,s.ALT_USER_ID,s.LOCALE,s.WIDGET_HIDDEN,s.STORE_EXPERIMENT_KEY]},_preCallAttrs:function(){return this._supportedAttrs()},expectedUpdateTypes:function(){return{locale:i.String.optional(),userId:i.String.optional(),registered:i.Boolean.optional(),storeExperimentKey:i.String.optional(),widgetHidden:i.Boolean.optional()}},update:function(t){var e,i=this;t&&(e=i.getNodes(),n.each(t,function(t,n){i._updateAttr(e,t,n)}))},_updateAttr:function(t,e,i){var r=c[e];r&&n.containsVal(this._supportedAttrs(),r)&&(null===i?t.removeAttr(r):void 0!==i&&t.attr(r,i))},_addParam:function(n,i,r,a){e.checkArgs(arguments)(e.type.Instance(t),e.type.String,e.type.String,e.type.Instance(Object));var s=n.attr(i);s&&(a[r]=(a[r]||[]).concat(s))},getNodes:function(){return t("."+this.widgetName)},_getLocaleCode:function(){return a.getLocale()},alternativeCalculate:function(t,e,n,i){i()}});e.widget=function(t,n){if(e.checkArgs(arguments)(e.type.Object({isAbstract:e.type.Boolean.optional(),usesAlternativeCalculate:e.type.Boolean.optional(),widgetName:e.type.String}),e.type.Function.optional()),!t.widgetName)throw"Widget name required and cannot be an empty string";var i,r=n||u;return e.widget[t.className]=i=r.extend(t),i.isAbstract=!!t.isAbstract,i.WIDGET_NAME=t.widgetName,i.usesAlternativeCalculate=!!t.usesAlternativeCalculate,i},u.isAbstract=!0,e.widget.BaseWidget=u}(tfcJQuery,TFCApp);
"use strict";!function(e){function n(n,t){function r(e,n){return{set:n,touch:function(){var t=e();return null!==t&&n(t),t}}}var i,s,u=null,a=null;return n?(s=e.utility.Storage.keys.Analytics,i=e.storage,r(e.bind(i.get,i,s),function(e){i.set(s,e,t)})):r(function(){return u},function(e){null!==a&&clearTimeout(a),u=e,a=setTimeout(function(){u=a=null},t)})}var t=e.type,r=e.util,i=e.utility,s=i.Logger.getLogger("TrueFitAnalyticsTracker"),u=e.Constants,a=u.RequestParameter,o={sessionTimeout:t.Integer,usingToken:t.Boolean},l={cookieEnabled:t.Boolean,analyticsSession:t.String.optional(),trackPageViewImpl:t.Function},c=r.extend({},o,l),g=e.Class.extend({_constructor:function(r){e.checkArgs(arguments)(t.Object(c));var i,s,u=this,a=r.sessionTimeout,o=r.cookieEnabled,l=r.analyticsSession;u._reqQueue=[],u._usingToken=i=r.usingToken,u._trackPageViewImpl=r.trackPageViewImpl,i||(u._sessionHandler=s=n(o,a),void 0!==l&&s.set(l))},trackPageView:function(n){function i(e){try{e()}catch(n){s.error("Exception thrown in callback function will be ignored",n)}a._reqInFlight=!1,a._reqQueue.length>0&&a._reqQueue.shift()()}function u(){0===n.funnels.length?i(n.onSuccess):(a._reqInFlight=!0,a._trackPageViewImpl({params:o,data:{pageName:n.pageName,funnels:n.funnels},success:e.bind(i,null,n.onSuccess),error:e.bind(i,null,n.onError)}))}e.checkArgs(arguments)(t.Object({pageName:t.String,funnels:t.Array,onSuccess:t.Function,onError:t.Function,extraParams:t.PlainObject}));var a=this,o=r.extend(a.touchAndGetParams(),n.extraParams);a._reqInFlight?a._reqQueue.push(u):u()},touchAndGetParams:function(){var e,n,t=this,i={};return t._usingToken||(e=t._sessionHandler,n=e.touch(),null===n&&e.set(n=r.uuid()),i[a.AnalyticsSession]=n),i},_usingToken:null,_trackPageViewImpl:null,_sessionHandler:null,_reqInFlight:!1,_reqQueue:null});g.TrackerArgTypes=o,g.OtherTrackerArgTypes=l,g.AllTrackerArgTypes=c,e.analytics.TrueFitAnalyticsTracker=g}(TFCApp);
"use strict";!function(i){function n(i,n,t){var e=null,o=n in i?i[n]:"_"in i?i._:void 0;return"function"===s.type(o)?e=o(t||{}):null!==o&&void 0!==o&&(e=o),e}function t(i,n){n===u.Failure&&a.warn("Analytics script failed to load ["+i+"]");var t=r[i];t.status=n,t.signal.trigger(n),delete t.signal}var e=i.analytics,s=i.util,o=i.type,a=i.utility.Logger.getLogger("AnalyticsEngine"),l=i.Class,c=l.unimplemented,r={},u={Loading:1,Success:2,Failure:3},_=l.extend({_constructor:function(n,t){var e;i.checkArgs(arguments)(o.Object({config:o.Object(t).optional(),enabled:o.Boolean.optional(),pages:o.PlainObject.optional(),events:o.PlainObject.optional(),timings:o.PlainObject.optional()})),this._config=n.config||{},this._enableRecordings=o.Boolean.test(n.enabled)?n.enabled:i.getRunMode()===i.RunModes.prod,this._pages=this._filterIfUnimplemented(this._sendPageViewImpl,n,"pages"),this._events=this._filterIfUnimplemented(this._sendEventImpl,n,"events"),this._timings=this._filterIfUnimplemented(this._sendTimingImpl,n,"timings"),this._queue=[],this._scriptStatus=u.Loading,this._onLoad=new i.Signal,e=null,this._enableRecordings&&(e=s.chooseUri(this._getSecureScriptUrl(),this._getScriptUrl())),this._loadScript(e)},_filterIfUnimplemented:function(i,n,t){var e=n[t];return i===c&&o.PlainObject.test(e)?(a.error("Passed "+t+" to an analytics engine that does not support that type of tracking call."),{}):e||{}},_onScriptLoadVerification:function(i,n){this._loadVerification()||(n=u.Failure),t(i,n)},_loadScript:function(n){var t,e,s=this;return null===n?void setTimeout(i.bind(s._onScriptLoad,s,u.Success),1):void(n in r?(t=r[n],t.status!==u.Loading?setTimeout(i.bind(s._onScriptLoad,s,t.status),1):r[n].signal.listen(i.bind(s._onScriptLoad,s))):(t=r[n]={status:u.Loading,signal:new i.Signal},t.signal.listen(i.bind(s._onScriptLoad,s)),e={url:n,success:i.bind(s._onScriptLoadVerification,s,n,u.Success),error:i.bind(s._onScriptLoadVerification,s,n,u.Failure)},setTimeout(function(){s._customLoader(e)||i.util.loadScript(e)},1)))},_customLoader:function(){return!1},_loadVerification:function(){return!0},_onScriptLoad:function(i){this._scriptStatus=i,this._initEngine(),this._processQueue(),this._onLoad.trigger(),this._onLoad=null},_processQueue:function(){this._scriptStatus===u.Success&&s.each(this._queue,function(i,n){n()}),this._queue=null},_initEngineImpl:c,_initEngine:function(){this._scriptStatus===u.Success&&this._enableRecordings&&this._initEngineImpl()},_getEngineName:c,_getScriptUrl:c,_getSecureScriptUrl:c,_sendPageViewImpl:c,_sendEventImpl:c,_sendTimingImpl:c,_logRecording:function(i,n){var t;t=this._enableRecordings?"enabled":"disabled",a.debug(this._getEngineName()+"["+t+","+JSON.stringify(this._config)+"] -> "+i+"("+JSON.stringify(n)+")")},_sendPageView:function(i,n){this._logRecording("PageView",i),this._enableRecordings?this._sendPageViewImpl(i):this.supportsHitCallback&&n()},_sendEvent:function(i){this._logRecording("Event",i),this._enableRecordings&&this._sendEventImpl(i)},_sendTiming:function(i){this._logRecording("Timing",i),this._enableRecordings&&this._sendTimingImpl(i)},_processWhenReady:function(i){this._scriptStatus===u.Success?i():this._scriptStatus===u.Loading&&this._queue.push(i)},pageView:function(t,e){var s=this,o=n(this._pages,t,e);null!==o?this._processWhenReady(i.bind(s._sendPageView,s,o,e.success)):s.supportsHitCallback&&e.success()},event:function(t,e){var s=n(this._events,t,e);null!==s&&this._processWhenReady(i.bind(this._sendEvent,this,s))},timing:function(t,e){var s=n(this._timings,t,e);null!==s&&this._processWhenReady(i.bind(this._sendTiming,this,s))},onLoad:function(i){this._scriptStatus===u.Loading?this._onLoad.listen(i):i()},isEnabled:function(){return this._enableRecordings},_config:null,_pages:null,_events:null,_timings:null,_queue:null,_onLoad:null,_scriptStatus:null,_enableRecordings:null,supportsHitCallback:!1});e.AnalyticsEngine=_}(TFCApp);
"use strict";!function(n){var e=n.analytics,i=n.util,t=1e4,a=n.utility.Logger.getLogger("AnalyticsManager"),s=n.Class.extend({_constructor:function(){this._engines=[]},addEngine:function(n){n instanceof e.AnalyticsEngine?i.containsVal(this._engines,n)?a.raise("Cannot add the same engine twice"):this._engines.push(n):a.raise("Analytics engine must have type AnalyticsEngine")},handlePageLoad:function(n){function e(n){u||(clearTimeout(a),u=!0,n&&n())}var a,s=this._engines,c=i.count(s,function(n,e){return e.supportsHitCallback}),o=0,u=!1,g=n.success,r=n.error;n.success=function(){++o===c&&e(g)},n.error=function(){e(r)},a=setTimeout(function(){e(r)},t),i.each(s,function(e,i){i.pageView(n.pageName,n)})},handleEvent:function(n){var e=n.eventName;i.each(this._engines,function(i,t){t.event(e,n)})},handleTiming:function(n){var e=n.timingName;i.each(this._engines,function(i,t){t.timing(e,n)})},_engines:null});e.AnalyticsManager=s}(TFCApp);
"use strict";!function(t){var i="optimizely",n=t.analytics,e=t.extLibs,r=t.type;window[i]=window[i]||[];var s={id:r.String,scriptUrl:r.String.optional(),targets:r.Array},c=n.AnalyticsEngine.extend({isActive:function(){return this._active},_constructor:function(t){this._super(t,s),this._id=this._config.id,this._targets=this._config.targets},_initEngineImpl:function(){t.isDevMode()&&window[i].push(["log"])},_getEngineName:function(){return"A/B Testing"},_getScriptUrl:function(){var t=this._config.scriptUrl;return t?"http://"+t:null},_getSecureScriptUrl:function(){var t=this._config.scriptUrl;return t?"https://"+t:null},_sendPageViewImpl:function(t){var i=this;e(this._targets).each(function(n,e){e===t&&i._activate()})},_activate:function(){this._active=!0,window[i].push(["activate",this._id]),this._active=!1},_active:null,_id:null,_targets:null});n.ABTestingEngine=c}(TFCApp);
"use strict";!function(n){var r=n.analytics,t=r.TrueFitAnalyticsTracker,e=t.AllTrackerArgTypes,i=r.AnalyticsEngine.extend({_constructor:function(n){this._super(n,e)},_initEngineImpl:function(){var n,r=this._onTrackerReady;this._tracker=n=new t(this._config),r&&(r.trigger(n),this._onTrackerReady=null)},_getEngineName:function(){return"True Fit Analytics"},_getScriptUrl:function(){return null},_getSecureScriptUrl:function(){return null},_sendPageViewImpl:function(n){this._tracker.trackPageView(n)},withTracker:function(r){var t,e=this._tracker,i=this.isEnabled();return i&&(e?r(e):(this._onTrackerReady=t=this._onTrackerReady||new n.Signal,t.listen(r))),i},_tracker:null,_onTrackerReady:null,supportsHitCallback:!0});r.TrueFitAnalyticsEngine=i}(TFCApp);
"use strict";!function(e){var t,n=e.type,i=e.util,s=e.Class,a=e.analytics,l={totalABTests:n.Integer};t=a.AnalyticsEngine.extend({_constructor:function(e){this._super(e,l),this._pageViewQueue=[],this._loadedABTests=0,this._totalABTests=this._config.totalABTests},_initEngineImpl:function(){},_getEngineName:function(){return"ABTestCompleteEngine"},_getScriptUrl:function(){return null},_getSecureScriptUrl:function(){return null},_sendPageViewImpl:function(t){this._loadedABTests===this._totalABTests?e.abTestComplete.trigger(t):this._pageViewQueue.push(t)},incrementLoadedABTests:function(){++this._loadedABTests===this._totalABTests&&(i.each(this._pageViewQueue,function(t,n){e.abTestComplete.trigger(n)}),this._pageViewQueue=null)},_loadedABTests:null,_totalABTests:null,_pageViewQueue:null}),e.analytics.ABTestInterface=s.extend({getEngines:function(){return this._engines.concat([this._abTestCompleteEngine])},isActive:function(){var e=!1;return i.each(this._engines,function(t,n){return n.isActive()?(e=!0,!1):void 0}),e},_getPageNames:s.unimplemented,_constructor:function(n){var s,l={},u=[];i.each(this._getPageNames(),function(e,t){l[t]=t}),i.each(n,function(e,t){var n=new a.ABTestingEngine({enabled:!0,config:{id:t.id,scriptUrl:t.scriptUrl,targets:t.targets},pages:l});u.push(n)}),this._engines=u,this._abTestCompleteEngine=s=new t({enabled:!0,pages:l,config:{totalABTests:u.length}}),i.each(u,function(t,n){n.onLoad(e.bind(s.incrementLoadedABTests,s))})},_engines:null,_abTestCompleteEngine:null}),e.abTestComplete=new e.Signal}(TFCApp);
"use strict";!function(e){var n=e.analytics,t=e.type,r=e.util,a=(e.utility.Logger.getLogger("TrueFitAnalytics"),n.TrueFitAnalyticsTracker),i=n.TrueFitAnalyticsEngine,c=(e.Constants.RequestParameter,e.Class.extend({_constructor:function(n,i,c,s){e.checkArgs(arguments)(t.Object({enabled:t.Boolean,trackerArgs:t.Object(a.TrackerArgTypes),otherTrackerArgs:t.Object(a.OtherTrackerArgTypes)}),t.PlainObject.optional(),t.PlainObject.optional(),t.PlainObject.optional()),this._tfEngine=this._createEngine(n.enabled,r.extend({},n.trackerArgs,n.otherTrackerArgs),i,c,s)},_generatePageView:function(n,r){e.checkArgs(arguments)(t.Function,t.Object({pageName:t.String,funnels:t.Array}));var a={},i=n(r);return i?{pageName:i,funnels:r.funnels,extraParams:a,onSuccess:r.success,onError:r.error}:null},getEngine:function(){return this._tfEngine},_createEngine:function(e,n,t,r,a){return new i({enabled:e,config:n,pages:t,events:r,timings:a})},_tfEngine:null}));n.TrueFitAnalytics=c}(TFCApp);
"use strict";!function(e){e.manager.IntegrationManagerInterface=e.Class.extend({_constructor:function(){},init:e.unimplemented,event:e.unimplemented,messageManager:e.unimplemented,changeLayout:e.unimplemented,documentComplete:e.unimplemented,widgetComplete:e.unimplemented,listenForOpenReg:e.unimplemented,unlistenForOpenReg:e.unimplemented,sendTfcIframeRefresh:e.unimplemented,sendTfcIframeUserUpdate:e.unimplemented,setTfcIframeUpdateCallback:e.unimplemented})}(TFCApp);
"use strict";!function(e,n,i){var t=e.util,r=(e.extLibs,e.utility.Logger.getLogger("ResponsiveManager")),s=e.Constants,c=s.ScreenSize,a=s.DeviceType,S=767,d=e.Class.extend({_constructor:function(i){var s,d=this;if(d._screenSizeQuerySignal=new e.Signal,i!==a.Responsive)d._setScreenSize(i===a.Desktop?c.Large:c.Small);else if(t.isFunction(n.matchMedia))try{s=n.matchMedia("(max-width: "+S+"px)"),d._setScreenSize(s.matches?c.Small:c.Large),s.addListener(function(e){var n=e.matches?c.Small:c.Large;d._setScreenSize(n)})}catch(u){r.warn("Error trying to use matchMedia: ",u," Using the window width instead"),d._useWindowWidth()}else d._useWindowWidth()},_setScreenSize:function(e){var n=this;n._currentScreenSize!==e&&(r.debug("Setting screen size:",e),n._currentScreenSize=e,n._screenSizeQuerySignal.trigger(e))},_useWindowWidth:function(){var i=this;i._setCurrentWidthBasedOnWindow(),n.addEventListener("resize",e.bind(t.debounce(i._setCurrentWidthBasedOnWindow,250),i))},_setCurrentWidthBasedOnWindow:function(){var e=this,t=n.innerWidth||i.documentElement.clientWidth||i.body.clientWidth;e._setScreenSize(S>=t?c.Small:c.Large)},currentScreenSize:function(){return this._currentScreenSize},subscribeToScreenSizeChange:function(e){this._screenSizeQuerySignal.listen(e)},_currentScreenSize:null,_screenSizeQuerySignal:null});e.manager.ResponsiveManager=d}(TFCApp,window,document);
"use strict";!function(e){var t=e.utility.Logger.getLogger("PixelSyncManager"),n=e.utility.Http;e.manager.PixelSyncManager=e.Class.extend({_constructor:function(){},dropAllPixels:function(e,t,n,i,a){var o=this;t.forEach(function(t){o._dropPixel(t,e,n,i,a)})},dropPixelsUsingLocalStorage:function(n,i,a,o,r){var s=this,c=new e.utility.LocalStorage,d="pixelDrop",l="lastDrop";c.isEnabled()?i.some(function(e){var t=c.get(d);if(t||(t={}),t[e]||(t[e]={}),!t[e][l])return s._dropPixel(e,n,a,o,r),t[e][l]=(new Date).getTime(),c.set(d,t),!0;var i=new Date,p=new Date(t[e][l]),m=i.getTime()-p,u=m/864e5;return u>7?(s._dropPixel(e,n,a,o,r),t[e][l]=(new Date).getTime(),c.set(d,t),!0):void 0}):t.info("Unable to drop pixel because localStorage is blocked.")},_dropPixel:function(n,i,a,o,r){if(i){var s=e.getRunMode()===e.RunModes.prod?i:"nonprod-"+i;if("LiveRamp"===n){var c=document.createElement("img");c.src="https://idsync.rlcdn.com/710477.gif?partner_uid="+s,c.style.position="absolute",c.style.visibility="hidden",document.getElementsByTagName("body")[0].appendChild(c)}else if("TowerData"===n){var d=document.createElement("script");d.type="text/javascript",d.defer=!0,d.async=!0,d.src="//js.alocdn.com/c/l2obzrje.js",d.setAttribute("data-id","alocdn-ldr"),d.setAttribute("data-label",s),document.getElementsByTagName("body")[0].appendChild(d)}else if("Facebook"===n){var l=document.createElement("script");l.text="!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');fbq('init', '509778499926979', {uid: '"+s+"'});fbq('track', 'PageView');",document.getElementsByTagName("body")[0].appendChild(l);var p=document.createElement("img");p.src="https://www.facebook.com/tr?id=509778499926979&ev=PageView&noscript=1",p.style.position="absolute",p.style.visibility="hidden",document.getElementsByTagName("body")[0].appendChild(p)}else if("Google"===n){var m=document.createElement("script");m.async=!0,m.src="https://www.googletagmanager.com/gtag/js?id=AW-696707880",document.getElementsByTagName("body")[0].appendChild(m);var u=document.createElement("script");u.text="window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'AW-696707880');",document.getElementsByTagName("body")[0].appendChild(u)}else if("Pinterest"===n){var g=document.createElement("script");g.text="!function(e){if(!window.pintrk){window.pintrk = function () {window.pintrk.queue.push(Array.prototype.slice.call(arguments))};var n=window.pintrk;n.queue=[],n.version='3.0';var t=document.createElement('script');t.async=!0,t.src=e;var r=document.getElementsByTagName('script')[0]; r.parentNode.insertBefore(t,r)}}('https://s.pinimg.com/ct/core.js');pintrk('load', '2614237153404');pintrk('page');",document.getElementsByTagName("body")[0].appendChild(g);var y=document.createElement("img");y.src="https://ct.pinterest.com/v3/?event=init&tid=2614237153404&noscript=1",y.style.position="absolute",y.style.visibility="hidden",document.getElementsByTagName("body")[0].appendChild(y)}else t.error("Unknown pixel provider "+n);this._logPixelSyncEvent(n,a,o,r)}else t.error("Unable to drop pixel because shopper profile id is not defined.")},_logPixelSyncEvent:function(e,t,i,a){var o={serviceSecureUrl:i+"/profile/public/v2/"+a+"/analytics/pixel-sync",data:{provider:e},userToken:t,withCredentials:!0};n.post(o)}})}(TFCApp);
"use strict";!function(e){function t(e,t){return!!(t.compareDocumentPosition(e)&(Node.DOCUMENT_POSITION_FOLLOWING|Node.DOCUMENT_POSITION_CONTAINED_BY))}function n(e,t){var n=o.findKey(t,function(t,n){return e===n});return void 0===n?-1:n}var i=e.KeyCodes,o=e.util,r=e.utility.Logger.getLogger("tfcTabGroupController");e.TabHelper=e.Class.extend({_constructor:function(){this._els=[]},add:function(e){var n=this._els,i=o.findKey(n,function(n,i){return t(i,e)});void 0===i&&(i=n.length),n.splice(i,0,e),r.trace("Added tabbable element ",e,n)},remove:function(e){var t=this._els,i=n(e,t);-1!==i?t.splice(i,1):r.warn("Attempted to remove ",e," but it was not found in the array"),r.trace("Removed tabbable element ",e,t)},handleKeydown:function(e,t){var s,a,u,l=this._els;t.keyCode===i.Tab&&(s=o.filter(l,function(e,t){return o.isVisible(t)&&!t.disabled}),a=n(e,s),-1===a?r.warn("Received tab event for ",e," but it was not found in the array"):a!==s.length-1||t.shiftKey?0===a&&t.shiftKey&&(u=s[s.length-1],r.debug("Shift-tab was pressed on first element. Focusing last element",u)):(u=l[0],r.debug("Tab was pressed on last element. Focusing first element",u)),u&&(u.focus(),t.preventDefault()))}})}(TFCApp);
"use strict";!function(t,e){var s=e.analytics,i=e.util;s.WidgetABTest=s.ABTestInterface.extend({_getPageNames:function(){var t,s=[];return i.each(e.widget,function(n,a){i.isFunction(a)&&a.isSubClassOf&&a.isSubClassOf(e.widget.BaseWidget)&&(t=a.WIDGET_NAME,s.push(t))}),s}})}(tfcJQuery,TFCApp);
"use strict";!function(e){var t,i=e.util,n=e.utility.Storage.keys.Analytics,s=e.analytics,r=s.TrueFitAnalytics;t=r.extend({_constructor:function(t,s){this._super(i.extend({otherTrackerArgs:{analyticsSession:e.storage.get(n)||void 0,cookieEnabled:!0,trackPageViewImpl:i.noop}},t),{}),this._screenSize=s},screenSize:function(){return this._screenSize}}),s.FitRecTrueFitAnalytics=t}(TFCApp);
"use strict";!function(e){function t(e){return r.stringStartsWith(e,"{")}var n=e.utility.Logger.getLogger("IframeIntegrationManager"),a=e.Constants.LayoutType,i=e.type,r=e.util,s=e.manager;e.manager.IframeIntegrationManager=e.manager.IntegrationManagerInterface.extend({_constructor:function(e,t,n){this._iframeMessageManager=new s.IframeMessageManager(e,t,n),this._currentInlineWidth=document.body.scrollWidth},init:function(){var e=this,n=window.tfhash||{},a={locale:"data-locale",storeRegistered:"data-registered",style:"id",styleColor:"data-colorid",userId:"data-userid",widget:"class",category:"data-store-category",department:"data-department",ageGroup:"data-age-group",gender:"data-gender"},i={catalog:"tfc-fitrec-catalog",product:"tfc-fitrec-product",register:"tfc-fitrec-register"},r=document.getElementById("tfc-widget-container"),s=document.createElement("div");r&&(Object.keys(n).forEach(function(r){var g="widget"===r?i[n[r]]:n[r],o="category"!==r||t(g)?a[r]:"data-category";o&&s.setAttribute(o,g),"widget"===r&&(e._widgetName=g)}),r.appendChild(s))},event:function(e,t,n,a){this._iframeMessageManager.sendEvent(this._widgetName,e,t,n,a)},messageManager:function(){return this._iframeMessageManager},changeLayout:function(t){e.checkArgs(arguments)(i.String);var n=this,s=void 0,g=void 0;r.containsVal(a,t,!0)&&(n._currentLayoutType=t,t===a.Modal?(s="100%",g="100%"):(s=this._currentInlineHeight,g=this._currentInlineWidth),this._iframeMessageManager.sendChangeLayout(t,n._widgetName,s,g))},documentComplete:function(){n.debug("Document complete"),this._isDocumentComplete=!0,this._resize(document.body.scrollHeight)},widgetComplete:function(e){n.debug("Widget complete",e),this._isWidgetComplete=!0,this._resize(e)},_resize:function(e){var t=this;n.debug("Attempting resize.",t._currentLayoutType,e,this._currentInlineWidth,t._isWidgetComplete,t._isDocumentComplete),t._isWidgetComplete&&(this._currentInlineHeight=e,t._currentLayoutType===a.Inline&&t._iframeMessageManager.sendChangeLayout(a.Inline,t._widgetName,e,this._currentInlineWidth))},listenForOpenReg:function(e){this._iframeMessageManager.listenForOpenReg(e)},unlistenForOpenReg:function(e){this._iframeMessageManager.unlistenForOpenReg(e)},sendTfcIframeRefresh:function(e){this._iframeMessageManager.sendTfcIframeRefresh(e)},sendTfcIframeUserUpdate:function(){this._iframeMessageManager.sendTfcIframeUserUpdate()},setTfcIframeUpdateCallback:function(e){this._iframeMessageManager.setTfcIframeUpdateCallback(e)},_currentLayoutType:a.Inline,_currentInlineWidth:null,_currentInlineHeight:null,_isDocumentComplete:!1,_isWidgetComplete:!1,_iframeMessageManager:null,_widgetName:null})}(TFCApp);
"use strict";!function(n){n.utility.Logger.getLogger("True Fit Widget");n.manager.StandardIntegrationManager=n.manager.IntegrationManagerInterface.extend({_constructor:function(){},init:function(){},event:function(){},messageManager:function(){},changeLayout:function(){},documentComplete:function(){},widgetComplete:function(){},listenForOpenReg:function(){},unlistenForOpenReg:function(){},sendTfcIframeRefresh:function(){},sendTfcIframeUserUpdate:function(){},setTfcIframeUpdateCallback:function(){}})}(TFCApp);
"use strict";!function(e){function t(e,a){if(i.Array.test(e))return s.flatMap(e,function(e,n){return t(n,a)});if(i.PlainObject.test(e)){var n={};return Object.keys(e).forEach(function(i){var s=i.replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()}),r=e[i];n[s]=!a||a(i)?t(r,a):r}),n}return e}function a(e){if(s.isArrayLike(e)){for(var t=[],a=0;a<e.length;a++)t.push(e[a]);return t}n.raise("You must provide an array-like object to toArray")}var n=e.utility.Logger.getLogger("IframeMessageManager"),i=e.type,s=e.util,r=e.Constants.LayoutType,o=e.utility.PostMessage,c={ChangeLayout:"tfc-change-layout",Event:"tfc-event",TfcL:"tfc-save-tfc-l",TfcS:"tfc-save-tfc-s"};e.manager.IframeMessageManager=e.Class.extend({_constructor:function(t,a,r){e.checkArgs(arguments)(i.Any,i.Object({primaryStoreMessageOrigin:i.String.optional(),storeMessageOriginWhitelist:i.Array}),i.String.optional());var o=a.primaryStoreMessageOrigin,c=a.storeMessageOriginWhitelist,f=r||o;f?(n.info("resolvedStoreMessageOrigin:",f,"storeMessageOriginWhitelist:",c),s.containsVal(c,f)?n.info("Origin was resolved successfully and is in the white list, so allowing it."):e.isProdMode()?n.raise("Origin was passed on the hash and is not in the white list. Failing hard since this is a prod environment."):(n.error("Origin was passed on the hash and is not in the white list. Defaulting to * since this is a non-prod environment. Note, this will throw an exception in prod!"),f="*")):e.isProdMode()?n.raise("No origin provided on hash and no primary origin configured. Failing hard since this is a prod environment."):(n.error("No origin provided on hash and no primary origin configured. Defaulting to * since this is a non-prod environment. Note, this will throw an exception in prod!"),f="*"),this._window=t,this._origin=f,this._listenForMessagesFromParent(),this._discoverTfcIframes()},_getMessageObject:function(a,r,o){e.checkArgs(arguments)(i.String,i.PlainObject.optional());var c=t({tfcMessageId:s.uuid(),tfcMessage:a,tfcData:r},o);return n.debug("Sending iFrame message ["+a+", "+JSON.stringify(c)+"]"),c},_postMessage:function(e){e&&(this._window?o.post(this._window,this._origin,e):n.error("Target window is undefined while trying to post a valid message object."))},sendChangeLayout:function(t,a,o,f){e.checkArgs(arguments)(i.String,i.Or(i.String,i.Null),i.Or(i.String,i.Integer),i.Or(i.String,i.Integer)),s.containsVal(r,t,!0)?this._postMessage(this._getMessageObject(c.ChangeLayout,{type:t,widget:a,height:o,width:f})):n.error("Invalid layout type["+t+"]")},sendTfcL:function(t,a){e.checkArgs(arguments)(i.String,i.Integer),this._postMessage(this._getMessageObject(c.TfcL,{value:t,maxAge:a}))},sendTfcS:function(t){e.checkArgs(arguments)(i.String),this._postMessage(this._getMessageObject(c.TfcS,{value:t}))},sendEvent:function(t,a,n,s,r){e.checkArgs(arguments)(i.String,i.String,i.String,i.Or(i.PlainObject,i.String).optional(),i.Function.optional()),this._postMessage(this._getMessageObject(c.Event,{widget:t,eventSource:a,eventName:n,eventData:s},r))},_listenForMessagesFromParent:function(){var t=this;t._receiveOpenMessageSignal=new e.Signal,o.receive(window,e.bind(t._receiveMessageFromParentCallback,t),t._origin)},_receiveMessageFromParentCallback:function(e){var t=this;e.data&&"tfc-open-registration"===e.data.tfc_message&&t._receiveOpenMessageSignal.trigger()},listenForOpenReg:function(e){this._receiveOpenMessageSignal.listen(e)},unlistenForOpenReg:function(){this._receiveOpenMessageSignal.unlistenAll()},_receiveOpenMessageSignal:void 0,_discoverTfcIframes:function(){var t=this;t._tfcIframes=[],o.receive(window,e.bind(t._tfcIframeMessageCallback,t),s.parseOrigin(document.URL)),t._sendTfcIframeDeclaration()},_tfcIframeMessageCallback:function(e){var t=this,a=e.data.tfcMessage;if("tfcIframeDeclaration"===a||"tfcIframeResponse"===a)s.containsVal(t._tfcIframes,e.source)||t._tfcIframes.push(e.source),"tfcIframeDeclaration"===a&&o.post(e.source,s.parseOrigin(document.URL),{tfcMessage:"tfcIframeResponse"});else if("tfcIframeRefresh"===a){var n=e.data.tfcData&&e.data.tfcData.isEnteringData;tfc.__calculate(void 0,{isEnteringData:n})}else"tfcIframeUpdate"===a&&t._tfcIframeUpdateCallback&&t._tfcIframeUpdateCallback()},_sendTfcIframeDeclaration:function(){var e=a(window.parent.frames);s.each(e,function(t,a){a!==window&&o.post(e[t],"*",{tfcMessage:"tfcIframeDeclaration"})})},sendTfcIframeRefresh:function(e){this._sendTfcIframeMessage("tfcIframeRefresh",{isEnteringData:e})},sendTfcIframeUserUpdate:function(){this._sendTfcIframeMessage("tfcIframeUpdate")},_sendTfcIframeMessage:function(e,t){var n=this,i=a(window.parent.frames);n._tfcIframes=s.filter(n._tfcIframes,function(e,t){return s.containsVal(i,t)}),s.each(n._tfcIframes,function(a,n){o.post(n,s.parseOrigin(document.URL),{tfcMessage:e,tfcData:t})})},setTfcIframeUpdateCallback:function(e){this._tfcIframeUpdateCallback=e},_origin:void 0,_window:void 0,_tfcIframes:void 0,_tfcIframeUpdateCallback:void 0})}(TFCApp);
"use strict";!function(e,s){var t,a=e.Constants,i=e.util,r=a.Message;t=e.Class.extend({_constructor:function(){this._$iframes=s(),this._sourceWindowId=e.postMessageManager.retailerWindowId()},_broadcastMessage:function(s,t){var a=this;this._$iframes.each(function(r,n){var o,c=n.src;c&&(o=i.parseOrigin(c),e.postMessageManager.postMessage(n.contentWindow,o,a._sourceWindowId,s,t))})},broadcastScreenSizeChange:function(e){this._broadcastMessage(r.ScreenSizeChange,{newSize:e})},broadcastFitRecResults:function(e){this._broadcastMessage(r.FitRecResults,{fitRecResults:e})},registerIframe:function(e){this._$iframes=this._$iframes.add(e)},unregisterIframe:function(e){this._$iframes=this._$iframes.not(e)},_$iframes:[],_sourceWindowId:null}),e.manager.ProfileMessageBroadcaster=t}(TFCApp,tfcJQuery);
"use strict";!function(e){function r(e,r){return{start:c.round(e,1),end:c.round(r,1)}}function n(e,r){return!!c.findVal(r,function(r,n){return e.name.indexOf(n)>-1})}function t(e,t){var i=c.findVal(e,function(e,r){return n(r,t)});return i?r(i.fetchStart,i.responseEnd):void 0}var i=e.type,c=e.util,o=e.bind(c.addParamIfNonZeroLengthString,null),s=e.utility,a=s.FitrecContext,f=e.FitRecResponse,u=s.Http,g=e.Constants,m=g.RequestParameter,p=e.utility.Logger.getLogger("PerformanceTracker"),d=e.Class.extend({_constructor:function(r,n){e.checkArgs(arguments)(i.Any,i.PlainObject);var t=this,c=n.integrationDomains||[],o=t._performance=r.performance;t._requiredApisPresent=!(!o||!o.getEntriesByType),t._configuration=n,t._tfDomains=c.concat([n.cdnURI,n.cdnSecureURI,n.serviceURI,n.serviceSecureURI])},sendWidgetRender:function(n,s,g,d){e.checkArgs(arguments)(i.String,i.Array,i.Number,i.Number);var l,_,y=this,h=y._configuration,S={},v={widgetNames:s,processWidget:r(g,d)};if(0===s.length)return void p.error("An empty array of widget names was provided to the performance tracker. Skipping performance logging.");if(y._requiredApisPresent){if(l=y._getTfcPerformanceEntries(),_={fitRecShim:y._getFitrecShimPerformanceEntry(),fitConfig:t(l,["/fitconfig?"]),fitRecAppJs:t(l,["/application.js"]),fitRecAppCss:t(l,["/fitrec.css","/fitrec-mobile.css","/fitrec-responsive.css"]),templates:t(l,["/templates.js"]),fitRecCall:t(l,["/fit?"])},c.find(_,function(e,r){return!r}))return void p.info("One of the timing entries could not be found["+JSON.stringify(_)+"]");c.each(_,function(e,r){v[e]=r}),o(S,m.IframeIntegration,a.isIframeIntegration.toString()),o(S,m.Locale,f.getLocale()),o(S,m.DeviceType,h.widgetDeviceType),o(S,m.AnalyticsScreenSize,h.responsiveManager.currentScreenSize()),u.post({serviceSecureUrl:h.serviceSecureURI+"/consumer/ui/"+h.storeKey+"/performance",queryParameters:S,userToken:n,data:v})}else p.debug("Performance API not present on the window")},_getTfcPerformanceEntries:function(){var e=this;return e._performance.getEntriesByType("resource").filter(function(r){return("script"===r.initiatorType||"link"===r.initiatorType)&&n(r,e._tfDomains)})},_getFitrecShimPerformanceEntry:e.Class.unimplemented,_configuration:null,_performance:null,_requiredApisPresent:null}),l=d.extend({_getFitrecShimPerformanceEntry:function(){return t(this._getTfcPerformanceEntries(),["/fitrec.js","/fitrec-internal.js"])}}),_=d.extend({_constructor:function(e,r){var n=this;n._super(e,r),n._requiredApisPresent=!(!n._requiredApisPresent||!n._performance.timing)},_getFitrecShimPerformanceEntry:function(){var e=this._performance.timing,n=e.navigationStart;return r(e.fetchStart-n,e.responseEnd-n)}});e.PerformanceTracker=e.chooseIntegration(l,_)}(TFCApp);
"use strict";!function(e){var a=e.util,t=e.utility,i=e.type,n=i.Integer,s=t.Logger.getLogger("CookieData"),_=10,o=e.Class.extend({_constructor:function(a){e.checkArgs(arguments)(i.Object({name:i.String,enabled:i.Boolean,types:i.PlainObject,maxAge:i.Or(n,i.Null).optional()})),i.Integer.test(a.maxAge)||i.Null.test(a.maxAge)||void 0===a.maxAge||s.raise("maxAge argument must be an integer (specified age), null (session cookie), or undefined (must call setMaxAge before saving data)"),this.__name=a.name,this.__maxAge=a.maxAge,this.__enabled=a.enabled,this._data=this._read(a.types)},setMaxAge:function(t){function s(){g.__lastMaxAgeUpdate=d,g.__maxAge=t,g._save()}e.checkArgs(arguments)(i.Or(n,i.Null));var o,r,g=this,l=g.__maxAge,d=a.now()/1e3;void 0===l||null!==l&&null===t?s():(o=g.__lastMaxAgeUpdate+g.__maxAge,r=d+t,Math.abs(o-r)>_&&s())},_read:function(t){var i=e.storage.get(this.__name),n=i?a.deparam(i):{},s={};return a.each(n,function(e,a){var i,n=t[e]||t._;n&&(i=n.fromString(a),void 0!==i&&(s[e]=i))}),s},_save:function(){void 0===this.__maxAge?s.error("Attempted to save cookie data without a max age"):this.__enabled?e.storage.set(this.__name,a.param(this._data),null===this.__maxAge?void 0:this.__maxAge):(s.warn("Storage for ["+this.__name+"] is disabled, but the software attempted to write to it ["+a.param(this._data)+"]. This may result in degraded or missing functionality."),e.storage["delete"](this.__name))},_data:null,__name:null,__maxAge:void 0,__lastMaxAgeUpdate:void 0,__enabled:null});e.add("CookieData",o)}(TFCApp);
"use strict";!function(e,i,t){var n,r=767,s=e.util,o=e.type,c=e.utility.Logger.getLogger("DeviceResolver"),d=e.Constants.DeviceType,a=[d.Desktop,d.Mobile];n=e.Class.extend({_constructor:function(t){e.checkArgs(arguments)(o.String.optional());var n=this;try{n._screenSizeQuery=i.matchMedia("(max-width: "+r+"px)")}catch(l){log.warn("Error trying to use matchMedia: ",l," Using the window width instead")}s.containsVal(a,t)?n.__deviceType=t:t===d.Responsive?c.info("Responsive device type resolving based on screen size."):t&&c.error("Invalid device type passed resolving based on screen size. [deviceType =  "+t+"]")},get:function(){var e=this;if(e.__deviceType)return e.__deviceType;if(e._screenSizeQuery)return e._screenSizeQuery.matches?d.Mobile:d.Desktop;var n=i.innerWidth||t.documentElement.clientWidth||t.body.clientWidth;return r>=n?d.Mobile:d.Desktop},__deviceType:null,__screenSizeQuery:null}),e.add("DeviceResolver",n)}(TFCApp,window,document);
"use strict";!function(t){var e,s=t.util,n=t.Constants.UserSettings,a=t.type,i={},r={};i[n.DiscoveryIntroMessageViewed]={type:a.Boolean,defval:!1},i[n.DiscoveryExitSuppressed]={type:a.Boolean,defval:!1},i[n.SessionParams]={type:a.String,defval:""},s.each(i,function(t,e){r[t]=e.type}),e=t.CookieData.extend({_constructor:function(e){this._super({name:t.utility.Storage.keys.UserSettings,enabled:e,types:r})},get:function(e){t.checkArgs(arguments)(a.String);var s=this._data[e],n=r[e],o=i[e].defval;if(void 0===o)throw"Attempt to retrieve a user setting that does not exist";return n.test(s)?s:o},set:function(e,s){var n=r[e];if(!n)throw"Attempt to save a user setting that does not exist";t.checkArgs(arguments)(a.String,n),this._data[e]=s,this._save()},getAllExceptSessionParams:function(){var t=this,e={};return s.each(n,function(s,a){a!==n.SessionParams&&(e[a]=t.get(a))}),e}}),e.keys=n,t.add("UserSettings",e)}(TFCApp);
"use strict";!function(t){var e=t.type,i=t.util,s=t.CookieData.extend({_constructor:function(i){this._super({name:t.utility.Storage.keys.UserVisit,enabled:i,maxAge:null,types:{_:e.Integer}})},getVisits:function(i){return t.checkArgs(arguments)(e.String),this._data[i]||0},trackVisits:function(s){t.checkArgs(arguments)(e.Array);var r=this,n=this._data;i.each(s,function(t,e){n[e]=r.getVisits(e)+1}),this._save()}});t.UserVisitTracker=s}(TFCApp);
"use strict";!function(e,t){var r=e.util;e.preLoadFitProfile=function(e,c,n){function s(){function e(){(new Image).src=c.cdnSecureURI+c.uxVersionPath+"/resources/fitprofile/index.html",(new Image).src=c.cdnSecureURI+c.uxVersionPath+"/resources/fitprofile/js/app.js",(new Image).src=c.cdnSecureURI+c.uxVersionPath+"/resources/fitprofile/css/application-responsive.css",(new Image).src=c.cdnSecureURI+c.storeVersionPath+"/resources/store/"+c.storeKey+"/css/tfpapp-responsive-web.css"}"complete"===document.readyState?e():t(document).bind("readystatechange",function(){"complete"===document.readyState&&e()})}var i=c.fitProfilePreLoad,o=i.pageCount,u=i.pageDelay,a=["tfc-fitrec-product","tfc-fitrec-account","tfc-fitrec-register"],f=r.sum(r.map(a,function(t,r){return e.getVisits(r)}));r.find(n,function(e,t){return r.containsVal(a,t)})&&(o&&f>=o?s():u&&setTimeout(s,1e3*u))}}(TFCApp,tfcJQuery);
"use strict";!function(e,t,i){function n(e){return t("iframe",e)}function r(e,i){return i?e.filter(function(){var e=t(this).attr(Y);return"secure-tip"===i?"secure"===e:"secure"!==e}):e}function a(e,t){var i=g(t).parents("."+L).length>0;return!i}function o(e,t,i){return r(g("."+e,t),i)}function s(e,t,i){return r(g("."+e,t).filter(a),i)}function l(e){return"tfc-"+e}function c(e){return e?N:j}function d(e){var t,i=m.filter(e,function(e,i){var n=m.stringStartsWith(i,"tfc-gender");return n&&(t=i),!n});return t&&i.push(t),i}var f,u,p,h,g=e.extLibs,m=e.util,_=e.type,w=e.Class,v=w.unimplemented,b=e.history,C=e.Constants,S=C.Message,$=C.ScreenSize,T=C.ModalWidth,M=C.LayoutType,P=e.popupManager,R="body",W="head",L="tfc-popup-wrap",z="tfc-tip-result",k="tfc-modal-result",y="tfc-tip-show-more",I="tfc-tip-click-show-more",O="tfc-tip-click-show-less",H="tfc-popup-click-open",U="tfc-popup-click-close",A="tfc-iframe-loaded",E="modal-visible",x="tfc-modal-visible",F={tfcModalVisible:!0},B="tfc-full-screen-modal",V="tfc-window-modal",D="tfc-viewport",Z='meta[name="viewport"]',j='<meta id="'+D+'" name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />',N='<meta id="'+D+'" name="viewport" content="width=device-width, initial-scale=1.0" />',J="tfc-content",K="above",Q="below",q="left",G="right",X="data-tip-id",Y="data-content-id",et=10,tt="data-legal-footer-setup",it="tfc-legal-footer-privacy-policy",nt="tfc-legal-footer-terms-of-use",rt="tfc-recipient-template",at="tfc-all-recipients",ot="insecure-tip",st="tfc-touch-target-large",lt="tfc-cfg-full-logo",ct="tfc-cfg-bra-logo",dt=e.utility.Logger.getLogger("TipOrModal"),ft={Close:"close",Complete:"complete",LogOut:"logout",Open:"open",PageLoad:"pageload",Render:"render",Update:"update",AddToBag:"addtobag",Chat:"chat",SizeChart:"sizechart",DiscoveryProductsViewed:"discoveryproductsviewed",UserClick:"userclick"},ut=m.map(m.objVals($),function(e,t){return l(t)}).join(" ");f=w.extend({_constructor:function(e){var t=e.$elem,i=t.find(".tfc-popup-wrap");if(1!==t.length)throw"TipOrModal expected exactly one element to be passed in";if(1!==i.length)throw"TipOrModal expected exactly one .tfc-popup-wrap";this._$elem=t,this._$wrap=i,this._teardownFns=[]},hasIframe:function(){return n(this._$elem).length>0},isInDom:function(){return this._$elem.parents("body").length>0},receiveMessage:function(e,t){var i,r=this,a=r._$wrap;e===S.Open?(a.stop(!0),a.addClass(A),i=n(a),r._sendAppRevealed(i)):e===S.Refresh?a.stop(!0):e===S.Resize?r._handleResizeMessage(e,t):e===S.ResizeModalWidth&&r._handleResizeModalWidthMessage(e,t)},_sendAppRevealed:function(t){var i,n=t[0],r=e.postMessageManager.retailerWindowId(),a=n.src;a&&(i=m.parseOrigin(a),e.postMessageManager.postMessage(n.contentWindow,i,r,S.AppRevealed))},_handleResizeMessage:function(e,t){var i,r,a,o,s,l=this;i=l._$wrap,r=n(i),a=i.add(r),l._shouldHandleResize()&&(o=t.offsetHeight,s=t.scrollHeight,dt.debug("Animating tip height: ",t),a.stop(!0),o===s?(r.css("height",i.height()),a.animate({height:o})):(i.height()!==o&&(dt.warn("Tip offsetHeight changed and does not match scrollHeight. Tip height will be animated instantaneously."),i.css("height",o)),r.css("height",s)))},_handleResizeModalWidthMessage:function(e,t){var i,r=this,a=r._$wrap,o=n(a),s=a.width();r._currentWidth=t.modalWidth,r._shouldHandleWidthResize()&&(r._narrowWidth||(r._narrowWidth=s),T.Wide===t.modalWidth?i=r._wideWidth:T.Narrow===t.modalWidth?i=r._narrowWidth:dt.error("Attempting to set modal width to something other than wide or narrow"),i&&i!==s&&(o.css("width",i),o.css("marginLeft",(s-i)/2),a.css("marginLeft",s/-2),a.css("overflow","hidden"),a.animate({width:i,marginLeft:i/-2}),o.animate({marginLeft:0},{complete:function(){a.css("overflow","")}})))},_clearWrapAndIframeHeightWidthMargin:function(){var e,t,i;e=this._$wrap,t=n(e),i=e.add(t),i.css("height",""),i.css("width",""),i.css("marginLeft","")},_container:v,_setupLegalFooterClickEvents:function(e){function t(t,i){e.staticContentUri&&g("."+t,n).bind("click",function(){i(e.staticContentUri,e.locale)})}var i=this,n=i._$elem;n.data(tt)||(t(it,P.openPrivacyPolicy),t(nt,P.openTermsOfUse),n.data(tt,!0))},_shouldHandleResize:v,_shouldHandleWidthResize:v,id:v,clickOpenTriggers:function(){return g("."+H,this._$elem)},clickOpenTriggersForTipId:function(e){return o(H,this._$elem,e)},clickCloseTriggers:function(){return g("."+U,this._$elem)},toggleShowMore:v,setupMoreLessInfoHandlers:function(){var e=this,t=e._$elem;g("."+I,t).bind("click",function(){e.toggleShowMore(!0)}),g("."+O,t).bind("click",function(){e.toggleShowMore(!1)})},show:function(i,r,a,o,s){var l,c,f=this,u=f._$wrap,p=o&&o.before,g=o&&o.after,_=e.FitRecResponse.getResponse(),w=_.extraClasses.concat(i.extraClassesStr.toString().split(" ")),v=d(w),b=v.join(" ");if(this.hasIframe()){h=m.now(),l=n(u);var S=l.parent();l.remove(),l.attr("src",tfc.__getProfileUrl(m.extend({container:f._container(),isShoppingForOther:!_.userFlags.isShoppingForSelf,recipientAlias:_.recipientUser&&_.recipientUser.alias},r))),S.append(l),s.profileMessageBroadcaster.registerIframe(l)}else f.setContent(a),f.setupMoreLessInfoHandlers(),f.setSfoRecipients();this._setupLegalFooterClickEvents(i),p&&p(),u.fadeIn(function(){g&&g()}),f.decorateElement(b),r.productType===C.ProductType.Bras&&t("."+lt).addClass(ct),f.hasIframe()||(c=f.getTabbable().get(0),c&&c.focus())},hide:function(e,t,i){function r(){t.profileMessageBroadcaster.unregisterIframe(c),o=c.removeAttr("src").clone(),c.replaceWith(o),s._clearWrapAndIframeHeightWidthMargin()}function a(){l.removeClass(y).removeClass(A),f&&f(),r(),s.decorateElement(""),m.each(s._teardownFns,function(e,t){t.apply()}),s._teardownFns=[]}var o,s=this,l=s._$wrap,c=n(l),d=e&&e.before,f=e&&e.after;d&&d(),i&&i.openingTipId===ot&&i.closingTipId===ot?a():l.fadeOut(function(){a()})},getTabbable:function(){return t("a,button",this._$wrap)},decorateElement:function(e){var t=this._$elem,i="PRIOR_DECORATIONS",n=t.data(i);t.removeClass(n).addClass(e),t.data(i,e)},setContent:function(e){this._$elem.find("."+J).replaceWith(e)},getWrapElem:function(){return this._$wrap},setSfoRecipients:function(){var t=this._$elem,i=e.FitRecResponse.getResponse(),n=t.find("."+rt),r=t.find("."+at),a=n;m.each(i.sfoRecipientLinks,function(e,t){var r,o,s,l;t.id&&(r=n.clone(),r.removeAttr("id"),o=r.find(".tfc-recipient-radio"),o.attr("value",t.id),o.attr("id","tfc-recipient-radio-"+t.id),s=r.find(".tfc-cfg-radio-label"),s.attr("for","tfc-recipient-radio-"+t.id),s.text(t.alias),l=r.find(".tfc-recipient-edit-link"),l.attr("data-recipient-id",t.id),i.recipientUser.alias===t.alias&&o.attr("checked","checked"),a=a.add(r))}),r.html(a),r.find("#tfc-myself").find('a[data-ips="sfoedit"]').remove(),i.userFlags.isShoppingForSelf&&r.find("input#tfc-myself-radio").attr("checked","checked"),r.find('input[name="tfc-recipient"]').bind("change",function(){var e=r.find('input[name="tfc-recipient"]:checked');tfc.__calculate(void 0,{recipientLinkId:e.attr("value")})})},_$elem:null,_$wrap:null}),u=f.extend({_constructor:function(e){this._super(e),e.$widget||dt.raise("Tip constructor expects a $widget element"),this._$widget=e.$widget},id:function(){return this._$elem.attr(X)},setPlacement:function(e){this._$wrap.addClass("tfc-"+e)},getPlacement:function(){var e=this._$wrap;return m.findVal(u.Placement,function(t,i){return e.hasClass("tfc-"+i)})},toggleShowMore:function(e){var t,i,n=this._$wrap;t=n.height(),n.toggleClass(y,e),i=n.height(),n.css("height",t),n.animate({height:i},{complete:function(){n.css("height","")}})},_container:function(){return C.Container.Tip},_shouldHandleResize:function(){return!0},_shouldHandleWidthResize:function(){return!1},show:function(t,n,r,a,o){function s(e,t,n){dt.debug("setting scroll to:",e),g.scrollTop(i,e);var r=g.scrollTop(i);Math.abs(r-e)<1&&setTimeout(function(){Math.abs(t-e)<=n?g.scrollTop(i,t):e>t?s(e-n,t,n):s(e+n,t,n)},5)}var l,c,d,f,p,h,m,_,w,v,b=this,C=o.tipConfig,S=this._$wrap,$=this._$widget,T=b.getPlacement(),M=i.innerHeight,P=10,R=370,W=Math.round(g.scrollTop(i)),L=4,z=C.autoScrollThresholdTop+P,k=C.autoScrollThresholdBottom+P;this._super(t,n,r,a,o),b._resizeHandler=l=e.bind(b._positionTipWithinWindowBounds,b,b._getCssPos()),l(),i.addEventListener("resize",l),T!==u.Placement.Above?(p=S[0].getBoundingClientRect().top,d=p+R,d>M-k&&(m=$[0].getBoundingClientRect().top,_=Math.min(p,m),c=d-_,c>M-z-k?w=W+_-z:(v=d-M,w=W+v+k),s(W,w,L))):(h=S[0].getBoundingClientRect().bottom,f=h-R,z>f&&(w=W-(z-f),s(W,w,L)))},hide:function(e,t,n){var r=this,a=e&&e.before,o=e&&e.after;this._super({before:a,after:function(){o&&o(),i.removeEventListener("resize",r._resizeHandler),r._resizeHandler=null,r._clearCssPos()}},t,n)},_cssPlacementProp:function(){return this.getPlacement()===u.Placement.Left?"right":"left"},_getCssPos:function(){return parseInt(this._$wrap.css(this._cssPlacementProp()))||0},_clearCssPos:function(){this._$wrap.css(this._cssPlacementProp(),"")},_positionTipWithinWindowBounds:function(e){function t(e){return m+h*e}function n(e){a.css(p,t(e))}var r=this,a=r._$wrap,o=g(i),s=a.offset().left,l=g.outerWidth(a),c=o.width(),d=c-(s+l),f=et-s,u=et-d,p=r._cssPlacementProp(),h="left"===p?1:-1,m=r._getCssPos(),_=h*(e-m);n(0>f+u?f>0?f:u>0?-u:_>0?Math.min(_,-u):Math.max(_,f):(f-u)/2)},_resizeHandler:null,_$widget:null}),p=f.extend({_constructor:function(e){this._super(e),this._id=_.String.test(e.id)?e.id:null,this._fullScreenPopupZoomEnabled=e.fullScreenPopupZoomEnabled},receiveMessage:function(e,t){var i=this;i._super(e,t),e===S.Open&&i._resetScrollPosition()},_container:function(){return C.Container.Modal},screenSize:function(){return this._$wrap.hasClass(l($.Large))?$.Large:$.Small},_shouldHandleResize:function(){var e=this;return e.isVisible()&&e.screenSize()===$.Large},_shouldHandleWidthResize:function(){var e=this;return e.isVisible()&&e.screenSize()===$.Large},updateScreenSize:function(e){var i=this,r=t(R);if(i._$wrap.removeClass(ut).addClass(l(e)),i.isVisible())if(r.toggleClass(B,i.screenSize()===$.Small),r.toggleClass(V,i.screenSize()===$.Large),t("."+U).toggleClass(st,i.screenSize()===$.Small),i.screenSize()===$.Large){var a=g("#"+D),o=g(Z).not(a);if(a.attr("content",o.attr("content")||"").remove(),i._$elem.css("top",i._startingScrollPosition.top),i._resetScrollPosition(),i._currentWidth===T.Wide){var s,d=i._$wrap,f=n(d);s=i._wideWidth,d.css("width",s),d.css("marginLeft",s/-2),f.css("width",s)}}else g(W).append(c(i._fullScreenPopupZoomEnabled)),i._$elem.css("top",0);i._shouldHandleResize()||i._clearWrapAndIframeHeightWidthMargin()},id:function(){return this._id},placeOnPage:function(){g(R).append(this._$elem)},toggleShowMore:function(e){this._$wrap.toggleClass(y,e)},show:function(n,r,a,o,s){var l,d=this,f=o&&o.before,u=o&&o.after,p=t(R),h=new e.TabHelper;d.isShowAnimationRunning=!0,d._wideWidth||(d._wideWidth=s.modalWidthLarge),d._super(n,r,a,{before:function(){if(d._startingScrollPosition={top:g.scrollTop(i),left:g.scrollLeft(i)},d.screenSize()===$.Large){var e=document.body.getBoundingClientRect();d._$elem.css("top",-e.top)}!n.popStateEnabled||b.state&&b.state.tfcModalVisible||b.pushState(F,""),d._$elem.data(E,!0),d.screenSize()===$.Small?(p.addClass(B),t("."+U).addClass(st)):p.addClass(V),d._$elem.show(),f&&f()},after:function(){p.addClass(x),d.screenSize()===$.Small&&g(W).append(c(d._fullScreenPopupZoomEnabled)),u&&u(),d.isShowAnimationRunning=!1}},s),this.hasIframe()||(l=d.getTabbable(),l.each(function(i,n){h.add(n);var r=e.bind(h.handleKeydown,h,n);t(n).bind("keydown",r),d._teardownFns.push(function(){t(n).unbind("keydown",r)})}))},hide:function(e,i,n){var r=this,a=e&&e.before,o=e&&e.after,s=t(R);r._super({before:function(){if(!n){if(r.screenSize()===$.Small){var e=g("#"+D),t=g(Z).not(e);e.attr("content",t.attr("content")||"").remove()}s.removeClass(x),b.state&&b.state.tfcModalVisible&&b.back()}a&&a()},after:function(){r._resetScrollPosition(),r._$elem.data(E,!1),n||(s.removeClass(B).removeClass(V),r._$elem.css("top",0)),r._$elem.hide(),o&&o()}},i,n)},isVisible:function(){return!!this._$elem.data(E)},_id:null,_startingScrollPosition:null,_resetScrollPosition:function(){var e=this;g.scrollTop(i,e._startingScrollPosition.top),g.scrollLeft(i,e._startingScrollPosition.left)},isShowAnimationRunning:!1});var pt=u.extend({show:v,hide:v}),ht=p.extend({show:function(e,t,i,n,r){var a=this,o=n&&n.before,s=n&&n.after,l={before:function(){r.$widget.invisible(),r.integrationManager.changeLayout(M.Modal),o&&o()},after:s};a._super(e,t,i,l,r)},hide:function(e,t,i){var n=this,r=e&&e.before,a=e&&e.after,o={before:r,after:function(){i||(t.integrationManager.changeLayout(M.Inline),t.$widget.visible()),a&&a()}};n._super(o,t,i)}});f.clickOpenTriggers=e.bind(o,null,H),f.clickOpenTriggersOutsidePopup=e.bind(s,null,H),f.clickCloseTriggersOutsidePopup=e.bind(s,null,U),u.Placement={Above:K,Below:Q,Left:q,Right:G},u.widgetTips=function(i){var n=t("."+z,i),r=[],a=e.chooseIntegration(u,pt);return n.each(function(e,n){r.push(new a({$elem:t(n),$widget:i}))}),r},u.fromWidget=function(i,n){var r=t("."+z,i).filter(function(e,i){return t(i).attr(X)===n}),a=e.chooseIntegration(u,pt);return 1===r.length?new a({$elem:r,$widget:i}):null},p.fromTemplate=function(t,i,n){var r=e.chooseIntegration(p,ht);return new r({$elem:t.filter("."+k),id:i,fullScreenPopupZoomEnabled:n})},f.handleCriticalMessage=function(e,t,i,n,r,a){var o;e===S.Open?(dt.info("TIME TO LOAD: "+new Date(m.now()-h).getTime()/1e3),i(ft.Open,{data:t})):e===S.Close?i(ft.Close,{data:[]}):e===S.Complete?(i(ft.Complete,{tfpUser:t.tfpUser,placement:t.placement,isCredentialSaved:t.tfpUser.isCredentialSaved}),n(),a.sendTfcIframeUserUpdate()):e===S.PageLoad?i(ft.PageLoad,t):e===S.Update?(i(ft.Update),n(),a.sendTfcIframeUserUpdate()):e===S.LogOut?(i(ft.LogOut),n(),a.sendTfcIframeUserUpdate()):e===S.AddToBag?i(ft.AddToBag,t):e===S.Refresh?(o=t&&t.isEnteringData,tfc.__calculate(void 0,{isEnteringData:o}),a.sendTfcIframeRefresh(o)):e===S.Chat?i(ft.Chat):e===S.UserSetting?r.set(t.key,t.value):e===S.SizeChart?i(ft.SizeChart):e===S.DiscoveryProductsViewed?i(ft.DiscoveryProductsViewed,t):e===S.UserClick&&i(ft.UserClick,t)},e.TipOrModal=f,e.Tip=u,e.Modal=p}(TFCApp,tfcJQuery,window);
"use strict";!function(n,e){var t,i,s,o,r,c,l,u,a=n.extLibs,g=n.tips,p=n.type,d=n.util,f=n.Class,b=f.unimplemented,h=n.TipOrModal,_=n.Constants,v=_.SourceTrigger,C=_.Attributes,O="tfc-popup-wrap",T="tfc-content",E="body",k="tfc-full-screen-modal",S=n.utility.Logger.getLogger("TipTriggers"),w=function(){var n=null,e=500;return function(t,i){null===n&&(n=setTimeout(function(){n=null},e),i.call(t))}}();t=f.extend({_constructor:function(t){n.checkArgs(arguments)(p.Object({tipConfig:p.PlainObject,userSettings:p.Instance(n.UserSettings),userVisitTracker:p.Instance(n.UserVisitTracker),widgetName:p.String,receiveMessageSignal:p.Instance(n.Signal).optional(),$widget:p.Instance(e),handleOpen:p.Function})),this._options=t},_isEnabled:b,_beforeTipOpen:function(){},_bindEvents:b,bindEvents:function(){var n=this,e=this._options;this._unbindEvents=this._bindEvents({$widget:e.$widget,handleOpen:function(t,i){n._isEnabled()&&(n._beforeTipOpen(),e.handleOpen(t,i))},$tipClickOpen:e.$tipClickOpen,listenForOpenReg:e.listenForOpenReg,unlistenForOpenReg:e.unlistenForOpenReg})},unbindEvents:function(){this._unbindEvents&&(this._unbindEvents(),this._unbindEvents=null)},_options:null,_unbindEvents:null}),i=t.extend({_constructor:function(e){this._super(e),n.checkArgs(arguments)(p.Object({listenForOpenReg:p.Function,unlistenForOpenReg:p.Function}))},_isEnabled:function(){return!0},_bindEvents:function(n){function e(){n.handleOpen([new r({receiveMessageSignal:t._options.receiveMessageSignal}),new c],{sourceTrigger:v.Banner})}var t=this,i=n.listenForOpenReg,s=n.unlistenForOpenReg;return i(e),function(){s()}}}),s=t.extend({_constructor:function(t){this._super(t),n.checkArgs(arguments)(p.Object({$tipClickOpen:p.Instance(e)}))},_isEnabled:function(){return!0},_bindEvents:function(n){function t(t){t.fromClickTipOpen=!0,w(this,function(){var t=a(this),s=t.attr("data-content-id"),o=e("."+T,t.parents("."+O)),l=o.length?v.Popup:v.Widget;n.handleOpen([new r({receiveMessageSignal:i._options.receiveMessageSignal}),new c],s&&"secure"!==s?s:{ips:t.attr(C.IPS),editRecipientLinkId:t.attr(C.RECIPIENT_ID),sourceTrigger:l})})}var i=this,s=n.$tipClickOpen;return s.bind("click",t),function(){s.unbind("click",t)}}}),o=f.extend({_constructor:function(e){n.checkArgs(arguments)(p.Object({beforeTipClose:p.Function.optional(),receiveMessageSignal:p.Instance(n.Signal).optional()}).optional()),this._options=e},bindEvents:function(t){n.checkArgs(arguments)(p.Object({$widget:p.Instance(e),tipOrModal:p.Instance(h),handleClose:p.Function,$tipClickClose:p.Instance(e)}));var i=this;this._unbindEvents=this._bindEvents({$widget:t.$widget,tipOrModal:t.tipOrModal,$tipClickClose:t.$tipClickClose,handleClose:function(n){i._beforeTipClose(),t.handleClose(n)}})},_beforeTipClose:function(){var n=this._options,e=n&&n.beforeTipClose;e&&e()},_bindEvents:b,unbindEvents:function(){this._unbindEvents&&(this._unbindEvents(),this._unbindEvents=null)},_unbindEvents:null,_options:null}),r=o.extend({_constructor:function(e){this._super(e),n.checkArgs(arguments)(p.Object({selector:p.String.optional()}).optional())},_bindEvents:function(n){function e(){w(this,function(){n.handleClose()})}function t(e){"close"===e&&n.handleClose()}var i=this._options,s=i&&i.selector,o=i&&i.receiveMessageSignal,r=o&&!s,c=s?a(s,n.$widget):n.$tipClickClose;return r&&o.listen(t),c.bind("click",e),function(){r&&o.unlisten(t),c.unbind("click",e)}}}),c=o.extend({_bindEvents:function(n){function t(t){d.isRealMouseEvent(t)&&w(this,function(){t.fromClickTipOpen||0!==e(t.target).parents("."+O).length||e(E).hasClass(k)||n.handleClose()})}var i=e(document);return i.bind("click",t),function(){i.unbind("click",t)}}}),l=o.extend({_constructor:function(e){this._super(e),n.checkArgs(arguments)(p.Object({signal:p.Instance(n.Signal)}))},_bindEvents:function(n){var e=this._options.signal,t=function(e){S.debug("SignalTipCloseTrigger - triggerArgs:",e),n.handleClose(e)};return e.listen(t),function(){e.unlisten(t)}}}),u=o.extend({_bindEvents:function(n){var e=function(){n.tipOrModal.isShowAnimationRunning||(S.debug("PopState close triggered"),n.handleClose())},t=function(n){S.debug("PopStateTipCloseTrigger - popstate event",n),d.browser.isEdge||e()};return window.addEventListener("popstate",t),function(){window.removeEventListener("popstate",t)}}}),g.ClickTipOpenTrigger=s,g.MessageTipOpenTrigger=i,g.ClickTipCloseTrigger=r,g.PageClickTipCloseTrigger=c,g.SignalTipCloseTrigger=l,g.PopStateTipCloseTrigger=u}(TFCApp,tfcJQuery);
"use strict";!function(e,i){function t(e,i,t){var n=this,r=n.context,a=e.data(s);_.handleCriticalMessage(i,t,r.fireFitrecRegisterEvent,r.fireFitrecRegisterScaledSizes,r.userSettings,r.integrationManager),a&&a.tipOrModal.receiveMessage(i,t)}function n(i){function t(i){var t=i.filter(function(){return e(this).attr(o)});if(i.length!==t.length)throw o+" must be defined on every tip trigger because there are multiple tips for this widget."}t(_.clickOpenTriggers(i)),t(_.clickCloseTriggersOutsidePopup(i))}var r="tfc-fitrec-result",a="tfc-tip-window-id",s="tfc-visible-popup-info",g="tfc-tip-receive-message-signal",d="tfc-tip-ab-test-setup",o="data-content-id",l=i.extLibs,c=i.util,p=i.tips,u=i.Constants,T=u.Attributes,h=i.Tip,_=i.TipOrModal,f=i.utility.FitrecContext,w=i.utility.Logger.getLogger("WidgetWithTips");i.widget({className:"WidgetWithTips",widgetName:"tfc-widget-with-tips",isAbstract:!0,_cdnProfileURI:null,_constructor:function(e){this._super(e),this._cdnProfileURI=e.cdnProfileURI},_initTip:function(e,n){n=n||"";var r=this,s=e.data(g);if(!s){var o=i.postMessageManager.nextWindowId();s=new i.Signal,e.data(a,o).data(g,s),s.listen(i.bind(t,this,e)),i.postMessageManager.receiveMessage(i.bind(s.trigger,s),r._cdnProfileURI,o)}e.data(d)||(e.data(d,!0),i.abTestComplete.listen(function(i){i===r.widgetName&&(w.debug(r.widgetName+" abTestComplete listen handler - START"),r._unbindCloseTriggers(e),r._bindCloseTriggers(e),r._initAllTips(e,n),w.debug(r.widgetName+" abTestComplete listen handler - STOP"))}))},_initAllTips:function(e,i){var t=c.extend({widgetName:this.widgetName,receiveMessageSignal:e.data(g)},this.context);n(e),this._initTipOpenTriggers(e,t,[],i)},_initTipOpenTriggers:function(t,n,a,g,d,u,T){function f(e){return function(n,r){u&&u.trigger({launchedTipId:e});var a=i.cookieHelper.userToken();a?v._launchTip(t,e,S,n,r,g):tfc.__calculate()}}var O,b,I,C,m,v=this,P=[],N=(l("."+r,t),function(){w.debug(v.widgetName+" _initTipOpenTriggers - READING VISIBLE_POPUP_INFO_DATA_KEY");var e=t.data(s);return e&&e.tipOrModal.isInDom()?e:(w.debug(v.widgetName+" _initTipOpenTriggers - CLEARING VISIBLE_POPUP_INFO_DATA_KEY"),t.data(s,null),null)}()),S=(this.context.userSettings,i.bind(v._initTipOpenTriggers,v,t,n,P,g)),L=h.widgetTips(t);if(d=d||N&&N.tipOrModal,b=d&&d.id(),T=T||N&&N.visibleContentId,u=u||N&&N.otherTipLaunchedSignal,w.debug(v.widgetName+" _initTipOpenTriggers - visibleTipOrModal:",d,"visibleTipInfo:",N,"otherTipLaunchedSignal:",u,"visibleTipId:",b),O=c.filter(L,function(e,i){var t=i.id();return"insecure-tip"===t||t!==b}),c.each(a,function(e,i){i.unbindEvents()}),v._widgetClickOpen()){m=v._alwaysLaunchSecureTip()?"secure-tip":"insecure-tip",P.push(new p.ClickTipOpenTrigger(c.extend({$widget:t,$tipClickOpen:t,handleOpen:f(m)},n)));var A=v.context.integrationManager,E=function(){P.push(new p.MessageTipOpenTrigger(c.extend({$widget:t,listenForOpenReg:i.bind(A.listenForOpenReg,A),unlistenForOpenReg:i.bind(A.unlistenForOpenReg,A),handleOpen:f(m)},n)))};i.chooseIntegration(c.noop,E)()}return 0===L.length&&(m=v._alwaysLaunchSecureTip()?"secure-tip":"insecure-tip",C=_.clickOpenTriggers(t,m),C.length&&P.push(new p.ClickTipOpenTrigger(c.extend({$widget:t,$tipClickOpen:C,handleOpen:f(m)},n)))),c.each(O,function(i,r){var a,s,g;a=r.id(),g=_.clickOpenTriggersOutsidePopup(t,a),d&&(g=g.add(d.clickOpenTriggersForTipId(a)),T&&(g=g.filter(function(){return e(this).attr(o)!==T}))),I=c.extend({$widget:t,handleOpen:f(a)},n),s=[],g.length&&s.push(new p.ClickTipOpenTrigger(c.extend({$tipClickOpen:g},I))),c.each(s,function(e,i){P.push(i)})}),c.each(P,function(e,i){i.bindEvents()}),S},_beforeLaunchTip:c.noop,_afterLaunchTip:c.noop,_launchTip:function(e,t,n,r,g,d){var o,l,T,_,O,b=this,I=b.context,C={locale:b._getLocaleCode(),staticContentUri:I.profileURI,extraClassesStr:d};w.debug(b.widgetName+" _launchTip - tipId:",t,"reinitTips:",n,"closeTriggers:",r),b._alwaysLaunchModal()||f.isIframeIntegration||b._widgetContext(e)===u.Context.QuickView||I.pdpWidgetAppContainer===u.Container.Modal||I.responsiveManager.currentScreenSize()===u.ScreenSize.Small?(O=I.getModal(t),I.responsiveManager.currentScreenSize()===u.ScreenSize.Small&&(C.popStateEnabled=!0,_=new p.PopStateTipCloseTrigger)):(O=h.fromWidget(e,t),O||w.raise("Tip: "+t+" not found on widget:",e),O.setPlacement(I.tipConfig.placement)),O.hasIframe()?o=c.extend({windowId:e.data(a)},g,b._getProfileParamsWithWidgetName(e)):(o=c.extend({windowId:e.data(a)},b._getProfileParamsWithWidgetName(e)),T=g,l=b.templates[g+"-content"]),O.show(C,o,l,{before:function(){b._beforeLaunchTip(e,O,g)},after:function(){b._afterLaunchTip(e,O,g)}},c.extend({$widget:e},b.context));var m=new i.Signal,v=new p.SignalTipCloseTrigger({signal:m});w.debug(b.widgetName+" _launchTip - SETTING VISIBLE_POPUP_INFO_DATA_KEY"),e.data(s,{tipOrModal:O,otherTipLaunchedSignal:m,otherTipLaunchedTipCloseTrigger:v,reinitTipsWhenThisOneCloses:n(O,m,T),closeTriggers:r,visibleContentId:T}),w.debug(b.widgetName+" _launchTip - VISIBLE_POPUP_INFO_DATA",e.data(s)),r.push(v),_&&r.push(_),b._bindCloseTriggers(e)},_bindCloseTriggers:function(e){var i,t,n,r,a,g,d=this,o=e.data(s);w.debug(d.widgetName+" _bindCloseTriggers - READING VISIBLE_POPUP_INFO_DATA_KEY"),w.debug(d.widgetName+" _bindCloseTriggers - visibleTipInfo:",o),o&&(t=o.closeTriggers,a=o.otherTipLaunchedTipCloseTrigger,g=o.reinitTipsWhenThisOneCloses,n=o.tipOrModal,r=n.id(),i=_.clickCloseTriggersOutsidePopup(e,n.id()).add(n.clickCloseTriggers()),c.each(t,function(t,s){var o=s===a,l=function(i){d._closeTip(e,n,r,i&&i.launchedTipId),o||g()};s.bindEvents({$widget:e,tipOrModal:n,$tipClickClose:i,handleClose:l})}))},_unbindCloseTriggers:function(e){var i,t=e.data(s);w.debug(this.widgetName+" _unbindCloseTriggers - READING VISIBLE_POPUP_INFO_DATA_KEY"),w.debug(this.widgetName+" _unbindCloseTriggers - visibleTipInfo:",t),t&&(i=t.closeTriggers,i&&c.each(i,function(e,i){i.unbindEvents()}))},_closeTip:function(e,i,t,n){var r=this;w.debug(r.widgetName+" _closeTip - tipId:",t,"launchedTipId:",n),r._unbindCloseTriggers(e),w.debug(r.widgetName+" _closeTip - CLEARING VISIBLE_POPUP_INFO_DATA_KEY"),e.data(s,null),i.hide(void 0,c.extend({$widget:e},r.context),n?{closingTipId:t,openingTipId:n}:void 0)},_getProfileParams:i.Class.unimplemented,_getProfileParamsWithWidgetName:function(e){var i=this;return c.extend(i._getProfileParams(e),{originWidget:i.widgetName})},_widgetContext:function(e){return e.attr(T.CONTEXT)},_alwaysLaunchModal:function(){return!1},_alwaysLaunchSecureTip:function(){return!1},_widgetClickOpen:function(){return!1}})}(tfcJQuery,TFCApp);
"use strict";!function(t,e){function r(t){return Y("."+L,t)}function n(t){var e=t.attr(x.STYLE_ID),r=S[e];return{firstName:t.attr(x.FIRST_NAME),gender:t.attr(x.GENDER)||r.gender,department:r.department,productType:r.productType,registered:t.attr(x.STORE_REGISTERED),styleId:e,alternateUserId:t.attr(x.ALT_USER_ID),styleColorId:t.attr(x.STYLE_COLOR_ID),availableSizes:t.attr(x.AVAILABLE_SIZES),context:t.attr(x.CONTEXT),widgetHidden:t.attr(x.WIDGET_HIDDEN),storeExperimentKey:t.attr(x.STORE_EXPERIMENT_KEY)}}function i(t,e){r(t).addClass(R),tfc.__calculate(void 0,{isEnteringData:e})}function a(t,e){var r={};return f.each(t,function(t,n){f.containsVal(e,t)&&(r[t]=n)}),r}function s(t){return a(t,B)}function o(t){return a(t,j)}function c(e){return{fitRecommendations:t.map(e.fitRecommendations,function(t){return s(t)}),tfpUser:o(e.tfpUser)}}function l(t,e,r){return{element:t,fitRecommendation:s(e),response:r}}function u(t,e,r){var n=e.templateName,i=t===v.NoUser,a=n===v.IncompleteProfile,s=r.isEnteringData;return s&&i&&a&&(n=t),n}var d=e.type,f=e.util,p=e.Constants,g=e.Tip,m=g.Placement,S={},E=p.FitRec.Event,_=p.FitRec.Status,v=p.FitRec.TemplateName,I=E.OpenDialog,b=E.MoreInfo,A=E.Render,h="tfc-fitrec-retry",R="tfc-retry-fitrec-inprogress",T="tfc-fitrec-base",L="tfc-fitrec-result",C="tfc-tip-result",y="tfc-cfg-basic-button",O="tfc-hide-logo-if-gsa-available",D="tfc-hide-logo",N="tfc-gsa-enabled",z="tfc-gsa-disabled",F="tfc-gsa-available",U="tfc-gsa-unavailable",Y=e.extLibs,P=e.FitRecUtil,x=p.Attributes,B=["id","status","score","priority","size","advice","recommended","recommendable"],j=["isAuthenticated","isInitialProfileComplete","isLoggedOut","isUserAvailable","isCredentialSaved","gender"],w="data-event-object",M="data-current-template-name",V=e.utility.Logger.getLogger("FitRecs"),Z=e.utility.Http,G=f.addParamIfNonZeroLengthString;e.widget({className:"FitRecs",widgetName:T,isAbstract:!0,retryTimeoutId:null,event:function(t,e){t===b&&(t=I),this._super(t,e)},getNodes:function(){var e=this._super();return e.map(function(){var e=t(this);return e.attr(x.STYLE_ID,e.attr(x.STYLE_ID_NEW)||e.attr(x.STYLE_ID_LEGACY))})},getCurrentFitResults:function(){return S},clearCurrentFitResults:function(){S={}},preCall:function(){var t=this,e=t._super();return t.retryTimeoutId&&clearTimeout(t.retryTimeoutId),e},_supportedAttrs:function(){return this._super().concat([x.STYLE_ID,x.CONTEXT,x.AVAILABLE_SIZES,x.STYLE_COLOR_ID])},_preCallAttrs:function(){return f.filter(this._super(),function(t,e){return e!==x.AVAILABLE_SIZES&&e!==x.STYLE_COLOR_ID})},expectedUpdateTypes:function(){var t=this._super();return t.products=d.ObjectOf(d.Object({availableSizes:d.String.optional(),colorId:d.String.optional()})).optional(),t},update:function(e){this._super(e);var r,n=this,i=e&&e.products;i&&(r=n.getNodes(),f.each(i,function(e,i){var a=r.filter(function(){return t(this).attr(x.STYLE_ID)===e});f.each(i,function(t,e){n._updateAttr(a,t,e)})}))},postCall:function(e){var r=e.fitRecommendations,n={},a=c(e),s=this,o=s.getNodes(),l=!1,u=[],d=s.context;s._super(e),d.profileMessageBroadcaster.broadcastFitRecResults(r),f.each(r,function(t,e){n[e.id]=S[e.id]=e,e.status===_.NoUser&&(l=!0)}),o.each(function(r,i){var o=t(i).attr(x.STYLE_ID),c=n[o],l=c&&c.extraClasses||[],d=e.extraClasses.concat(l),f=d.join(" ");s._renderResultFitCall(Y(i),n[o],e,a,f,u)}),u.length>0&&(this.retryTimeoutId=setTimeout(function(){i(o,e.isEnteringData)},5e3)),s.event(A,{widgets:o.get(),response:a}),d.integrationManager.widgetComplete(o.get(0).scrollHeight),e.sizeAvailabilityCaptureEnabled&&o.length>0&&o.each(function(e,r){if(void 0!==t(r).attr(x.AVAILABLE_SIZES)){var n=t(r),i=n.attr(x.AVAILABLE_SIZES).split(d.availableSizesDelimiter),a=n.attr(x.STYLE_ID),s={},o="ui-locale-code",c="color-code";G(s,o,n.attr(x.LOCALE)),G(s,c,n.attr(x.STYLE_COLOR_ID));var l={serviceSecureUrl:d.sizeAvailabilityURI+"/size-availability/public/v1/stores/"+d.storeKey+"/products/"+a+"/available-sizes",data:i,queryParameters:s};Z.post(l)}else V.error("Size availability capture is enabled, but the "+x.AVAILABLE_SIZES+" attribute is not present on the widget.")})},_getProfileParams:function(t){return n(t)},_renderResultCommon:function(t,e,n,i){var a,s=i.recipientUser,o=i.userFlags.isShoppingForSelf;a=o?t.attr(x.FIRST_NAME):s.alias,r(t).addClass(e+" "+n),a&&Y(".tfc-first-name",t).html(a)},_renderResultFitCall:function(n,a,s,o,c,p){function g(t,r){return e.checkArgs(arguments)(d.String,d.String),function(e,n){return n&&f.stringStartsWith(e,t)&&f.stringEndsWith(e,r)}}function S(e,r){var n,i=X.templates;return r?(n=g(e,r),t.map(i,function(t,e){return n(e,t)?t:null})):i[e]?[i[e]]:[]}if(e.checkArgs(arguments)(d.Instance(t),d.PlainObject.optional(),d.Object({userFlags:d.Object({generalSizeAdviceEnabled:d.Boolean,isShoppingForSelf:d.Boolean})}),d.PlainObject,d.String,d.Array),d.PlainObject.test(a)){var E,_,I,b,A,R,T,L,x,B,j,V,Z,G,W,k,H,K,X=this,q=X.context,J=s.messages;E=u(n.data(M),a,s),n.data(M,E),L=s.userFlags,x=L.generalSizeAdviceEnabled,j=a.gsa,V=j&&j.overall,Z=j&&j.brand,G=E===v.BrandAdvice?Z:V,B=!!G,W=null===a.category?"":"tfc-"+a.category,k=null===a.sellingSizeStep?"":"tfc-"+a.sellingSizeStep,H=[W,k].join(" "),K=Y("."+C+".tfc-secure",n),I=q.tipConfig.placement,_=S("secure-tip"),b=S("insecure-tip"),T=l(n,a,o),n.data(w,T),A=X.templates[E],R=_[0]+b[0],n.contents().not(".tfc-tip-result").remove(),0===K.length&&n.append(R),n[I===m.Below?"prepend":"append"](P.evalTemplate(A)),X._renderResultCommon(n,c,H,s),E===v.AnonymousNotRecommended||E===v.AnonymousRecommended||E===v.NotRecommended||E===v.Recommended?(P.animateFitScore(n,a.score,300,J,s.legacyMessages),Y(".tfc-size",n).text(a.size)):E===v.RecommendedGarmentUserSizeOnly||E===v.RecommendedGarmentSizeOnly||E===v.RecommendedUserSizeOnly||E===v.RecommendedDepartmentSizeOnly?Y(".tfc-size",n).text(a.size):E===v.EstimationInProgress&&(p.push(n),Y("."+h,n).bind("click",function(){i(n,!1)})),r(n).toggleClass(N,x).toggleClass(z,!x).toggleClass(F,B).toggleClass(U,!B),t("."+y+"."+O,r(n)).toggleClass(D,B),B&&r(n).addClass("tfc-"+G.advice),B&&G===V&&Y(".tfc-gsa-style-count",r(n)).text(G.styleCount),B&&G===Z&&Y(".tfc-gsa-brand",r(n)).text(G.brandName),q.hoverTooltipsEnabled||(t(".tfc-cfg-close-button").removeAttr("title"),t(".tfc-popup-click-open").removeAttr("title")),X._initTip(n,c),X.event(a.status,T)}},_afterLaunchTip:function(t,e,r){(!e.hasIframe()||r.ips&&r.ips===p.IPS.FitDetails)&&this.event(I,t.data(w))}},e.widget.WidgetWithTips)}(tfcJQuery,TFCApp);
"use strict";!function(t,e){function n(t,e){t.contents().remove(),t.html(r.evalTemplate(e))}var i="render",r=e.FitRecUtil,a=e.Constants.Attributes;e.widget({className:"FitAccount",widgetName:"tfc-fitrec-account",postCall:function(e){var r,a=this,s=a.getNodes(),c=e.status;a._super(e),s.each(function(e,n){a._initTip(t(n))}),r=a.templates[c],s.each(function(){n(t(this),r)}),a.event(i,{widgets:s.get(),response:e}),this.context.integrationManager.widgetComplete(s.get(0).scrollHeight)},_getProfileParams:function(t){var e=t.attr(a.FIRST_NAME),n=t.attr(a.GENDER),i=t.attr(a.STORE_REGISTERED),r=t.attr(a.ALT_USER_ID),s=t.attr(a.WIDGET_HIDDEN),c=t.attr(a.STORE_EXPERIMENT_KEY);return{firstName:e,gender:n,registered:i,alternateUserId:r,widgetHidden:s,storeExperimentKey:c}},_alwaysLaunchModal:function(){return!0},_alwaysLaunchSecureTip:function(){return!0}},e.widget.WidgetWithTips)}(tfcJQuery,TFCApp);
"use strict";!function(e,t){function r(e,t){return h[e]&&h[e][t]}var a=e.Constants,i=a.Attributes,o=a.RequestParameter,n=e.FitRecUtil,s=e.util,c=e.Modal,l=e.utility.Http,u=e.utility.Logger.getLogger("FitProfile"),d=s.addParamIfNonZeroLengthString,p=e.FitRecResponse,g="body",f="tfc-modal-backdrop",S={Close:"close",Complete:"complete",LogOut:"logout",Open:"open",PageLoad:"pageload",Render:"render",Update:"update",AddToBag:"addtobag",Chat:"chat",SizeChart:"sizechart"},h={Female:{Adult:"Womens",Child:"Girls"},Male:{Adult:"Mens",Child:"Boys"}};e.widget({className:"FitProfile",widgetName:"tfc-fitrec-register",$loadingTemplate:null,scrollTop:0,heightToggleIntervalId:void 0,$modals:null,modals:null,onFitCallResponse:function(e){var t=this;t._super(e),e.extraClasses&&s.each(t.modals,function(t,r){r.decorateElement(e.extraClasses.join(" "))})},preCall:function(){var r=this,a=r.context,n=r._super();if(a.shopMySizeEnabled){var s=void 0,c=r.getNodes();c.length>0&&(c.each(function(){var e=t(this),r=e.attr(i.STORE_CATEGORY);s?s!==r&&u.error("Different store categories seen in the same iframe ["+s+", "+r+"]"):s=r}),s!==r._storeCategory&&(r._storeCategory=s,r._shopMySizeApiCall("store-category","hierarchyinfo",r._storeCategorySuccess),r._scaledSizesApiCall(),a.integrationManager.setTfcIframeUpdateCallback(e.bind(r._scaledSizesApiCall,r))),d(n,o.StoreCategory,r._storeCategory))}else{var l=r.getNodes();1===l.length&&l.each(function(){var e=t(this);d(n,o.Gender,e.attr(i.GENDER)),d(n,o.AgeGroup,e.attr(i.AGE_GROUP)),d(n,o.Category,e.attr(i.CATEGORY))})}return n},postCall:function(e){var r,a=this;a._super(e),r=a.getNodes(),r.each(function(e,r){a._initTip(t(r))}),a.event(S.Render,{widgets:r.get(),response:e}),this.context.integrationManager.widgetComplete(0)},setTemplates:function(e){function r(e){var t,r,o,s=i.$modals;return s||(i.$modals=s={}),s[e]=t=n.evalTemplate(i.templates[e+"-modal"]),o=e+"-tip",a[e]=r=c.fromTemplate(t,o,i.context.fullScreenPopupZoomEnabled),r.placeOnPage(),r}var a,i=this,o=i.context.responsiveManager;i._super(e),i.modals||(i.modals=a={},t(g).append(n.evalTemplate(i.templates["modal-backdrop"])),t("."+f).bind("click",s.noop),r("secure"),r("insecure"),s.each(a,function(e,t){t.updateScreenSize(o.currentScreenSize())}),o.subscribeToScreenSizeChange(function(e){s.each(a,function(t,r){r.updateScreenSize(e)})}))},_constructor:function(t){var r=this;r._super(t),t.fireFitrecRegisterScaledSizes=t.shopMySizeEnabled?e.bind(r._scaledSizesApiCall,r):function(){},t.fireFitrecRegisterEvent=e.bind(r.event,r),t.getModal=function(e){var t=r.modals;return"secure-tip"===e?t.secure:t.insecure}},_getProfileParams:function(e){var t=this,o=e.attr(i.AGE_GROUP),n=e.attr(i.GENDER),s=r(n,o);return{firstName:e.attr(i.FIRST_NAME),gender:n,registered:e.attr(i.STORE_REGISTERED),alternateUserId:e.attr(i.ALT_USER_ID),sourceTrigger:a.SourceTrigger.Banner,department:s||t._department,productType:e.attr(i.CATEGORY)||t._productType,widgetHidden:e.attr(i.WIDGET_HIDDEN),storeExperimentKey:e.attr(i.STORE_EXPERIMENT_KEY)}},_alwaysLaunchModal:function(){return!0},_alwaysLaunchSecureTip:function(){return!0},_widgetClickOpen:function(){return!0},_shopMySizeApiCall:function(t,r,a){var i=this,n=i.getNodes();if(n.length>0){var s=i.context,c=p.getStoreUserId(),u=p.getSessionContext(),g=e.cookieHelper.userToken(),f={};d(f,o.ServiceMode,s.serviceMode),d(f,o.UserId,c),d(f,o.SessionContext,u);var S={responseType:"json",userToken:g,withCredentials:!0,queryParameters:f,serviceSecureUrl:s.serviceSecureURI+"/consumer/ui/"+s.storeKey+"/shop-my-size/"+t,success:e.bind(a,i),failure:e.bind(i._shopMySizeHttpFailure,i,r)};i._storeCategory&&(S.serviceSecureUrl=S.serviceSecureUrl+"/"+encodeURIComponent(i._storeCategory)),l.get(S)}},_shopMySizeHttpFailure:function(e,t){u.error("Failed to get "+e+" for the given category [category: "+this._storeCategory+", http status: "+t.status+"]")},_storeCategorySuccess:function(e){var t=this,r=e.data;r?(t._department=r.department,t._productType=r.productType,t.event("hierarchyinfo",{recommendable:r.recommendable})):u.info("No content was returned for hierarchyinfo [category: "+t._storeCategory+"]")},_scaledSizesApiCall:function(){var t=this,r=e.bind(t._tryScaledSizesApiCall,t),a=e.bind(t._scaledSizesSuccess,t),i=e.bind(t._scaledSizesFailure,t);s.retry(r,a,i,"consistentInterval",1e3)},_tryScaledSizesApiCall:function(e,t){function r(r){a._scaledSizesHttpSuccess(r,e,t)}var a=this;a._shopMySizeApiCall("scaled-sizes","userinfo",r)},_scaledSizesHttpSuccess:function(e,t,r){var a=this,i=e.data;i?i.estimationInProgress?r():t(i):u.info("No content was returned for userinfo [category: "+a._storeCategory+"]")},_scaledSizesSuccess:function(e){function t(e){return"normalizedSizes"!==e}var r=this;r.event("userinfo",{isUserAvailable:e.isUserAvailable,normalizedSizes:e.normalizedSizes},t)},_scaledSizesFailure:function(){var e=this;u.error("Unable to obtain userinfo because user estimation took too long [category: "+e._storeCategory+"]")},_storeCategory:null,_department:null,_productType:null},e.widget.WidgetWithTips)}(TFCApp,tfcJQuery);
"use strict";!function(t){t.widget({className:"FitRecsCatalog",widgetName:"tfc-fitrec-catalog"},t.widget.FitRecs)}(TFCApp);
"use strict";!function(t){t.widget({className:"FitRecsProduct",widgetName:"tfc-fitrec-product"},t.widget.FitRecs)}(TFCApp);
"use strict";!function(e){var t=e.Constants,r=t.Attributes,o=t.RequestParameter,i=t.IntegrationPlatform,a=t.Header,n=e.type,d=e.util,c=e.utility.Http,s=e.tokenHelper,l=e.utility.Logger.getLogger("OrderNotify");e.widget({className:"OrderNotify",widgetName:"tfc-order-notify",isVisible:!1,usesAlternativeCalculate:!0,_supportedAttrs:function(){return this._super().concat([r.ORDER_ID])},expectedUpdateTypes:function(){var e=this._super();return e.orderId=n.String.optional(),e},alternativeCalculate:function(t,r,n,u){var f=new e.DeviceResolver(n),p=this.preCall(),h={},g={},y={},m=d.headVal(p[o.OrderId]);m?(y.orderId=m,y.deviceType=f.get(),y.integrationPlatform=i.Web,y.widgetHidden="true"===d.headVal(p[o.WidgetHidden]),y.storeExperimentKey=d.headVal(p[o.StoreExperimentKey]),y.checkoutType="OrderNotify",d.addParamIfNonZeroLengthString(h,o.Locale,d.headVal(p[o.Locale])),d.addParamIfNonZeroLengthString(g,a.StoreUserId,d.headVal(p[o.UserId])),s.withToken(function(){d.retry(function(o,i){var n=e.cookieHelper.userToken(),s=null===n?void 0:n;d.addParamIfNonZeroLengthString(g,a.UserToken,s),c.post({serviceSecureUrl:t+"/profile/public/v2/"+r+"/checkout",withCredentials:!0,queryParameters:h,headers:g,data:y,success:o,failure:i})},function(){l.info("Order Notify checkout was successful"),u()},function(){l.error("Order Notify checkout failed"),u()})},t,r,"Unable to complete the order notify checkout",u)):u()}})}(TFCApp);
"use strict";!function(e,t){var s=t.extLibs;t.widget({className:"SetUserId",widgetName:"tfc-set-userid",isVisible:!1,postCall:function(e){this._super(e),this.event("render",{widgets:s("."+this.widgetName).get(),response:e})}})}(tfcJQuery,TFCApp);
"use strict";!function(e,n){function r(){var e,n,r,t,a=document.getElementsByTagName("script"),i="",o={};for(n=0;n<a.length;++n)if(e=a[n].src,/fitrec(-[^\.]+)?\.js/.test(e)){i=e;break}for(r=(i.split("?",2)[1]||"").split("&"),n=0;n<r.length;++n)t=r[n].split("=",2),2===t.length&&(o[t[0]]=t[1]);return o}var t=n.manager,a=n.util,i=n.utility,o=i.StorageFactory,g=n.analytics,s=n.ReadyStateHelper,c=i.Logger.getLogger("TFCDomReady"),f=i.FitrecContext,d=window.tfc.configuration,l=i.StorageFactory.cookieBased(d.cookieCfg),m=new(n.chooseIntegration(t.StandardIntegrationManager,t.IframeIntegrationManager))(window.parent,d.iframeConfig,i.FitrecContext.parentOrigin);n.storage=n.chooseIntegration(function(){return l},function(){return o.messageBased({messageManager:m.messageManager()},i.FitrecContext)})(),n.extLibs.domready(function(){var e=l.enabled(),t=d.iframeConfig&&d.iframeConfig.firstPartyStorageEnabled,o=t||e;if(f.isIframeIntegration&&!o)return void c.info("Fit recommendations disabled - Integration is iframe based, but there is no way to store the user data[1st party: "+t+", 3rd Party: "+e+"]");var p=new n.UserSettings(d.userSettingsCookieEnabled),u=new n.FitRecCookieHelper(p);d.clientToServerLogging&&i.Logger.registerLoggingEngine(new i.HttpLoggerEngine(d.clientToServerLogging,u));var w,y,C=d.responsiveManager=new n.manager.ResponsiveManager(d.profileDeviceType),S=d.analyticsManager=new g.AnalyticsManager,v=d.experiments||[];d.shimQueryParams||(d.shimQueryParams=r()),d.integrationManager=m,d.profileMessageBroadcaster=new n.manager.ProfileMessageBroadcaster,C.subscribeToScreenSizeChange(function(e){d.profileMessageBroadcaster.broadcastScreenSizeChange(e)}),n.cookieHelper=u,window.tfc=y=new n.FitRecService(d,p),n.tfcapiSetup(d.legacyEventApiEnabled),w=n.experiment=new g.WidgetABTest(v),a.each(w.getEngines(),function(e,n){S.addEngine(n)}),m.init(),n.performanceTracker=new n.PerformanceTracker(window,d),s.addCompleteListener(function(){m.documentComplete()},1e3,10),y.__calculate(void 0,{initialCall:!0})})}(tfcJQuery,TFCApp);