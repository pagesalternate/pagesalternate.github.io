(function(c){c.fn.initImageGallery=function(u){this.each(function(){function a(){var a=0,b=0;g.find("img.wc-ig-image").each(function(){var d=parseInt(c(this).attr("data-set-height")),f=parseInt(c(this).attr("data-set-width"));a<d&&(a=d,b=f)});return Math.max(a,.45*b)}function B(a,b,d,f,c){var l=a.attr("data-width"),e=a.attr("data-height");c=c>l?l:c;f=f>e?e:f;b>d?(d=Math.floor(c),e=Math.floor(c/b)):(e=Math.floor(f),d=Math.floor(f*b));a.css({"max-width":d,width:d});a.css({"max-height":e,height:e});
a.attr({"data-set-width":d});a.attr({"data-set-height":e})}function D(a,b){for(var d=a.sources[0],f=1;f<a.sources.length;f++){var c=parseInt(a.sources[f].width,10);d=b>c?d:a.sources[f]}return d}function z(a){var b={};h.plugin||(b.interactive="image-gallery-image-view"!==a,b["tab-caption"]=h.tabCaption,b["section-type"]=h.sectionType,b["asset-type"]="image",b["asset-wrapper"]="image-gallery",b["asset-title"]=k[m].caption,b.asset=k[m].src.src,b["index-in-collection"]=k[m].index,b["collection-size"]=
k[m].rawSectionMetadata.collectionSize,b["index-in-collection-absolute"]=m.toString(),b["collection-size-absolute"]=k.length,h.reportEvent(a,k[m].rawSectionMetadata,b))}function n(){return m}var d=c("<div class='wc-mosaic-board-image-gallery'></div>"),g=c("<div class='wc-ig-viewer'></div>"),b=c('<img src="" class="wc-ig-image" alt=""/>'),f=c('<div class="wc-ig-navigation-controls makeVisible"><button type="button" class="wc-nav-prev disabled" data-slide-to="prev" disabled="true" aria-label="'+u.ariaLabelPrev+
'"><i class="icon-angle-left"></i></button><button type="button" class="wc-nav-next" data-slide-to="next" aria-label="'+u.ariaLabelNext+'"><i class="icon-angle-right"></i></button></div>'),l=c('<div class="wc-ig-bottom-navigation-spots makeVisible"><ul></ul></div>'),e=c('<div class="wc-ig-description-container wc-toggle-title-desc-hide makeVisible"></div>'),w=c("<h3></h3>"),C=c("<p></p>"),H=c("<div class='wc-ig-description-unit' data-place-desc ><div class='wc-ig-description-caption' tabindex='0'></div><div class='wc-ig-description-text'></div></div>"),
q=c('<button aria-label="'+u.commonTexts.showDescription+'" aria-live="polite" type="button" class="toggleDesription"><i class="icon-angle-down-flat"></i></button>'),t,E=!1,r=!1,F=0,m=0,G=0,A=c(this),k=u.jsonData.medias,h=c.extend(!0,{},c.fn.initImageGallery.defaults,u||{});(function(){function a(){function a(a){h.touchStartTime=new Date;h.touchstartX=a.originalEvent.targetTouches[0].pageX}function b(a){var b=a.originalEvent.changedTouches[0].pageX,d=new Date;b<h.touchstartX&&80<h.touchstartX-b&&
250>d-h.touchStartTime?k(a,"next"):b>h.touchstartX&&80<b-h.touchstartX&&250>d-h.touchStartTime&&k(a,"prev")}function k(a,b){a=!0;var p=new Date;if(!(h.time&&100>p-h.time)){p=c(this).attr("data-slide-to");var k=parseInt(c(this).attr("data-place-spot"));b&&(p=b);p?(z("prev"===p?"image-gallery-previous":"image-gallery-next"),a=!1,d.trigger("reportNextPrev",p),"prev"===p?0===m?m=0:m--:m===G-1?m=G-1:m++):(m=k,z("image-gallery-image-selection"));z("image-gallery-image-view");m===G-1?(f.find("button.wc-nav-next").addClass("disabled").attr("disabled",
"true"),f.find("button.wc-nav-prev").removeClass("disabled").removeAttr("disabled")):0===m?(f.find("button.wc-nav-prev").addClass("disabled").attr("disabled","true"),f.find("button.wc-nav-next").removeClass("disabled").removeAttr("disabled")):f.find("button").removeClass("disabled").removeAttr("disabled");e.find(".selected").removeAttr("style").removeClass("selected");c(e.find(".wc-ig-description-unit")[m]).addClass("selected");0===c(e.find(".wc-ig-description-unit")[m]).find("p").length&&0===c(e.find(".wc-ig-description-unit")[m]).find(".wc-ig-description-caption h3").length?
(E=!1,q.hide()):(E=!0,r||q.show(),c(e.find(".wc-ig-description-unit")[m]).hasClass("wc-no-caption-style")?q.addClass("no-opacity"):q.removeClass("no-opacity"));g.find("img.selected").removeClass("selected");c(g.find("img")[m]).addClass("selected");l.find("button.selected").removeClass("selected");c(l.find("button")[m]).addClass("selected");g.trigger("postLoadImage",{isInteractive:a});F=m;n(m)}}(h.isTouchDevice||1<navigator.maxTouchPoints)&&!h.preventChangeSlideOnSwipe&&(d.on("touchstart",a),d.on("touchend",
b));f.find("button").bind("click",k);l.find("button").bind("click",k)}function n(a){g.css("background-color",k[a]["background-color"]?k[a]["background-color"]:"#fff")}(function(){for(var a=A.width()/A.height(),f=A.width(),m=A.height(),p=0;p<k.length;p++){var v=D(!0===h.isMultipleImages?k[p].medias[0]:k[p],"960"),x=b.clone(!1),t=0===p?"selected":"",y=v.width/v.height;x.addClass(t);x.attr({"data-ratio":y});x.attr({"data-width":v.width,"data-height":v.height});B(x,y,a,m,f);h.isMobile||(0>y||m-.3*m<v.height?
x.addClass("h-gt-w"):x.addClass("w-gt-h"));y=k[p].caption;x.attr("src",v.src).attr("alt",y).attr("data-place-image",p);g.append(x);v=h.ariaLabelViewOf.replace("%0",y).replace("%1",p+1).replace("%2",k.length);l.find("ul").append('<li class="wc-nav-spot"><button type="button" class="wc-nav-spot-button '+t+'" data-place-spot="'+p+'" aria-label="'+v+'"><i class="wc-spot-circle"></i></button></li>');v=H.clone();v.addClass(t);v.attr("data-place-desc",p);t=!1;if(k[p].caption&&k[p].caption!==h.iGTexts.defaultImageCaption&&
null===k[p].caption.match(/View\s\d+/)){t=!0;y=w.clone();var r=c("<span>").html(k[p].caption).text();r=r.replace('"',"'");y[0].innerText=r;v.addClass("wc-no-slider-padding");v.find(".wc-ig-description-caption").append(y);k[p].description||k[p].richDescription||v.addClass("wc-no-description-style")}if(k[p].description||k[p].richDescription)y=C.clone(),k[p].richDescription?(y.html(k[p].richDescription),r=y.find("markup\\:footnote"),0<r.length&&r.each(function(a){var b=c(this).text();b=b.replace(/\s+/ig,
" ").replace(/^\s|\s$/,"");c("body").hasClass("wc-mb-browser-ios")?c(this).replaceWith('<sup class="footnote" role="note" data-index="'+(a+1)+'" data-content="'+b+'" aria-label="'+u.rfTexts.footnote+" "+(a+1)+" "+b+'">'+(a+1)+"</sup>"):c(this).replaceWith('<sup class="footnote" data-index="'+(a+1)+'" data-content="'+b+'" aria-label="'+u.rfTexts.footnote+" "+(a+1)+" "+b+'">'+(a+1)+'<span class="hidden">Footnote: '+b+"</span></sup>")})):(r=c("<span>").html(k[p].description).text(),r=r.replace('"',"'"),
y[0].innerText=r),t||v.addClass("wc-no-caption-style"),v.find(".wc-ig-description-text").append(y);h.capDescOpenByDefault&&(e.removeClass("wc-toggle-title-desc-hide").addClass("wc-toggle-title-desc-show"),q.find("i").removeClass("icon-angle-down-flat").addClass("icon-angle-up-flat"));e.append(v);G++;n(0)}c(window).on("resize",function(){if(d.closest(".wc-iframe-content").hasClass("active")){var a=A.height();g.find("img").each(function(){x=c(this);x.removeClass("h-gt-w").removeClass("w-gt-h");h.isMobile||
(0>parseInt(x.attr("data-ratio"))||a-.3*a<parseInt(x.attr("data-height"))?x.addClass("h-gt-w"):x.addClass("w-gt-h"))})}});d.append(e);d.append(g);d.find(".wc-ig-description-container").append(q);A.append(d);0===c(e.find(".wc-ig-description-unit")[0]).find("p").length&&0===c(e.find(".wc-ig-description-unit")[0]).find(".wc-ig-description-caption h3").length?(E=!1,q.hide()):(E=!0,q.show());h.isCustomScrollBarConfiguration||c(e.find(".wc-ig-description-text")).mCustomScrollbar({theme:"dark",scrollInertia:700,
mouseWheel:{scrollAmount:1E3}});z("image-gallery-image-view")})();1<k.length&&(h.isTouchDevice&&!h.shouldDisplayNavigationOnMobile||d.append(f),d.append(l),a())})();(function(){function b(){if(d.closest(".wc-iframe-content").hasClass("active")){var a=A.width()/A.height(),b=A.width(),f=A.height();c(g.find("img")).each(function(){var d=c(this),l=d.attr("data-ratio");B(d,l,a,f,b)})}}function k(a){if(d.closest("body").hasClass("wc-no-focus")&&!h.isMobile||a)f.addClass("makeUnvisible"),d.find(".wc-ig-description-container, .wc-mg-ac-ts").addClass("makeUnvisible"),
h.isMobile||d.find(".mCSB_draggerContainer").addClass("makeUnvisible"),E&&q.addClass("makeUnvisible"),r&&l.addClass("makeUnvisible")}function w(){r||(f.removeClass("makeUnvisible"),d.find(".wc-ig-description-container, .wc-mg-ac-ts, .mCSB_draggerContainer").removeClass("makeUnvisible"),E&&q.removeClass("makeUnvisible"),r||l.removeClass("makeUnvisible"))}function C(){return d.find("button.toggleDesription").find("i").hasClass("icon-angle-up-flat")}function n(){clearTimeout(void 0);C()?(d.find("button.toggleDesription").attr("aria-label",
u.commonTexts.showDescription),d.find("button.toggleDesription").find("i").attr("class","icon-angle-down-flat"),e.find(".mCSB_draggerContainer").css({display:"none",top:0}),e.find(".wc-ig-description-unit.selected").slideUp(function(){e.removeClass("wc-toggle-title-desc-show").addClass("wc-toggle-title-desc-hide")}),e.find(".wc-ig-description-unit.selected").hasClass("wc-no-caption-style")?q.addClass("no-opacity"):q.removeClass("no-opacity")):(d.find("button.toggleDesription").attr("aria-label",u.commonTexts.hideDescription),
d.find("button.toggleDesription").find("i").attr("class","icon-angle-up-flat"),e.find(".mCSB_draggerContainer").css({display:"none",top:0}),q.removeClass("no-opacity"),e.find(".wc-ig-description-unit.selected").slideDown(function(){var a=this;setTimeout(function(){var b=c(a).closest(".wc-ig-description-unit");b.find(".mCSB_draggerContainer").css({display:"block"});b.hasClass("wc-no-caption-style")&&b.find(".mCSB_draggerContainer").css({top:"32px"});e.removeClass("wc-toggle-title-desc-hide").addClass("wc-toggle-title-desc-show")},
100,a)}))}t=setTimeout(k,4E3);c("body").on("onActiveContent",function(f,c){d.closest(".wc-iframe-content").hasClass("active")&&(w(),F===m&&c||(z("image-gallery-image-view"),F=m),b(),"rich-features"!==h.sectionType&&h.resizeHeight(a()),t=setTimeout(k,4E3))});q.bind("click",function(){z(C()?"image-gallery-hide-description":"image-gallery-show-description");n()});d.mouseleave(function(){clearTimeout(t);t=setTimeout(function(){k()},1E3)});d.mousemove(function(){clearTimeout(t);w();t=setTimeout(function(){k()},
4E3)});d.bind("keydown",function(a){9===(a.keyCode||a.which)&&(clearTimeout(t),w())});c("body").on("pause-movie",function(){F=null});h.isMobile&&(d.addClass("wc-mosaic-board-image-gallery-mobile").addClass("first-time-animation-null"),d.bind("tap",function(a){h.time&&100>new Date-h.time||"sup"===a.target.localName||"button"===a.target.localName||0<c(a.target).closest("button").length||(d.removeClass("first-time-animation-null"),r=!r,h.mobileFullScreenMod(r),d.removeClass("wc-is-full-screen-"+!r).addClass("wc-is-full-screen-"+
r),h.time=new Date,k(r))}));c(window).resize(function(){d.closest(".wc-iframe-content").hasClass("active")&&(b(),h.shouldResizeByAssetsOnly&&h.shouldAutoResizeHeight&&!h.isMobile&&"rich-features"!==h.sectionType&&h.resizeHeight(a()))})})();"rich-features"!==h.sectionType&&h.resizeHeight(a());h.plugin&&(h.$mainContainer=d,h.$viewer=g,h.jsonData=k,h.findProfileImage=D,h.selectedImage=n,c.fn[h.plugin].apply(d,[h]))})};c.fn.initImageGallery.defaults={isMobile:!1,isTouchDevice:!1};c.fn.initRichFeatures=
function(u){c(this).each(function(){var a=c.extend(!0,{},c.fn.initRichFeatures.defaults,u||{}),B,D=!0,z=!1,n={init:function(){n._cleanIG();n._appendListeners();n._resizeHeight();n._loadView(0);z=n._isAllFeaturesImageBanner()},_cleanIG:function(){a.$mainContainer.addClass("wc-mosaic-board-rf");a.$mainContainer.append('<div class="footnote-box"></div>');a.$mainContainer.find(".toggleDesription").remove();a.$viewer.append('<div class="wc-rf-banner-box-outer"><div class="wc-rf-banner-box-inner"><div class="wc-rf-banner-box-table"><div class="wc-rf-banner-box-cell"><div class="wc-rf-banner-box"><h3 class="wc-rich-content-header wc-feature-main-header"></h3><div class="wc-rich-content-description"></div></div></div></div></div></div>');
a.$mainContainer.find(".wc-rf-view-desc-container, .wc-ig-description-container").wrapAll('<div class="wc-rf-view-desc-container"></div>');a.isMobile&&a.$mainContainer.addClass("wc-rf-mobile")},_appendListeners:function(){var d=this;a.$viewer.on("postLoadImage",function(d,b){n._loadView(a.$viewer.find("img.selected").index(),void 0,b)});c(window).on("resize",function(){a.$mainContainer.closest(".wc-iframe-content").hasClass("active")&&(n._resizeHeight(),n._loadView(a.$viewer.find("img.selected").index()))});
window.addEventListener("orientationchange",function(){a.$mainContainer.closest(".wc-iframe-content").hasClass("active")&&n._loadView(a.$viewer.find("img.selected").index())});c("body").on("onActiveContent",function(d,b){a.$mainContainer.closest(".wc-iframe-content").hasClass("active")&&(n._resizeHeight(),n._loadView(a.$viewer.find("img.selected").index(),b))});c("body").on("pause-movie",function(){B=null});a.$mainContainer.on("reportNextPrev",function(a,b){d._sendReportingEvent("prev"===b?"feature-sets-previous":
"feature-sets-next")});a.$mainContainer.on("tap",".footnote",function(){a.$mainContainer.find(".footnote-box").hasClass("show")?a.$mainContainer.find(".footnote-box").removeClass("show"):d._callFootnote(c(this))}).on("mouseover",".footnote",function(){a.isMobile||d._callFootnote(c(this))}).on("mouseout",".footnote",function(){a.isMobile||a.$mainContainer.find(".footnote-box").removeClass("show")})},_callFootnote:function(d){var c=d.attr("data-index");d=d.attr("data-content");a.$mainContainer.find(".footnote-box").html("<sup>"+
c+"</sup> "+d).addClass("show");D&&(this._sendReportingEvent("feature-sets-show-footnote"),D=!1)},_loadView:function(d,c,b){if(a.$mainContainer.closest(".wc-iframe-content").hasClass("active")){a.$mainContainer.children(".wc-rf-view-desc-container").removeAttr("style");a.$mainContainer.find(".footnote-box").removeClass("show");a.$mainContainer.css("height",window.innerHeight+"px");(B!==d||"undefined"!==typeof c&&!1===c)&&this._sendReportingEvent("feature-sets-selection",b);B=d;a.$mainContainer.removeClass(function(a,
b){return(b.match(/(^|\s)wc\-mosaic\-board\-rf\S+/g)||[]).join(" ")});a.$mainContainer.find(".wc-ig-description-container, .wc-ig-description-unit, .wc-ig-viewer").removeAttr("style");c=a.jsonData[d];b=c.orientation;var f=c.boxLocation;a.$viewer.find(".wc-rf-banner-box-outer").css("display","none");c.richDescription||c.caption?(a.isMobile&&window.innerWidth<window.innerHeight?this._otherView(d,"bottom"):a.isMobile&&"banner-image"===b&&f&&window.innerWidth>window.innerHeight?this._otherView(d):"banner-image"===
b&&f?this._bannerView(d):this._otherView(d),D=!0):a.$mainContainer.addClass("wc-mosaic-board-rf-no-text")}},_bannerView:function(d){var g=a.$viewer.find("img.selected"),b=a.jsonData[d],f=b.boxLocation,l=a.$viewer.find(".wc-rf-banner-box-outer"),e=window.innerWidth;l.removeClass(function(a,b){return(b.match(/(^|\s)wc\-mosaic\-board\-rf\S+/g)||[]).join(" ")});if("below"===f)l.css("display","none"),a.$mainContainer.removeClass("wc-mosaic-board-rf-banner-full-width"),b.boxColor&&a.$mainContainer.addClass("wc-mosaic-board-rf-bg-color-"+
b.boxColor),this._otherView(d,"bottom");else{(b.richDescription||b.caption)&&l.css("display","block");a.$mainContainer.addClass("wc-mosaic-board-rf-banner").addClass("wc-mosaic-board-rf-banner-full-width");var w=c("<span>").html(b.caption).text();w=w.replace('"',"'");a.$mainContainer.find(".wc-feature-main-header")[0].innerText=w;a.$mainContainer.find(".wc-rich-content-description").html(a.$mainContainer.find(".wc-ig-description-unit.selected .wc-ig-description-text").html());l.css({width:g.width()>=
e?e:g.width()}).addClass("wc-mosaic-board-rf-box-location-"+f);b.boxColor&&l.addClass("wc-mosaic-board-rf-bg-color-"+b.boxColor);f=a.$mainContainer.find(".wc-rf-banner-box");g.height()<f.outerHeight()+30&&(l.css("display","none"),a.$mainContainer.removeClass("wc-mosaic-board-rf-banner-full-width"),this._otherView(d,"bottom"),b.boxColor&&a.$mainContainer.addClass("wc-mosaic-board-rf-bg-color-"+b.boxColor))}},_otherView:function(d,c){var b=a.$viewer.find("img.selected"),f=a.jsonData[d];d=parseInt(b.attr("data-set-width"));
var l=parseInt(b.attr("data-set-height")),e=window.innerWidth,g=window.innerHeight;f=f.orientation;var C=Math.floor(d/l*Math.min(l,.6*g)),n=Math.min(d,Math.floor(.6*e));"bottom"===c||C>n?(a.$mainContainer.addClass("wc-mosaic-board-rf-full-aligned"),a.$mainContainer.find(".wc-ig-description-container").before(a.$mainContainer.find(".wc-ig-viewer")),this._calcProportionsForBottomDisplay(l,g)):(a.$mainContainer.addClass("wc-mosaic-board-rf-"+("left-aligned"===f?"left-aligned":"right-aligned")),a.$mainContainer.find(".wc-ig-description-container").after(a.$mainContainer.find(".wc-ig-viewer")),
this._calcProportionsForSideDisplay(d,e,g,b));a.$mainContainer.find(".no-scroll").removeClass("no-scroll");a.$mainContainer.find(".wc-ig-description-container .selected").mCustomScrollbar("destroy");a.$mainContainer.find(".wc-ig-description-container .selected").mCustomScrollbar({theme:"dark",scrollInertia:700,setHeight:!1,mouseWheel:{scrollAmount:1E3},callbacks:{onOverflowYNone:function(){a.$mainContainer.find(".mCS_no_scrollbar_y").parent().addClass("no-scroll")}}})},_calcProportionsForBottomDisplay:function(d,
c){c=c-30-10;d=Math.min(d,.6*c);a.isMobile&&(d=Math.max(d,.4*c));c-=d;a.$viewer.css("max-height",d+"px");var b=a.$viewer.find(".selected"),f=b.attr("data-set-height"),l=b.attr("data-set-width");b.css({"max-height":d,"max-width":l/f*d});a.$mainContainer.find(".wc-ig-description-container").css({"max-height":c+"px","max-width":"960px"});a.$mainContainer.find(".wc-ig-description-container .selected").css("max-height",c+"px")},_calcProportionsForSideDisplay:function(d,g,b,f){var l=a.isMobile?10:30;g=
g-l-20;var e=Math.floor(Math.min(d,.6*g)),w=Math.min(Math.floor(g-e),800),C=a.isMobile?250:180;w<C&&(w=C,e=g-w);a.$viewer.css("max-width",e+"px");a.$mainContainer.find(".wc-ig-description-container").css({"max-width":w});a.$mainContainer.find(".wc-ig-description-container .selected").css({"max-height":b-60,"max-width":w});!a.isMobile&&c("body").hasClass("wc-fullscreen")&&a.$mainContainer.children(".wc-rf-view-desc-container").css("max-width",e+w+3*l);d>e?f.css({width:"100%",height:"auto"}):f.css({width:f.attr("data-width")+
"px",height:f.attr("data-height")+"px"})},_resizeHeight:function(){!a.isMobile&&a.shouldAutoResizeHeight&&a.resizeHeight(n._getTallestHeight())},_getTallestHeight:function(){var d=0;if(z){var g=0;a.$viewer.find("img.wc-ig-image").each(function(){var a=parseInt(c(this).attr("data-set-height"));g<a&&(g=a)});d=850>window.innerWidth?g+.5*g+30+10:g}else{var b=a.$viewer.find("img"),f=window.innerWidth,l=window.innerHeight;b.each(function(b){var e=parseInt(c(this).attr("data-set-width"));var g=parseInt(c(this).attr("data-set-height"));
b=a.jsonData[b];var n=b.orientation,q=b.boxLocation,t=Math.floor(e/g*Math.min(g,.6*l));e=Math.min(e,Math.floor(.6*f));g=b.richDescription||b.caption?"banner-image"===n&&"below"!==q?850>window.innerWidth?g+.5*g+30+10:g:"banner-image"===n&&"below"===q||t>e?g+.5*g+30+10:g:g;g>d&&(d=g)})}return Math.min(600,d)},_isAllFeaturesImageBanner:function(){for(var c=!0,g=0;g<a.jsonData.length;g++)if("banner-image"!==a.jsonData[g].orientation||"below"===a.jsonData[g].boxLocation){c=!1;break}return c},_sendReportingEvent:function(c,
g){var b={},d=a.selectedImage();b.interactive="undefined"!==typeof g?g.isInteractive:!0;b["section-type"]=a.sectionType;b["tab-caption"]=a.tabCaption;b["asset-title"]=a.jsonData[d].caption;b["index-in-collection"]=a.jsonData[d].index;b["collection-size"]=a.jsonData[d].rawSectionMetadata.collectionSize;b["index-in-collection-absolute"]=d.toString();b["collection-size-absolute"]=a.jsonData.length;a.reportEvent(c,a.jsonData[d].rawSectionMetadata,b)}};n.init()})};c.fn.initThreeSixty=function(u){c(this).each(function(){var a=
c.extend(!0,{},c.fn.initThreeSixty.defaults,u||{});a.instance=(new Date).getTime();var B=u.tsTexts.play,D=u.tsTexts.pause,z=u.tsTexts.rotateClockwiseDegrees,n=u.tsTexts.rotateCounterClockwiseDegrees,d='<div class="wc-overlay wc-overlay-loader wc-transparent wc-hidden"><div class="wc-modal"><div class="wc-svg-circle-progress wc-svg-circle-progress-ts wc-svg-circle-progress-ts-'+a.instance+'"><i class="icon-360"></i></div></div></div></div>',g='<div class="wc-mg-ac-Play"><button tabindex="0" type="button" tabindex="0" data-status="play" aria-label="'+
B+'"><i class="icon-video"></i></button></div>';({init:function(){c("body").hasClass("wc-mb-browser-ios")||a.$mainContainer.prepend('<h1 aria-live="polite" class="hidden">This is a 360 display. Navigate to rotation buttons to rotate</h1>');a.$mainContainer.addClass("wc-mosaic-board-ts");a.$mainContainer.find(".wc-ig-viewer").attr("aria-hidden","true");a.currView=0;a.currentFrame=Array(a.jsonData.length).fill(0);this._setLoadingModal();this._loadPlayer(a.currView,!1);this._threeSixtyEvents();this._setHandCursor(!0);
this._appendControls();this._controlsEvents();this._sendReportingEvent("three-sixty-view",void 0,{isInteractive:!1})},_loadView:function(b,c){a.currView!==b&&(this._sendReportingEvent("three-sixty-view",void 0,{isInteractive:!1}),c.isInteractive&&this._sendReportingEvent("three-sixty-selection",{isInteractive:!0}));a.currView=b;this._loadPlayer(a.currView,!0);this._updateButtonsDegreeAria()},_loadPlayer:function(b,d){var f=a.jsonData[b].medias;a.totalFrames=f.length;if(0===a.$mainContainer.find(".three-sixty-view-"+
b).length){var e=c('<div class="wc-hidden three-sixty-view-___PLAYER___"></div>'.replace("___PLAYER___",b));a.$mainContainer.append(e);this._loadNewImage(0,a.totalFrames,e,f,b,d)}},_loadNewImage:function(b,d,l,e,g,n){var f=this;if(b<d){0===b&&a.$mainContainer.parent().find(".wc-overlay-loader").removeClass("wc-hidden");var q=a.findProfileImage(e[b],"960").src,t=new Image;t.src=q;l.append(t);try{f._drawProgressBar(),a.loader.animateStep((b+1)/d)}catch(E){}c(t).on("load",function(){a.$mainContainer.find(".wc-ig-viewer img.selected").attr("src",
q);f._loadNewImage(b+1,d,l,e,g,n)}).on("error",function(){l.find("img:last").remove();--d;--a.totalFrames;f._loadNewImage(b+1,d,l,e,g,n)})}else{q=a.findProfileImage(e[0],"960").src;a.$mainContainer.find(".wc-ig-viewer img.selected").attr("src",q);a.$mainContainer.parent().find(".wc-overlay-loader").addClass("wc-hidden");try{f._drawProgressBar(),a.loader.clearAnimation(),setTimeout(function(){f._playFirstRotation()},300)}catch(E){}}},_update360:function(b,d){a.currentFrame[a.currView]+=b;0>a.currentFrame[a.currView]?
a.currentFrame[a.currView]=a.totalFrames-1:a.currentFrame[a.currView]>a.totalFrames-1&&(a.currentFrame[a.currView]=0);var c=a.$mainContainer.find(".three-sixty-view-"+a.currView+" img:eq( "+a.currentFrame[a.currView]+" )").attr("src");a.$mainContainer.find(".wc-ig-viewer img.selected").attr("src",c);d&&this._sendEventIfNewDirection(0<b?"right":"left")},_setLoadingModal:function(){a.$mainContainer.parent().append('<div class="wc-overlay wc-overlay-loader wc-hidden"></div>');a.$mainContainer.append(d);
this._drawProgressBar()},_drawProgressBar:function(){if(!(0<a.$mainContainer.find(".wc-svg-circle-progress-ts-"+a.instance+" svg").length)&&null==a.loader)try{var b=a.$mainContainer.find(".wc-svg-circle-progress-ts-"+a.instance).css("border-left-color"),d=a.$mainContainer.find(".wc-svg-circle-progress-ts-"+a.instance).css("border-right-color"),c="both"===a.$mainContainer.find(".wc-svg-circle-progress-ts-"+a.instance).css("clear");b=null!==b&&""!==b&&c?b:"#2179d3";var e=null!==d&&""!==d&&c?d.replace(")",
",0.5)").replace("rgb","rgba"):"rgba(0, 0, 0, 0.5)";a.loader=new CircleProgressBar(".wc-svg-circle-progress-ts-"+a.instance,{strokeWidth:3,strokeColor:b,trailColor:"#eee",trailWidth:1,fill:e})}catch(w){a.loader=null}},_threeSixtyEvents:function(){var b=this;a.$viewer.on("postLoadImage",function(d,c){b._loadView(a.$viewer.find("img.selected").index(),c)});a.$mainContainer.on("reportNextPrev",function(a,d){b._sendReportingEvent("prev"===d?"three-sixty-previous":"three-sixty-next")});a.$mainContainer.find("img").on("dragstart",
function(a){a.preventDefault()});a.$mainContainer.on("touchstart mousedown",function(a){c(a.target).is("i")||c(a.target).is("button")||(b._setGrabHandCursor(!0),b._mousePressed(a))})},_mousePressed:function(b){var d=this;a.moveDistance=0;a.start_x=b.pageX||b.originalEvent.targetTouches[0].pageX;a.$mainContainer.find(".wc-ig-viewer").on("touchmove mousemove",function(a){d._mouseMoved(a)}).on("touchend mouseup",function(a){d._mouseUp(a)})},_mouseMoved:function(b){b.preventDefault();b=b.pageX||b.originalEvent.changedTouches[0].pageX;
var d=b-a.start_x,c=Math.abs(d);5<c&&(this._update360(d/c,!0),a.start_x=b,a.moveDistance=c)},_mouseUp:function(){a.$mainContainer.find(".wc-ig-viewer").unbind("touchmove mousemove").unbind("touchend mouseup");this._setGrabHandCursor(!1)},_setHandCursor:function(b){b?a.$mainContainer.find(".wc-ig-viewer").addClass("wc-hand-cursor"):a.$mainContainer.find(".wc-ig-viewer").removeClass("wc-hand-cursor")},_setGrabHandCursor:function(b){b?a.$mainContainer.find(".wc-ig-viewer").addClass("wc-hand-cursor-closed"):
a.$mainContainer.find(".wc-ig-viewer").removeClass("wc-hand-cursor-closed")},_sendEventIfNewDirection:function(b){a.isRightOrLeft!==b&&this._sendReportingEvent("three-sixty-rotate-"+b);a.isRightOrLeft=b},_appendControls:function(){var b=c('<div class="wc-mg-ac-ts"><div class="wc-mg-ac-ts-container"></div></div>');a.$mainContainer.find(".wc-ig-viewer").after(b);b.find(".wc-mg-ac-ts-container").append('<div class="wc-mg-ac-Left"><button type="button" tabindex="0" aria-label=""><i class="icon-rotate-counterclockwise"></i></button></div>').append(g).append('<div class="wc-mg-ac-Right"><button type="button" tabindex="0" aria-label=""><i class="icon-rotate-clockwise"></i></button></div>');
this._updateButtonsDegreeAria()},_controlsEvents:function(){var b=this;c("body").on("pause-movie",function(){"pause"===a.$mainContainer.find(".wc-mg-ac-Play button").attr("data-status")&&b._sendReportingEvent("three-sixty-autoplay-stop",!1);b._pauseView()});c("body").on("onActiveContent",function(d,c){a.$mainContainer.closest(".wc-iframe-content").hasClass("active")&&!c&&b._sendReportingEvent("three-sixty-view")});a.$mainContainer.on("click",function(d){c(d.target).closest(".wc-mg-ac-Play").length||
c(this).hasClass("wc-mg-ac-Play")||("pause"===a.$mainContainer.find(".wc-mg-ac-Play button").attr("data-status")&&b._sendReportingEvent("three-sixty-autoplay-stop",!1),b._pauseView())});a.$mainContainer.find(".wc-mg-ac-Play").on("click",function(){"play"===c(this).children("button").attr("data-status")?(b._playView(1,!0),b._sendReportingEvent("three-sixty-autoplay-start",!1)):(b._pauseView(),b._sendReportingEvent("three-sixty-autoplay-stop",!1))});a.$mainContainer.find(".wc-mg-ac-Right, .wc-mg-ac-Left").on("click",
function(){-1!==c(this).attr("class").indexOf("Right")?b._update360(1,!0):b._update360(-1,!0)}).on("vmousedown mousedown",function(){"pause"===a.$mainContainer.find(".wc-mg-ac-Play button").attr("data-status")&&b._sendReportingEvent("three-sixty-autoplay-stop",!1);-1!==c(this).attr("class").indexOf("Right")?b._playView(1,!1):b._playView(-1,!1)}).on("vmouseup mouseup",function(){b._pauseView()})},_playView:function(b,d){var c=this;clearInterval(a.play);d&&(a.$mainContainer.find(".wc-mg-ac-Play").children("button").attr("data-status",
"pause").attr("aria-live","polite").attr("aria-label",D),a.$mainContainer.find(".wc-mg-ac-Play").find("i").removeClass("icon-video").addClass("icon-pause"),a.isRightOrLeft=null);a.play=setInterval(function(){c._update360(b,!1)},Math.ceil((15<a.totalFrames?5E3:4E3)/a.totalFrames))},_pauseView:function(){a.$mainContainer.find(".wc-mg-ac-Play").children("button").attr("data-status","play").attr("aria-live","polite").attr("aria-label",B);a.$mainContainer.find(".wc-mg-ac-Play").find("i").removeClass("icon-pause").addClass("icon-video");
clearInterval(a.play)},_playFirstRotation:function(){for(var b=this,d=50,c=0;c<a.totalFrames;c++)d+=20,c>.9*a.totalFrames?d+=c:c>.4*a.totalFrames&&(d+=3*c),setTimeout(function(){b._update360(1,!1)},d)},_updateButtonsDegreeAria:function(){a.$mainContainer.find(".wc-mg-ac-Left button").attr("aria-label",z.replace("%s",Math.ceil(360/a.totalFrames)));a.$mainContainer.find(".wc-mg-ac-Right button").attr("aria-label",n.replace("%s",Math.ceil(360/a.totalFrames)))},_sendReportingEvent:function(b,d,c){var e=
{};e.interactive="undefined"!==typeof c?c.isInteractive:!0;c=a.selectedImage();-1===b.indexOf("image-gallery")&&(e["tab-caption"]=a.tabCaption,e["section-type"]=a.sectionType,e["asset-title"]=a.jsonData[c].caption,(void 0===d||d)&&(e["index-in-collection"]=-1!==b.indexOf("selection")?0:a.currentFrame[a.currView]),e["collection-size"]=a.totalFrames,e["player-index"]=a.jsonData[c].index,e["index-in-collection-absolute"]=c.toString(),e["collection-size-absolute"]=a.jsonData.length,a.reportEvent(b,a.jsonData[c].rawSectionMetadata,
e))}}).init()})}})(jQuery);