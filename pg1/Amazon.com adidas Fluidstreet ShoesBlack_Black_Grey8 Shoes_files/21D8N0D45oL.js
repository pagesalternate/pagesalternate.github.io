(function(d){var l=window.AmazonUIPageJS||window.P,t=l._namespace||l.attributeErrors,m=t?t("AceSymphonyAUIAssets",""):l;m.guardFatal?m.guardFatal(d)(m,window):m.execute(function(){d(m,window)})})(function(d,l,t){d.when("A","PeriodicUtils").register("ACEDismiss",function(b,c){function q(a){m||(u=c.replacePlaceholder(n.dismissRef,b.$.extend({},n,{dismissType:a})),m=!0)}function a(){k&&0<d&&(q("dbk"),--d,r||k.hide(),r=!0)}function h(){c.track(u||c.replacePlaceholder(n.dismissRef,b.$.extend({},n,{dismissType:"dbg"})),
n.placementId,n.candidateToken,n.pageType);0<d&&(l.history.go(-d),d=0);p.find(".dismiss").unbind("click");b.off(g.hideEvent,h);b.off(g.dismissEvent,e);l.removeEventListener("popstate",a)}function e(){q("dis")}var f={},k=void 0,p=void 0,n=void 0,g=void 0,r=!1,d=0,m=!1,u=void 0;f.init=function(c,f){c.overlayInstance&&l.history&&l.history.pushState&&(g=c,n=f,k=g.overlayInstance,p=g.getContent(),d+=1,history.pushState({modalShown:!0},null,"#"+n.name),l.addEventListener("popstate",a),p.find(".dismiss").click(function(){q("dbt");
r||k.hide();r=!0}),b.on(g.dismissEvent,e),b.on(g.hideEvent,h))};return f});"use strict";var m=function(){function b(b,q){for(var a=0;a<q.length;a++){var h=q[a];h.enumerable=h.enumerable||!1;h.configurable=!0;"value"in h&&(h.writable=!0);Object.defineProperty(b,h.key,h)}}return function(c,q,a){q&&b(c.prototype,q);a&&b(c,a);return c}}();d.when("A").register("AceOverlayAdapter",function(){var b={},c=function(){function b(a,c,e){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");
this.overlayInstance=a;this.getContentMethod=c;this.overlayType=e;this.setEventStrings()}m(b,[{key:"getEvents",value:function(){return{popover:{dismiss:"a:popover:dismiss:"+this.overlayInstance.name,hide:"a:popover:afterHide:"+this.overlayInstance.name},bottomsheet:{dismiss:"a:sheet:beforeHide:"+this.overlayInstance._name,hide:"a:sheet:afterHide:"+this.overlayInstance._name}}}},{key:"getContent",value:function(){return this.overlayInstance[this.getContentMethod]()}},{key:"setEventStrings",value:function(){var a=
this.getEvents();this.hideEvent=a[this.overlayType].hide;this.dismissEvent=a[this.overlayType].dismiss}}]);return b}();b.createNewAdapter=function(b,a,h){return new c(b,a,h)};return b});"use strict";d.when("PeriodicUtils","PeriodicOptOut","ACEDismiss","ready").register("AceOverlayController",function(b,c,q){return{registerOverlayType:function(a,h,e){var f=void 0,k=void 0;switch(a){case "bottomsheet":f="a-sheet";k="a:sheet:afterShow";break;case "popover":case "modal":f="a-popover-base",k="a:popover:show"}d.when("A",
f,"ACEPopovers","AceOverlayAdapter","ready").execute(function(d,f,g,r){var l=!1,m=function(g){l||(g=r.createNewAdapter(g,h,a),c.init(g,e),q.init(g,e),b.recordCampaign(e),l=!0)};if(-1!=g.indexOf(e.name))(g=f.get(e.name))&&m(g);else d.on(k+":"+e.name,function(){d.off(k+":"+e.name);var a=f.get(e.name);m(a)})})}}});"use strict";d.when("AceOverlayController","PeriodicStateManager").execute("AceOverlayInit",function(b,c){c&&b.registerOverlayType("popover","getContent",c.getOverlayState())});"use strict";
d.when("A","PeriodicUtils").register("PeriodicOptOut",function(b,c){function d(g){n||(b.$.ajax({url:"/gp/ch/campaign/opt-out/ref\x3d"+p.optOutRef,type:"POST",data:{pageType:p.pageType||"Smile",campaign:p.campaign,creativeTreatment:p.creativeTreatment,token:p.candidateToken},complete:function(){g&&c.navigateTo(g)},error:function(a){c.logError(p.placementId,"opt_out:"+a.status,p.candidateToken)}}),n=!0,b.off(f.hideEvent,a))}function a(){0<k.find(".opt-out").find("input:checked").length&&d()}function h(a){var c=
b.$(a.currentTarget),e=c.hasClass("opt-out"),f=0<k.find(".opt-out").find("input:checked").length;if(e||f)a.preventDefault(),a=e?null:c.prop("href"),d(a);k.undelegate("a","click",h)}var e={},f=void 0,k=void 0,p=void 0,n=!1;e.init=function(c,e){c&&(f=c,p=e,k=f.getContent(),k.delegate("a","click",h),b.on(f.hideEvent,a))};return e});"use strict";d.when("A","PeriodicState","PeriodicUtils","ready").register("PeriodicStateManager",function(b,c,d){var a={},h={name:"ace-{{placementId}}",countRef:"smi_www_{{campaign}}_cnt_www_{{placementId}}",
dismissRef:"smi_www_{{campaign}}_{{dismissType}}_www_{{placementId}}",optOutRef:"smi_www_{{campaign}}_no_www_{{placementId}}"},e=function(a){if(!["campaign","placementId","creativeTreatment","candidateToken"].reduce(function(a,b){return a&&c.hasOwnProperty(b)},!0))return!1;var e=b.$.extend({},a),f=b.$.extend({},h);"rcol"===e.campaign.toLowerCase()&&(e.campaign="rco2");for(var g in f)f[g]=d.replacePlaceholder(f[g],e);return b.$.extend({},f,a)}(c);if(e)return a.getOverlayState=function(){return e},
a;var a=c.placementId||"0",f=c.candidateToken;f&&d.logError(a,"bad_state",f)});"use strict";d.when("A","ready").execute(function(b){if(b.state("ace-periodic"))d.register("PeriodicState",function(){return b.state("ace-periodic")});else b.on("a:state:update:ace-periodic",function(){d.register("PeriodicState",function(){return b.state("ace-periodic")})})});"use strict";d.when("A").register("PeriodicUtils",function(b){var c={logError:function(a,c,e){b.ajax("/gp/charity/ajax/track.html",{method:"post",
params:{pmet:"ace:periodic:error:"+a+":"+c,token:e}})},track:function(a,d,e){b.ajax("/gp/charity/ajax/track.html/ref\x3d"+a,{method:"post",params:{pageType:3<arguments.length&&arguments[3]!==t?arguments[3]:"Smile"},error:function(a){c.logError(d,"track:"+a.http.status,e)}})},replacePlaceholder:function(a,b){a.match(/{{\w+}}/g).forEach(function(c){var d=b[c.replace(/[^\w]/gi,"")]||null;d&&(a=a.replace(c,d))});return a}},d=function(a,d){b.ajax("/gp/ch/campaign/count/ref\x3d"+d,{method:"post",params:{pageType:a.pageType||
"Smile",campaign:a.campaign,creativeTreatment:a.creativeTreatment,candidateToken:a.candidateToken},error:function(b){c.logError(a.placementId,"record_campaign:"+b.http.status,a.candidateToken)}})};c.recordCampaign=function(a){d(a,a.countRef);a.customCountRef&&d(a,a.customCountRef)};c.navigateTo=function(a){l.location.href=a};return c})});